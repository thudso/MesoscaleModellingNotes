[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "PX912 Continuum and Mesoscale Modelling",
    "section": "",
    "text": "Welcome\nThis online book (also available as a pdf via the download link) contains a complete set of notes for PX912 Continuum and Mesoscale Modelling. This module forms part of the core training for the HetSys Centre for Doctoral Training, and focuses on macroscopic modelling via continuum mechanics. This modelling approach is in contrast to core module PX911, which is concerned with microscopic techniques, where individual atoms are treated. PX912 is split into two 5-week parts, the first on fluid dynamics (in Term 1) and the second on solid mechanics (in Term 2), and these notes are organised in parallel with this structure.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "0-preface.html",
    "href": "0-preface.html",
    "title": "Module overview",
    "section": "",
    "text": "Moodle\nSignificant credit must go to James Sprittles and Lukasz Figiel who originally developed this module and the materials I am building on here. Below, I detail a range of practical information about the module.\nSupporting resources for this module will be uploaded to Moodle on a week-by-week basis. I will try to upload resources well ahead of the lectures, but this is an ambition rather than a promise. The moodle page (where you probably found this!) is here.",
    "crumbs": [
      "Module overview"
    ]
  },
  {
    "objectID": "0-preface.html#lectures",
    "href": "0-preface.html#lectures",
    "title": "Module overview",
    "section": "Lectures",
    "text": "Lectures\nThese lecture notes form one of the main resources for the module, and there will very likely be updates to them as we go through the module. You can find the date of publication for the version you are reading on the title page,, and the online version will always be up-to-date.\nDuring lectures I will be going through the notes (not just copying them out, but rather focussing on concepts, derivations, etc) and it is my intention to use both slides, videos, and handwritten notes in combination to present. Many supporting materials are linked from the online notes, with videos embedded in the online version.",
    "crumbs": [
      "Module overview"
    ]
  },
  {
    "objectID": "0-preface.html#delivery",
    "href": "0-preface.html#delivery",
    "title": "Module overview",
    "section": "Delivery",
    "text": "Delivery\nI will be delivering the entire course face to face in MAS2.05/06. If you miss the lecture, Lecture Capture should be available. I do very much encourage you to attend the lectures and workshops regularly: educational research indicates that sustained lecture attendance is very strongly correlated with good performance in assessment, and they give you both invaluable access to me and your classmates, and time and space to focus on the material.",
    "crumbs": [
      "Module overview"
    ]
  },
  {
    "objectID": "0-preface.html#workshops",
    "href": "0-preface.html#workshops",
    "title": "Module overview",
    "section": "Workshops",
    "text": "Workshops\nThe focus of the workshops will be on the development of computational approaches to solving continuum mechanics problems. As this module runs alongside PX913, it is my intention to provide basic code for you to work with, manipulate and extend. However, if you prefer, you can develop your own from scratch (in Fortran or Python). Supporting materials for the Workshops will be provided in the form of Jupyter notebooks, which can be accessed via the Moodle page for the module; we’ll discuss this in the first workshop.\nThere will also be some Examples Sheets for you to complete in order to test your knowledge of the core material, and I encourage you to work through these as practice; these can also be discussed in the workshops.",
    "crumbs": [
      "Module overview"
    ]
  },
  {
    "objectID": "0-preface.html#assessment",
    "href": "0-preface.html#assessment",
    "title": "Module overview",
    "section": "Assessment",
    "text": "Assessment\nThe assessment for the entire module is based on:\n\na computational project on fluids worth 30% of the overall mark,\na computational project on solids worth 30% of the overall mark, and\na final viva worth 40% of the overall mark.\n\nI will provide further guidance on the particular parts of the content which the viva will focus on later in the module, and I will confirm the dates and location after the Christmas break. Success in the computational coursework projects will require you to do three things:\n\nDevelop code,\nBenchmark your code by using known analytic results and exact solutions, and\nEngage with existing literature.\n\nAll of these aspects are important skills to practice and develop for success in your own individual research projects.",
    "crumbs": [
      "Module overview"
    ]
  },
  {
    "objectID": "1-0-fluids.html",
    "href": "1-0-fluids.html",
    "title": "Fluids",
    "section": "",
    "text": "Introduction\nAs HetSys cohorts tend to be very interdisciplinary, it is inevitable that some of you will find many part of this course relatively straightforward (and may have covered some of the material before), whilst others of you will find it extremely challenging, particularly those with a less mathematical background. Where possible, particularly for the Projects, I have tried to provide both the basics and more advanced concepts for those with more previous experience in this area, and I will take into account your prior knowledge when assessing you. I have tried to focus the course on gaining an appreciation for the macroscopic modelling of fluid flow, whilst also streamlining the derivation of the governing equations of fluid dynamics. Various additional details are contained in Appendices at the end of chapters for the interested reader, and plenty more excellent material is available in the recommended textbooks.\nAlthough we will encounter some canonical flows where analytic solutions are attainable, the use of mathematical techniques to solve fluid flow problems is not the focus of this course. Instead, the intention is to give you an introduction to various computational techniques in the workshops, and an appreciation for some of the important considerations that underly the method one chooses to solve a particular problem.\nDuring the lectures in the first part, we will cover the following topics:\nIn the workshops you will develop your own codes to solve real-world problems.",
    "crumbs": [
      "Fluids"
    ]
  },
  {
    "objectID": "1-0-fluids.html#introduction",
    "href": "1-0-fluids.html#introduction",
    "title": "Fluids",
    "section": "",
    "text": "Macroscopic Modelling of Fluid Flow: vector calculus, index notation, continuum limit, incompressible flows, Lagrangian/Eulerian descriptions, flow visualisation, material derivative, vorticity & rate of strain\nGoverning Equations of Fluid Dynamics: conservation laws, constitutive equations, Navier-Stokes/Euler/Stokes equations, dimensionless parameters, boundary/initial condition, modelling frameworks\nCanonical Flows: stream function, plane parallel shear flows, Couette/Poiseuille flow, circular flows, rigid body rotation, point vortex\nFree Surface Flows: kinematic/dynamic boundary conditions, surface tension, bubbles, Bond/capillary numbers, Young-Laplace equation\n\n\n\nComputational Fluid Dynamics: finite differences, linear/nonlinear equations, unsteady problems, solving free surface flows",
    "crumbs": [
      "Fluids"
    ]
  },
  {
    "objectID": "1-0-fluids.html#supporting-resources",
    "href": "1-0-fluids.html#supporting-resources",
    "title": "Fluids",
    "section": "Supporting Resources",
    "text": "Supporting Resources\n\nReading list\nThere are a huge array of books on the topic of fluid dynamics and you should feel free to engage with any of them. My particular favourite is:\n\nD.J. Acheson, Elementary Fluid Dynamics, OUP. (Well-written accessible exposition of fluid dynamics with a useful set of questions and solutions.).\n\nHowever other famous possibilities include:\n\nG. K. Batchelor An Introduction to Fluid Dynamics, CUP (A classic which goes into greater detail than the present course).\nL.D. Landau and E.M. Lifshitz, Fluid Mechanics, OUP. (A classic for those with a deep interest in fluid dynamics in modern physics.)\nA.R. Paterson, A First Course in Fluid Dynamics, CUP. (Easier than Acheson.)\nD.J. Tritton, Physical Fluid Dynamics, Oxford Science Publs. (Emphasis is on the physical phenomena and less on the mathematics.)\n\nFor the Chapters on interfacial flow I would recommend John Bush’s notes (which go into far more detail that I will have time to) which you can obtain as MIT Open Courseware here.\n\n\nVideos\nIn the 1960’s a fantastic set of videos were filmed by the National Committee for Fluid Mechanics Films (see here). These can now be found on YouTube here (though you’ll need to put up with the sound being out of sync with the presenter’s voice!). Another good resource for fluid videos and pictures is to be found here. I will try to provide links to relevant videos on Moodle - if you find any other interesting videos/pictures, please let me know.",
    "crumbs": [
      "Fluids"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html",
    "href": "1-1-macro-fluids.html",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "",
    "text": "1.1 Mathematical Background\nThe intention of this chapter is to build up the mathematical tools and concepts we will require in order to derive the Navier-Stokes equations in the next chapter, which are the governing equations of macroscopic fluid flow.\nIt is useful to have some exposure to the main operators that appear routinely in fluid mechanics, so we will do a brief recap of some standard notation used in these notes.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html#mathematical-background",
    "href": "1-1-macro-fluids.html#mathematical-background",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "",
    "text": "Vectors and Tensors\nVectors and tensors will be written by their components relative to a set of basis vectors {\\boldsymbol{e}}_1,{\\boldsymbol{e}}_2,{\\boldsymbol{e}}_3. For example, the position vector {\\boldsymbol{x}}=x_1{\\boldsymbol{e}}_1 + x_2{\\boldsymbol{e}}_2+x_3{\\boldsymbol{e}}_3=(x_1,x_2,x_3) will be written as {\\boldsymbol{x}}=x_i, where ‘i’ is the free index which will take values i=1,2,3 and we repeat that the x_i are components relative to a set of specified basis vectors. We will only use subscripts for indices.\nThe velocity field in Cartesian coordinates will be {\\boldsymbol{v}}= (u,v,w) where u is the x-component of velocity, v is the y-component and w is its z-component.\nFor the derivations we make, we will only consider Cartesian coordinates so that {\\boldsymbol{x}}=x_i=(x,y,z), although later on we will also consider problems most naturally formulated in cylindrical or spherical coordinates. The specification {\\boldsymbol{v}}= {\\boldsymbol{v}}({\\boldsymbol{x}},t) would be written as v_i =  v_i(x_j,t).\n\n\nVector Calculus\nThe following are important differential operators which we can apply to various important fields.\nThe gradient operator \\nabla=\\left(\\frac{\\partial }{\\partial x},\\frac{\\partial }{\\partial y},\\frac{\\partial }{\\partial z}\\right), which generalises the usual derivative, acting on a scalar function f({\\boldsymbol{x}},t) gives \n\\nabla f= \\left(\\frac{\\partial f}{\\partial x},\\frac{\\partial f}{\\partial y},\\frac{\\partial f}{\\partial z}\\right)\n and so is a vector composed of partial derivatives of f in the three Cartesian directions which identifies the direction of greatest increase of the function f at a particular point.\nThe divergence operator \\nabla\\cdot acts on vectors (tensors) to produce a scalar (low order tensor) that quantifies the flux from such a vector (tensor) field. When acting on a vector in Cartesian coordinates {\\boldsymbol{v}}({\\boldsymbol{x}},t)=(u,v,w) one has \n\\nabla\\cdot {\\boldsymbol{v}}= \\frac{\\partial u}{\\partial x}+\\frac{\\partial v}{\\partial y}+\\frac{\\partial w}{\\partial z},\n which we will later see ensures that the flow is incompressible.\nIn fluid mechanics one is often interested in the local (rate of) rotation of the fluid, which is measured by the vorticity.\n\n\n\n\n\n\nDefinition\n\n\n\nThe vorticity vector {\\boldsymbol{\\omega}} at a point in a fluid is defined as the curl, \\nabla\\times, of the velocity field \n{\\boldsymbol{\\omega}}=\\nabla\\times{\\boldsymbol{v}}= \\left(\\frac{\\partial w}{\\partial y}-\\frac{\\partial v}{\\partial z},\\frac{\\partial u}{\\partial z}-\\frac{\\partial w}{\\partial x},\\frac{\\partial v}{\\partial x}-\\frac{\\partial u}{\\partial y}  \\right).\n\n\n\nNote that in Cartesian coordinates one can think of (i) the divergence as being the dot product of the gradient operator with a vector and (ii) the curl being the cross product of the gradient operator with a vector.\n\n\nIndex Notation\nSometimes it will be convenient to use index notation (described/recapped below). When using index notation, the summation convention and some additional shorthand provide a succinct way to write PDEs.\nFor matrices and tensors the same procedure will be used. For example, the components of the stress tensor are T_{ij} where i and j are free indices, meaning that in general this tensor has 3\\times3=9 components.\n\n\n\n\n\n\nDefinition\n\n\n\nThe Kronecker delta is the symbol \n\\delta_{ij} = \\begin{cases}\n0& \\text{for }i\\neq j\\\\\n1& \\text{for }i=j.\n\\end{cases}\n\n\n\nOne use it will have is to confine the gravitational acceleration g\\, \\delta_{i3} to a single direction (usually aligned with the z-axis).\nIndex notation can also be used to represent different operators, e.g. the gradient applied to the density \\rho gives \n\\nabla \\rho = \\left(\\frac{\\partial \\rho}{\\partial x},\\frac{\\partial \\rho}{\\partial y},\\frac{\\partial \\rho}{\\partial z}\\right) = \\frac{\\partial \\rho}{\\partial x_i}\n where we recall that i=1,2,3 is implied in this notation.\nWhere repeated indices are used, automatic summation over these is implied. This is the summation convention. For example, the dot product \n{\\boldsymbol{a}}\\cdot{\\boldsymbol{b}}=a_1b_1+a_2b_2+a_3b_3=\\xcancel{\\sum_{j=1}^{3}} a_j b_j = a_j b_j\n is written in index notation succinctly as a_j b_j, with summation over j implied. The choice of repeated index is arbitrary, as this is a dummy variable which does not appear in the final result (e.g. a_k b_k would be equally valid for the dot product).\nRepeated indices can also be used for differential operators. Examples in Cartesian coordinates are:\n\nThe divergence \\nabla\\cdot applied to a vector {\\boldsymbol{v}} is \n\\nabla\\cdot{\\boldsymbol{v}}= \\frac{\\partial u}{\\partial x}+\\frac{\\partial v}{\\partial y}+\\frac{\\partial w}{\\partial z}\n=\\xcancel{\\sum_{j=1}^{3}}\\frac{\\partial v_j}{\\partial x_j}= \\frac{\\partial v_j}{\\partial x_j}\n\nThe Laplacian \\nabla^2 applied to a function f can be written as \n\\nabla^2 f\n= \\frac{\\partial^2 f}{\\partial x^2}+\\frac{\\partial^2 f}{\\partial y^2}+\\frac{\\partial^2 f}{\\partial z^2}\n= \\xcancel{\\sum_{j=1}^{3}}\\frac{\\partial}{\\partial x_j}\\frac{\\partial f}{\\partial x_j}\n= \\frac{\\partial^2 f}{\\partial x_j^2}\n where the repeated index is in the denominator \\partial x_j^2.\nThe curl of a vector {\\boldsymbol{v}} is \n\\omega_i = \\nabla\\times{\\boldsymbol{v}}= \\epsilon_{ijk}\\frac{\\partial v_k}{\\partial x_j},\n where {\\boldsymbol{\\omega}}=\\omega_i is the vorticity as defined above, and \\epsilon_{ijk} is the Levi-Civita symbol, defined below.\n\n\n\n\n\n\n\nDefinition\n\n\n\nThe Levi-Civita symbol is defined as follows: \n\\epsilon_{ijk} =\n\\begin{cases}\n  0& \\text{if}~~i=j, j=k~~\\text{or} ~~i=k\\\\\\\n  1& \\text{for}~~(i,j,k)=(1,2,3), (2,3,1) ~~\\text{or} ~~(3,1,2)\\\\\n  -1& \\text{for}~~(i,j,k)=(1,3,2), (2,1,3)~~ \\text{or} ~~(3,2,1)\\\\\n\\end{cases}\n\n\n\nWhen applied to the term {\\boldsymbol{d}}= \\nabla^2{\\boldsymbol{v}} (the label {\\boldsymbol{d}} is arbitrary) in the Navier-Stokes equations we have \n{\\boldsymbol{d}}= d_i = \\frac{\\partial^2 v_i}{\\partial x_j^2}\n with one free index i.\n\n\n\n\n\n\nExample\n\n\n\nHow would you write the y-component of v_j\\, \\frac{\\partial v_i}{\\partial x_j}?\nAs an aside: using vector calculus this can be written as \\left({\\boldsymbol{v}}\\cdot\\nabla\\right){\\boldsymbol{v}}.\n\n\nAlways check that each term in an equation formed using index notation has to contain the same free indices (e.g. a_{ij} = b_{ijk}e_k + f_{ij} is fine, but a_{ij} = b_{ijk}e_j + f_{ik} would not be!).",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html#what-is-macroscopic-fluid-dynamics",
    "href": "1-1-macro-fluids.html#what-is-macroscopic-fluid-dynamics",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "1.2 What is Macroscopic Fluid Dynamics?",
    "text": "1.2 What is Macroscopic Fluid Dynamics?\nWith a bit of maths background out the way, we can next ask exactly we mean by a fluid. Fluids, unlike solids, can ‘flow’ by changing their shape. They include not only liquids (water, oil, etc) but also gaseous media (air, plasma, etc.).\nFluid flow occurs across huge variations in scale: from the very small (e.g. microdrops from a 3D printer) to the huge (tornados) and from the incredibly slow (motion of glaciers) to the very fast (aeronautics). Examples of flows at these different scales are found in Figure 1.1.\n\n\n\n\n\n \n\n\n \n\n\n\n\nFigure 1.1: Flow at different scales: small (blood flow) to large (tornado); slow (glacial flow) to fast (aeronautics).\n\n\n\n\nWhile we have good intuition about how water behaves at human scales, fluid motion at extreme scales can often appear counter-intuitive. Nevertheless, it is remarkable that the same set of equations, the Navier-Stokes equations, can be used to describe the flow of both gases and liquids in huge number of the aforementioned situations. The study of fluids using these equations is often referred to as ‘fluid mechanics’, ‘fluid dynamics’ or ‘hydrodynamics’ and it assumes that the fluid can be idealised as a continuous medium, i.e. it uses continuum mechanics.\nThe continuum approach is accurate when the length scale \\ell characterising molecular motion is much smaller than the dimensions of the flow L, so that \\ell/L \\ll 1 (the continuum limit takes \\ell/L \\rightarrow 0). Note that \\ell/L is a ‘dimensionless number/parameter’, which compares the size of two dimensional quantities - we will encounter more of these later. For gases, if \\ell is taken to be the mean free path (i.e. the average distance between molecular collisions) then \\ell/L is called the Knudsen number.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html#incompressible-fluids",
    "href": "1-1-macro-fluids.html#incompressible-fluids",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "1.3 Incompressible Fluids",
    "text": "1.3 Incompressible Fluids\nOur focus will be on using continuum mechanics to describe the state of a fluid flow at coordinate {\\boldsymbol{x}}\\in {\\mathbb{R}}^d of d-dimensional space, d=1,2 or 3 at time t. In general one has d=3, but upon simplifications one can have d=2 and even d=1 (e.g. for flow in a channel).\n\nThe state of an incompressible fluid flow with constant density can be characterised by its velocity {\\boldsymbol{v}}= {\\boldsymbol{v}}({\\boldsymbol{x}},t) and pressure p =p({\\boldsymbol{x}},t). In more complex cases, other relevant fields enter the description (e.g. density, temperature, electromagnetism, chemical composition, etc).\nOur main task is to find these fields (especially the velocity field {\\boldsymbol{v}} as this tells us where ‘stuff’ is going) and thus be able to predict the flow behaviour in space and time.\nThe incompressible Navier-Stokes equations we will derive are based on conservation of mass and momentum.\nThe derivation is complicated because a fluid flows, so that conservation laws must be applied to a material that moves and deforms in time.\nThe complexity of the Navier-Stokes equations makes solving them an extremely difficult task. One can either (a) use mathematical modelling to simplify the problem and/or (b) use computational approaches (the field of Computational Fluid Dynamics - CFD).\nIn this course we will see that in simplified cases analytic solutions can be obtained and that these have a crucial role in validating CFD. The CFD can then be applied to more complex flows where analytic solutions do not exist.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html#lagrangian-and-eulerian-descriptions",
    "href": "1-1-macro-fluids.html#lagrangian-and-eulerian-descriptions",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "1.4 Lagrangian and Eulerian Descriptions",
    "text": "1.4 Lagrangian and Eulerian Descriptions\nThe equations of fluid dynamics will be formulated in Eulerian coordinates; but, it will also be important to appreciate Lagrangian coordinates which ‘follow the fluid’. The following video discusses this concept.\n\n\n\n\n\n\n\nFigure 1.2: The motion of a material fluid element M whose properties (e.g. velocity) can be described by Eulerian coordinates (x,y,z) or Lagrangian ones (X,Y,Z). The Lagrangian coordinates remain frozen inside M as it evolves and deforms in time (from 0 to 1 in this case), i.e. they follow material points as advected by the fluid velocity.\n\n\n\n\nIn classical mechanics, we know the motion of a material point if we can specify its Eulerian coordinates x_i as a function f_i of time \nx_i = f_i(t).\n To extend this to a fluid modelled as a continuous medium we need to identify and follow the (infinitely many) material points which form the continuum.\nMaterial points in a fluid will be referred to as fluid elements or fluid particles, i.e. infinitesimal volumes of fluid which are advected with the fluid’s velocity {\\boldsymbol{v}} and hence are always composed of the same material.\nOne way to uniquely identify each fluid element x_i is by its Eulerian coordinates x_j(t=t_0) = X_j=(X_1,X_2,X_3) at a reference (or initial) time t_0 and then allow these coordinates to move and deform with the fluid throughout its motion. The X_j are then Lagrangian coordinates (see Figure 1.2) and the position of a fluid element x_i(t) at a time t is given by \nx_i = f_i(X_j,t).\n\nWhilst in the Eulerian description one sits at a fixed position and watches the flow pass (like standing at the bank of a river), in the Lagrangian description we ‘follow the fluid’ (as in a boat flowing with the river or on a weather balloon).\nIt is possible to formulate the equations of fluid mechanics in Lagrangian coordinates (so that v_i = v_i(X_j,t)) but this is quite un-natural for fluid flow as it is impossible to identify a sensible reference configuration (not such an issue in solid mechanics).\nThe notion of ‘following the fluid’ will be an important one, as the laws of nature (e.g. Newton’s second law) are formulated for material substances (i.e. fluid elements), rather than to arbitrary points in space (which are composed of different fluid elements at every instant). This consideration will lead us to the notion of the material derivative, which allows us to express the rate of change inside a material element (i.e. a Lagrangian derivative) in terms of Eulerian coordinates.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html#flow-visualisation",
    "href": "1-1-macro-fluids.html#flow-visualisation",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "1.5 Flow Visualisation",
    "text": "1.5 Flow Visualisation\nIn order to gain some intuition about exactly what a fluid is doing, we need ways to visualise flows, both experimentally and theoretically. The following video discusses approaches to flow visualisation.\n\nThe most common way to visualise a flow, theoretically (once we have {\\boldsymbol{v}}) or experimentally, is to consider the paths which particles take inside it. Alternatively, we may be interested in the velocity field at an instant in time (the streamlines). Only for a steady flow (\\partial_t {\\boldsymbol{v}}={\\boldsymbol{0}}) do these curves coincide.\n\nParticle Paths\nThe paths of fluid elements (‘particle paths’) x_i^{p}(t) are defined by \n\\left.\\frac{\\partial x_i^{p}(t)}{\\partial t}\\right|_{\\text{fixed $X_k$}} = v_i\n\\tag{1.1} with initial positions fixed x_i^{p}(t=0)=X_i. Upon integration, eliminating t gives the particle paths.\nThis also provides a way to switch from the Eulerian description to the Lagrangian one, with the three constants of integration (X,Y,Z) specifying the Lagrangian coordinates of a particular trajectory (i.e. a specific fluid element).\n\n\nStreamlines\nIn general, the particle paths differ from the streamlines defined by curves which are tangential to the velocity at every point at a fixed time. Mathematically, if we parameterise these curves by an independent parameter s then our streamlines (x,y,z)=(x(s),y(s),z(s)) are obtained by solving \n\\left.\\frac{\\partial x_i(s)}{\\partial s}\\right|_{\\text{fixed $t$}} = v_i.\n\n\n\nExperimental Visualisation\nTo visualise a flow field one usually places illuminated passive tracers (e.g. dye, bubbles or beads that don’t alter the flow) into the flow. Then, to obtain particle paths one simply tracks the position of these tracers as a function of time, whilst to obtain the streamlines one could take a short exposure photo so that the illuminated tracers show short streak lines (whose length will be proportional to the fluid speed). In a steady flow, this streamline pattern will be fixed for all times and a fluid particle starting on a streamline will remain on it, whereas for unsteady flow the particle paths and streamlines will not coincide.\n\nNotably, even in a steady flow, as fluid particles travel along the streamlines their velocity will change, i.e. they will accelerate and decelerate. To formalise this rate of change caused by the evolution of fluid particles, we have to introduce the material derivative.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html#the-material-derivative",
    "href": "1-1-macro-fluids.html#the-material-derivative",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "1.6 The Material Derivative",
    "text": "1.6 The Material Derivative\nThe material derivative D_t=\\frac{D}{D t} gives the rate of change of a quantity which ‘follows the fluid’ (i.e. moves under the fluid’s velocity field) as opposed to \\partial_t which gives the rate of change of a quantity at a point fixed with respect to Eulerian coordinates. In other words, it gives the time derivative moving along a fluid particle trajectory described by Equation 1.1.\nWhen applied to a quantity (scalar or vector) f(x_i^p(t),t), written in Eulerian coordinates, a simple application of the chain rule gives: \n\\frac{Df}{Dt}\n= \\frac{d}{dt} f(x_i^p(t),t)\n= \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial x_i} \\frac{\\partial x_i^{p}(t)}{\\partial t}\n= \\left( \\frac{\\partial }{\\partial t} + v_i \\frac{\\partial }{\\partial x_i}\\right) f\n so that symbolically the material derivative operator is \n\\frac{D}{Dt}  \\equiv \\left(\\frac{\\partial}{\\partial t} + {\\boldsymbol{v}}\\cdot \\nabla \\right)\n\n\nThe first term is the local rate of change at a fixed Eulerian position {\\boldsymbol{x}} due to temporal changes.\nThe second is the ‘convective rate of change’ caused by the velocity {\\boldsymbol{v}} driving fluid elements through spatial gradients in the quantity of interest.\n\n\n\n\n\n\n\nExample\n\n\n\nIf there is a concentration of pollutant c=c(x) in a river that flows steadily with constant speed {\\boldsymbol{v}}=(v_0,0,0), how does the concentration change in a fluid element that ‘follows the fluid’?\n\nA complementary video can be found here.\n\n\n\nThe material derivative will be important when it comes to a consideration of the acceleration a_i of a fluid element.\nIf D_t f  = 0, then clearly the quantity f is a constant in a particular fluid element. However, this constant can take different values in different fluid elements - all we know is that f retains the value it started with.\n\n\nAcceleration\nIt is the material derivative which gives us the rate of change of velocity, i.e. the acceleration {\\boldsymbol{a}}=a_i, of the fluid element \na_i = \\frac{Dv_i}{Dt}  = \\frac{\\partial v_i}{\\partial t} + v_j \\frac{\\partial v_i}{\\partial x_j} \\qquad \\text{or} \\qquad  {\\boldsymbol{a}}= \\frac{D{\\boldsymbol{v}}}{Dt} = \\frac{\\partial{\\boldsymbol{v}}}{\\partial t} + ({\\boldsymbol{v}}\\cdot \\nabla) {\\boldsymbol{v}}.\n Notably, even when the flow is steady, so that \\partial_t {\\boldsymbol{v}}=0, the acceleration still has a component ({\\boldsymbol{v}}\\cdot \\nabla) {\\boldsymbol{v}} due to the spatial variation of the velocity field—this is the convective acceleration.\n\n\n\n\n\n\nExample\n\n\n\nIf we take a one-dimensional steady flow {\\boldsymbol{v}}= (u(x),0,0), then what is the acceleration of fluid particles?\n\n\n\nIn the Examples Sheet you will consider a steady flow in uniform rotation with angular velocity \\Omega with velocity given by (u,v,w)=(-\\Omega y, \\Omega x,0). As we know, fluid particles must be accelerating inwardly (centrifugal force) and you will see it is the convective acceleration that accounts for this term.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html#sec-kinematics",
    "href": "1-1-macro-fluids.html#sec-kinematics",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "1.7 Kinematics",
    "text": "1.7 Kinematics\nThe study of the deformation of continuous media (including solid and fluid dynamics) is a course in its own right, so we will only consider the concepts we will require to formulate the equations of fluid mechanics, with additional details contained in Section 1.8 and the video on Deformation of Continuous Media, here. In particular, we will attempt to understand how flow deforms fluid elements; as it is this (rate of) deformation that will generate the internal stress (and hence forces) required by our momentum balance equations (Newton II). This is in contrast to elasticity, where in the simplest case it is displacement that generates stress (via Hooke’s law).\nThe velocity can be decomposed into fundamental components which specify the kinematics of the flow (the geometry of the motion), i.e. how small fluid elements are deformed by the flow. To do so, consider the flow at an infinitesimal distance \\delta x_j from a reference point x_j, see Figure 1.3.\n\n\n\n\n\n\nFigure 1.3: Flow kinematics - how the flow velocity varies in the vicinity of (a distance \\delta {\\boldsymbol{x}} from) a point {\\boldsymbol{x}}.\n\n\n\nThe Taylor expansion of v_i(x_j+\\delta x_j), keeping only the terms up to the first power in \\delta x_j inclusive, gives \n\\begin{aligned}\nv_i(x_j+\\delta x_j,t)\n&= v_i(x_j,t) + \\frac{\\partial  v_i}{\\partial x_j}~\\delta x_j \\\\\n&=  \\underbrace{\\underbrace{\\vphantom{\\frac{\\omega_j}{2}}v_i(x_j)}_{\\text{Translation}} \\; +\\;  \\underbrace{ \\epsilon_{ijk}\\frac{\\omega_j}{2} \\delta x_k}_{\\text{Rotation}}}_{\\text{Rigid Body Motions}} \\quad +\\!\\!\\!\\! \\underbrace{\\quad\\vphantom{\\underbrace{\\frac{\\omega_j}{2}}_{\\text{Rotation}}}e_{ij} ~\\delta x_j\\quad}_{\\text{Shearing and Extension}}\n\\end{aligned}\n\\tag{1.2} where we have decomposed \\partial_{x_j}  v_i into a rotational part and a shearing/extensional part; see Section 1.8 for further details. Writing the deformation this way allows us to identify the vorticity {\\boldsymbol{\\omega}} as twice the local rate of rotation in the fluid; in Cartesian coordinates, the vorticity can be computed by working out the determinant \n{\\boldsymbol{\\omega}}\n= \\begin{vmatrix}\n    {\\boldsymbol{e}}_x &  {\\boldsymbol{e}}_y & {\\boldsymbol{e}}_z\\\\\n    \\frac{\\partial}{\\partial x} & \\frac{\\partial}{\\partial y} & \\frac{\\partial}{\\partial z} \\\\\n    u & v & w\n  \\end{vmatrix}\n= \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z},\\, \\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x},\\, \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right).\n The symmetric (e_{ij}=e_{ji}) rate of strain tensor is a measure of the relative flow of adjacent fluid elements \ne_{ij} = \\frac{1}{2} \\left( \\frac{\\partial  v_i}{\\partial x_j}+  \\frac{\\partial  v_j}{\\partial x_i}\\right).\n Section 1.8 discusses why this is indeed the rate of strain tensor, as does the following video.\n\nIn particular, we find that the first two terms in Equation 1.2 are associated with rigid body motion, it is the third term v_i^S = e_{ij}\\delta x_j which represents the straining motions which distinguish the flow through the relative motion of adjacent fluid elements. The rate of strain tensor e_{ij} can be further decomposed into:\n\ndiagonal elements, which are associated with stretching and compressive motion, and\noff-diagonal elements, give the shear rate of strain, describing how much adjacent fluid elements slide past one another.\n\n\n\n\n\n\n\nFigure 1.4: Different modes of deformation to a fluid element (in 2D).\n\n\n\nSo we have seen that it is the vorticity and rate of strain that give us all of the information we require to understand how fluid elements are locally deformed, with the former telling us about the rotation of the flow and the latter about the relative motion of fluid elements (which generates viscous stress).\nAn important class of flows we will encounter are those without vorticity {\\boldsymbol{\\omega}}={\\boldsymbol{0}}, and they are said to be irrotational. In such flows, each fluid element has no angular velocity. For example, we will see that fluid elements in the viscous boundary layer near a solid are rotational, so that these elements rotate end over end as they move parallel to the boundary, whereas elements outside this layer are irrotational (Figure 1.5).\n\n\n\n\n\n\nFigure 1.5: The difference between rotational (in the boundary layer) and irrotational flow (outside the layer). The crosses represent markers placed into the flow, which would rotate inside the boundary layer and not outside.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-1-macro-fluids.html#sec-vorticity-and-ros",
    "href": "1-1-macro-fluids.html#sec-vorticity-and-ros",
    "title": "1  Macroscopic Modelling of Fluids",
    "section": "1.8 Vorticity and the Rate of Strain Tensor*",
    "text": "1.8 Vorticity and the Rate of Strain Tensor*\nThis section complements Section 1.7, showing why {\\boldsymbol{e}} and {\\boldsymbol{\\omega}} are indeed associated with rate of strain and vorticity.\n\nDecomposition\nRecalling the Taylor expansion of v_i(x_j+\\delta x_j) made in Equation 1.2, we name the terms \n\\begin{aligned}\nv_i(x_j+\\delta x_j,t)\n&= v_i(x_j,t) + \\frac{\\partial  v_i}{\\partial x_j}~\\delta x_j \\\\\n&=  \\underbrace{\\underbrace{v_i(x_j)}_{\\text{Translation}} \\; +\\;  \\underbrace{r_{ij}~\\delta x_j}_{\\text{Rotation}}}_{\\text{Rigid Body Motions}} \\quad +\\!\\!\\!\\! \\underbrace{\\vphantom{\\underbrace{\\delta x_j}_{\\text{Rotation}}}\\;e_{ij} ~\\delta x_j\\;}_{\\text{Shearing and Extension}}\n\\end{aligned}\n\\tag{1.3} where we have decomposed \\frac{\\partial v_i}{\\partial x_j} into an anti-symmetric (meaning that r_{ij} = -r_{ji}) rate of rotation tensor \nr_{ij}=\\frac{1}{2}\\left( \\frac{\\partial  v_i}{\\partial x_j} -  \\frac{\\partial  v_j}{\\partial x_i}\\right)\n and the symmetric (meaning that e_{ij}=e_{ji}) rate of strain tensor \ne_{ij} = \\frac{1}{2} \\left( \\frac{\\partial  v_i}{\\partial x_j}+  \\frac{\\partial  v_j}{\\partial x_i}\\right).\n\nEach of the terms in Equation 1.3 contributes a term to the overall velocity: \nv_i(x_j+\\delta x_j,t) = v_i^T + v_i^R + v_i^S,\n\\tag{1.4} where \nv_i^T = v_i(x_j),\\quad  v_i^R = r_{ij}~\\delta x_j,\\quad \\text{and}\\quad v_i^S = e_{ij} ~\\delta x_j,\n and each of the terms can now be analysed.\n\n\nVorticity\nDue to the antisymmetry of r_{ij}, there are only 3 independent components. All of the diagonal elements are zero; for example r_{11}=-r_{11} means that r_{11}=0. In this case, we can rewrite the term v_i^R = r_{ij}~\\delta x_j in Equation 1.4 as a cross product v_i^R = \\epsilon_{ijk}\\Omega_j \\delta x_k or {\\boldsymbol{v}}^R = {\\boldsymbol{\\Omega}}\\times\\delta{\\boldsymbol{x}} (see Figure 1.6), where \\Omega_j = (r_{32},r_{13},r_{21}) is the rate of rotation vector (you are encouraged to check this for yourself). Thus we see that this term is associated with rigid body rotation about the reference point with rotational rate {\\boldsymbol{\\Omega}}. The direction of {\\boldsymbol{\\Omega}} determines the axis of rotation, and the magnitude determines the speed of rotation.\n\n\n\n\n\n\nFigure 1.6: Sketch illustrating the rigid body rotation {\\boldsymbol{v}}^R = {\\boldsymbol{\\Omega}}\\times\\delta{\\boldsymbol{x}} induced a distance \\delta{\\boldsymbol{x}} away from a point {\\boldsymbol{x}} by the rotation rate {\\boldsymbol{\\Omega}}. Here, {\\boldsymbol{\\Omega}} points out of the paper.\n\n\n\nNotably, the rate of rotation vector {\\boldsymbol{\\Omega}} is equal to half the vorticity vector \n{\\boldsymbol{\\omega}}= \\nabla\\times{\\boldsymbol{v}}\n= 2{\\boldsymbol{\\Omega}}, \\qquad\\text{so that}\\qquad {\\boldsymbol{v}}^R\n= \\frac 1 2 {\\boldsymbol{\\omega}}\\times\\delta{\\boldsymbol{x}}\n\\tag{1.5} which is an important fluid mechanical quantity we will repeatedly encounter. Now we can recognise it as a measure of the local rate of rotation in the fluid.\n\n\nRate of Strain Tensor\nConsider how the components of e_{ij} deform an infinitesimal rectangular fluid element of size \\delta x\\times\\delta y (Figure 1.7) in a two-dimensional flow {\\boldsymbol{v}}=(u(x,y,t),v(x,y,t),0). For simplicity, we will remove translation of the fluid element by considering flow relative to the point A, so that a Taylor expansion gives the flow components at adjacent points to A shown in Figure 1.7.\n\n\n\n\n\n\nFigure 1.7: The velocity components relative to a point A in a material element M at time t.\n\n\n\n\nExtensional Strain Rate\nFrom Figure 1.8 we can see that extensional rate of strain acts to increase the lengths of the sides. For example, taking the line AB, in a time \\delta t the point B moves so that the new length of AB at time t+\\delta t is \n\\delta x(t+\\delta t) = \\delta x(t) +  \\underbrace{\\frac{\\partial u}{\\partial x}\\delta x(t)}_{\\text{speed}}\\,\\underbrace{\\vphantom{\\frac{\\partial u}{\\partial x}}\\delta t}_{\\text{time}}.\n\\tag{1.6} Therefore, the (infinitesimal) strain (extension/original length) \n\\delta S_x\n= \\frac{\\delta x(t+\\delta t) - \\delta x(t)}{\\delta x(t)}\n= \\frac{\\partial u}{\\partial x}\\delta t \\quad\\text{so the rate of strain is} \\quad\\frac{\\partial S_x}{\\partial t}\n=\\frac{\\partial u}{\\partial x}= e_{11},\n as hoped/expected.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 1.8: Left: deformation due to extensional strain on the material element at a time t+\\delta t. Right: influence of shear strain on the material element at a time t+\\delta t.\n\n\n\nIt can be shown that the extensional components change the volume V of the fluid element as \n\\frac{1}{V}\\frac{D V}{Dt} = e_{kk}, \\qquad\\text{or symbolically,}\\qquad \\frac{1}{V}\\frac{D V}{Dt} = \\nabla\\cdot{\\boldsymbol{v}}\n\\tag{1.7} so that for an incompressible fluid, where the volume of the fluid element does not change in time (D_t V=0), we have e_{kk}=e_{11}+e_{22}+e_{33}=0. In other words, extension of a fluid element in one direction must lead to contraction in one of the other directions.\n\n\nShear Strain Rate\nThe shear rate of strain acts to drive the element from its rectangular shape. This can be quantified by measuring the angle between the sides. It can be shown that the angle \\theta at CAB in Figure 1.7 evolves according to \n-\\frac{\\partial \\theta}{\\partial t} = 2e_{12}.\n You can check this as an example, if you like!",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Macroscopic Modelling of Fluids</span>"
    ]
  },
  {
    "objectID": "1-2-equations.html",
    "href": "1-2-equations.html",
    "title": "2  The Governing Equations of Fluid Dynamics",
    "section": "",
    "text": "2.1 Conservation of Mass\nFrom Chapter 1, we now have all of the tools required to derive the Navier-Stokes equations. We will focus here on incompressible flows with constant density, but the general case of conservation of mass for a compressible fluid can be found in the final section of this chapter.\nIn general, there are a variety of ways to derive the equations of fluid mechanics, some of which are based on integral representations (see Batchelor’s book, or MA4J1 Continuum Mechanics) and some which directly form the required PDEs by a more ad hoc argument. We will take the latter approach. The route chosen is based on considering the conservation of mass and momentum over an infinitesimal cube in the fluid.\nConsider an infinitesimal volume fixed in space (so that it does not follow the fluid). For simplicity, we is choose this to be a cube, with sides of length \\ell aligned with a Cartesian axes (see Figure 2.1). We assume the cube’s centre is at {{\\boldsymbol{x}}_0} = (x_0, y_0, z_0).\nThe law of conservation of mass tells us that because we have a fluid with constant density (and therefore \\partial_t \\rho=0), the total mass flux in through its six sides must be zero: \n\\begin{aligned}\n  0\n  &=\\ell^2\\Big(\n    -\\rho u(x_0+\\tfrac12\\ell,y_0,z_0) + \\rho u(x_0-\\tfrac12\\ell,y_0,z_0) \\\\\n  &\\hspace{11mm} - \\rho v (x,y_0+\\tfrac12\\ell,z_0) + \\rho v(x,y_0-\\tfrac12\\ell,z_0) \\\\\n  &\\hspace{11mm} - \\rho w(x,y_0,z_0+\\tfrac12\\ell) + \\rho w(x,y_0,z_0-\\tfrac12\\ell)\\Big) \\\\\n  &=\n               -\\ell^3 \\rho \\left( \\frac{\\partial u}{\\partial x} +\\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z}+O(\\ell)\\right).\n\\end{aligned}\n Now, if we assume this has to hold for all cubes as we shrink \\ell, we can take the limit and obtain the desired equation for incompressibility: \n\\frac{\\partial u}{\\partial x} +\\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} =  \\nabla \\cdot  {\\boldsymbol{v}}=0.\n\\tag{2.1}",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Governing Equations of Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "1-2-equations.html#conservation-of-mass",
    "href": "1-2-equations.html#conservation-of-mass",
    "title": "2  The Governing Equations of Fluid Dynamics",
    "section": "",
    "text": "Figure 2.1: Left: An infinitesimal fluid cube aligned with Cartesian axes. Right: The mass flux into the face with outward normal {\\boldsymbol{n}}={\\boldsymbol{e}}_1 = (1, 0, 0) is given by -\\rho v_1(x_0+\\tfrac12\\ell,y_0,z_0) multiplied by the area, A = \\ell^2.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Governing Equations of Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "1-2-equations.html#conservation-of-momentum",
    "href": "1-2-equations.html#conservation-of-momentum",
    "title": "2  The Governing Equations of Fluid Dynamics",
    "section": "2.2 Conservation of Momentum",
    "text": "2.2 Conservation of Momentum\nHere, we will formulate conservation of momentum for a fluid element (which follows the flow), which involves applying Newton’s second law to these material elements. As we already know how to calculate the acceleration using the material derivative, all we require is the forces acting on fluid element. These will split into two contributions - body forces (we will only consider gravitational forces in this course) and internal forces (pressure and stress).\n\nStress\nStress is a crucial and fundamental concept in continuum mechanics. It is the way that we think about the forces which different parts of a continuum object exert on one another. Pressure is an example of a form of stress that you may be familiar with, but note that not all stresses can be thought of as pressure!\n\n\n\n\n\n\nDefinition\n\n\n\nStress is the force per unit area acting on a surface either inside or on the exterior of a region of matter.\n\n\nIn continuum modelling, a fundamental concept quantifying stresses acting across surfaces in a material (both internal and external) is the stress tensor.\n\n\n\n\n\n\nDefinition\n\n\n\nThe component of the Cauchy stress tensor S_{ij} encodes the ith component of the force per unit area vector (the stress vector) acting on the surface element which has outward normal {\\boldsymbol{e}}_j pointing in the jth coordinate direction, see Figure 2.2.\n\n\n\n\n\n\n\n\nFigure 2.2: An infinitesimal cubic fluid element. Shown are the components of the stress tensor acting on one face whose normal aligns with the x-axis. Here, S_11 is the normal stress acting on the face and S_{21} and S_{31} are components of shear stress. Summing up these components gives the stress vector acting on the face.\n\n\n\nFor example, in Cartesian coordinates S_{32}=S_{zy} would be the z-component of stress acting on a face with normal (0,1,0). This encodes a component of ‘shear’ or ‘tangential’ stress, since the force per unit area acts in a different direction to the normal. We will consider cases in which S_{ij}=S_{ji} is symmetric; this is actually a consequence of the balance of linear momentum, but we won’t discuss this further here.\n\n\n\n\n\n\nDefinition\n\n\n\nIn general, the stress at a point on a surface with outward-pointing normal {\\boldsymbol{n}}= (n_1,n_2,n_3) is S_{ij} n_j. This generates a force \\delta F_i = S_{ij} n_j \\,\\delta A over an area \\delta A. The vector t_i = S_{ij} n_j is known as the stress vector.\n\n\nLet us consider forces acting on a infinitesimal cubic fluid element (that follows the fluid) with side length \\ell and centre at {\\boldsymbol{x}}= (x_0, y_0, z_0); see Figure 2.2. We will start with the x-component of this force which will involve us calculating S_{1j} n_j \\delta A (with \\delta A=\\ell^2) over all six sides of the cube. \n\\begin{aligned}\n  \\delta F_1\n  &= \\ell^2 \\Big(\n    S_{11}(x_0+\\tfrac12\\ell,y_0,z_0) - S_{11}(x_0-\\tfrac12\\ell,y_0,z_0)\\\\\n  &\\hspace{13mm}+S_{12}(x,y_0+\\tfrac12\\ell,z_0) - S_{12}(x,y_0-\\tfrac12\\ell,z_0)\\\\\n  &\\hspace{18mm}+S_{13}(x,y_0,z_0+\\tfrac12\\ell) - S_{13}(x,y_0,z_0-\\tfrac12\\ell)\\Big).\n\\end{aligned}\n Taylor expanding this expression for small \\ell and keeping the leading order terms only, we have: \n\\delta F_1 = \\ell^3 \\left(\\frac{\\partial S_{11}(x,y,z)}{\\partial x} +\n\\frac{\\partial S_{12}(x,y,z)}{\\partial y} +  \\frac{\\partial S_{13}(x,y,z)}{\\partial z} \\right)\n= \\ell^3\\,\\frac{\\partial S_{1j}(x,y,z)}{\\partial x_j},\n where we have used the summation convention (with j the repeated index).\nRepeating a similar calculuation for all of the other force components, we have \n\\delta F_i\n= \\ell^3  ~\\frac{\\partial S_{ij}(x,y,z)}{\\partial x_j}.\n Symbolically, we can write this equation using the divergence of the stress tensor: \n\\delta {\\boldsymbol{F}}= \\ell^3 ~\\nabla\\cdot {\\boldsymbol{S}}.\n Just as the divergence turns a vector field into a scalar field, it turns a tensor field into a vector field.\n\n\nCauchy’s Momentum Equation\nRecall that Newton’s second law states that\n\n“The net force on a material element is equal to its mass times its acceleration.”\n\nIn our case, the net force will be composed of internal forces (\\delta F_i) and a body force from gravity, which we will choose to align with the z-axis. Denoting the acceleration due to gravity as g and putting together all the elements of our derivation so far, we have: \n\\underbrace{\\vphantom{\\frac{\\partial S_{ij}}{\\partial x_j}}(\\rho \\ell^3)}_{\\text{Mass}} \\,  \\underbrace{\\vphantom{\\frac{\\partial S_{ij}}{\\partial x_j}}\\frac{D v_i}{Dt}}_{\\text{Acceleration}}\n= \\underbrace{\\ell^3 \\,  \\frac{\\partial S_{ij}}{\\partial x_j}}_{\\text{Force from Stresses}}\n- \\underbrace{\\vphantom{\\frac{\\partial S_{ij}}{\\partial x_j}}(\\rho \\ell^3) g \\, \\delta_{i3},}_{\\text{Gravitational Body Force}}\n where \\delta_{i3}=1 if i=3 and 0 otherwise. Dividing this equation through by the mass term \\rho \\ell^3, we finally have: \n\\frac{D v_i}{Dt} =  \\frac 1 \\rho \\frac{ \\partial S_{ij}}{\\partial x_j}-g \\, \\delta_{i3}\\qquad\\text{or symbolically}\\qquad\n\\frac{D {\\boldsymbol{v}}}{Dt} =  \\frac 1 \\rho \\nabla\\cdot{\\boldsymbol{S}}-g{\\boldsymbol{e}}_z,\n\\tag{2.2} which is called Cauchy’s momentum equation.\n\n\n\n\n\n\nExample\n\n\n\nHow many unknowns and how many equations do we have when we combine Cauchy’s momentum equation with conservation of mass?\n\n\nThe momentum equation is valid for a broad range of continuous media (not only fluids and gases) – e.g. crystals or amorphous solids, and piles of sand or soil (in the continuum limit) – but to make it specifically a fluid equation, one has to specify a particular relevant form of the stress tensor. This particular choice is called a constitutive law, since it tells us what sort of matter constitutes (i.e. makes up) the continuum we are considering.\nWe will start with the simplest case of an inviscid fluid and after consider the more complex case of a viscous (Newtonian) fluid which is more relevant for small scale flows.\n\n\nStress Tensor for an Inviscid fluid\nIn an inviscid fluid there is no friction acting between fluid elements. The only stress acting is a pressure, which is normal to all surfaces and points inward. Therefore, our particular form of the stress tensor (known as a constitutive relation) is \nS_{ij} = - p \\delta_{ij}.\n\n\n\n\n\n\n\nFigure 2.3: In an inviscid fluid the stress is generated entirely by the pressure, which acts with equal magnitude on all faces of our infinitesimal cubic fluid element. Clearly, flow is driven by the pressure changing from point to point, i.e. by spatial gradients in pressure.\n\n\n\nSubstituting into Cauchy’s equation Equation 2.2, we arrive at the Euler equation which describes inviscid fluid flow: \n\\frac{D v_i}{Dt}  =  -\\frac 1 \\rho \\frac{\\partial p}{\\partial x_i}  -g \\, \\delta_{i3}\\qquad\\text{or symbolically}\\qquad\n\\frac{D {\\boldsymbol{v}}}{Dt} =  -\\frac 1 \\rho \\nabla p-g{\\boldsymbol{e}}_z.\n\\tag{2.3}\nNotably, in the absence of gravitational forces we can see clearly that gradients in pressure (\\nabla p) accelerate fluid elements from regions of high to low pressure. This is because at any point the pressure is the same in all directions, so there is only a net force on a fluid element if the pressure varies spatially.\n\n\n\n\n\n\nExample\n\n\n\nIn the absence of fluid motion, what do we recover?\n\n\n\n\nStress Tensor for a Viscous Fluid\nTo describe a viscous fluid, we separate the pressure contribution to the stress tensor from the remaining terms — the latter will be associated with an internal friction (viscosity): \nS_{ij} = - p \\delta_{ij} + \\sigma_{ij},\n\\tag{2.4} where \\sigma_{ij} is called the viscous stress tensor. Note that different texts may use alternative symbols for the stress tensor, viscous stress tensor and rate of strain tensors.\nIn the previous Chapter, we saw that it is the rate of strain tensor e_{ij} which describes the rate of deformation of the fluid, and it is this which generates the viscous stress \\sigma_{ij}. A constitutive relation provides the missing link between \\sigma_{ij} and e_{ij}. When the relationship between these is linear, the fluid is called Newtonian.\nFor an incompressible flow (e_{kk}=0), this simplifies considerably to \n\\sigma_{ij} = 2~ \\mu ~e_{ij} \\qquad\\text{so that}\\qquad S_{ij} = - p~\\delta_{ij} + \\mu\\left(\\frac{\\partial v_i}{\\partial x_j} + \\frac{\\partial v_j}{\\partial x_i}  \\right).\n\\tag{2.5} We see that for an incompressible fluid (e_{kk}=0) the pressure p = -\\text{$\\frac{1}{3}$}(S_{11} + S_{22} + S_{33}) is the mean of the three normal stresses at a point.\nThe dynamic viscosity \\mu (units kg m^{-1} s^{-1}) is the coefficient of proportionality between the rate of strain tensor and the stress tensor which describes how easily a fluid moves under a shear force. Fluids of high viscosity, like honey, flow less easily than those of low viscosity, like water (the density of each of these is similar).\nThe flow of incompressible Newtonian fluids, i.e. those satisfying Equation 2.5, will be the focus of this course and will allow us to consider a huge range of phenomena. However, there are many cases in which non-Newtonian behaviour is encountered so that more complex constitutive relations than Equation 2.5 are required (e.g. the flow of toothpaste or mayonnaise), but these are beyond the scope of this course. Non-Newtonian fluids can create weird and wonderful flows, see for example the following videos.\n\n\nSubstituting Equation 2.5 into Cauchy’s equation Equation 2.2, we obtain: \n\\frac{D v_i}{Dt} =  - \\frac 1 \\rho \\frac{\\partial p}{\\partial x_i} + \\nu \\frac{\\partial^2 v_i}{\\partial x_j^2} -g\\delta_{i3}\n\\qquad\\text{or symbolically}\\qquad\n\\frac{D{\\boldsymbol{v}}}{Dt} =  - \\frac 1 \\rho \\nabla p + \\nu \\nabla^2 {\\boldsymbol{v}}-g{\\boldsymbol{e}}_z,\n\\tag{2.6} where \\nu = \\mu /\\rho is the (assumed constant here) kinematic viscosity coefficient (units m^{2} s^{-1}, as it is a diffusion coefficient for momentum transfer).",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Governing Equations of Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "1-2-equations.html#summary-the-governing-equations",
    "href": "1-2-equations.html#summary-the-governing-equations",
    "title": "2  The Governing Equations of Fluid Dynamics",
    "section": "2.3 Summary: The Governing Equations",
    "text": "2.3 Summary: The Governing Equations\nOur main focus will be on incompressible flow with density constant. In this case, our fundamental governing equation are:\n\n\n\n\n\n\nThe Incompressible Navier–Stokes Equations\n\n\n\n\n\\nabla\\cdot{\\boldsymbol{v}}=0,\\qquad \\frac{D{\\boldsymbol{v}}}{Dt} =  - \\frac 1 \\rho \\nabla p + \\nu \\nabla^2 {\\boldsymbol{v}}-g{\\boldsymbol{e}}_z.\n\\tag{2.7}\n\n\nIn this case, Equation 2.7 forms a closed system, independent of the thermodynamic properties of the fluid. In the general case of d=3, we have 4 equations for 4 unknowns at each point in space and time, the pressure field p and the velocity field, {\\boldsymbol{v}}. Recall the first equation comes from conservation of mass, while the second is a form of Newton’s Second Law.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Governing Equations of Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "1-2-equations.html#sec-flowparameters",
    "href": "1-2-equations.html#sec-flowparameters",
    "title": "2  The Governing Equations of Fluid Dynamics",
    "section": "2.4 Controlling Flow Parameters",
    "text": "2.4 Controlling Flow Parameters\nIn many cases, certain terms in the Navier–Stokes equations associated with particular physical effects are negligible. This means our system of equations can be simplified, sometimes vastly. It is only with these simplifications that we are able to make progress using mathematical analysis, giving great insight into numerous flow configurations, without turning to brute-force computational approaches.\nBelow we will compare the magnitude of different terms in the Navier–Stokes equations to find the Reynolds number, which is an examples of a dimensionless number. The size of the Reynolds number will give an indication of whether the flow can be regarded as viscous or inviscid. The key point here is that this parameter is dimensionless, so that it is meaningful to talk about its magnitude in absolute terms. When a quantity is dimensional, say a length, it makes no sense to say whether it is large or small, as it depends on what we are comparing it to (e.g. a pen is large when compared to the atomic scale, but small compared to that of the universe). In other words, it is only when we make this length dimensionless by considering it relative to a characteristic length of the system, that we are able to establish whether that quantity is large or small. The same holds for the terms in our equations, it only makes sense to say whether a term is large relative to another. Here, we have only touched on the extremely useful area of dimensional analysis.\n\nReynolds number\nConsider a flow whose velocity field varies over a characteristic length L with a typical velocity magnitude (i.e. speed) U. For example, for the air flow around an aeroplane, a typical scale for L could be the wing span and a typical velocity magnitude would be the speed at which the plane flies U, but often it’s not so obvious to establish which L and U to pick. For what values of L, U and kinematic viscosity coefficient \\nu can one neglect viscous forces? For what values of these parameters can one ignore the inertial forces associated with fluid particle acceleration?\nIn steady flow, the typical value of the fluid particle acceleration is |({\\boldsymbol{v}}\\cdot \\nabla) {\\boldsymbol{v}}| \\sim \\frac{U^2}{L}, whereas the typical value of the viscous term is |\\nu \\nabla^2  {\\boldsymbol{v}}| \\sim \\frac{\\nu U}{L^2}. Note these terms have the same units (or dimensions) since they appear as different terms in the Navier–Stokes equation. The ratio of these two typical values is the Reynolds number, i.e. \n\\mathrm{Re}=\\frac{U^2/L}{\\nu U/L} = \\frac {UL}{\\nu}.\n\nTherefore, it appears one can neglect the influence of viscosity if \\mathrm{Re}\\gg 1 (inviscid flow), whereas the fluid particle acceleration term can be ignored if \\mathrm{Re}\\ll 1 (Stokes flow or ‘creeping flow’). The latter is associated with laminar flow, and is critical for small-scale flows (small L) such as those occurring in microfluidics (e.g. look up ‘lab-on-a-chip’ devices), whilst the former can create laminar or turbulent flows and are commonly observed all around us (e.g. weather). If \\mathrm{Re}\\sim 1, then both effects are approximately in balance, and it is much harder to simplify the equations as a result.\nIn fact, things are more complex: even if \\mathrm{Re}\\gg 1 when estimated based on the size L of the flow, the local length-scale in some parts of the flow may get much smaller and, therefore, the local \\mathrm{Re} may get strongly reduced, so that the flow is no longer inviscid. This situation is typical for thin layers close to the solid boundaries—the so-called boundary layers and in wakes behind moving bodies.\n\nThis number is named after Osborne Reynolds (1842-1912) who realised that this combination of dimensional parameters controls the transition from a laminar to turbulent flow in a pipe. \n\nStokes Flow\nWhen the Reynolds number is small, \\mathrm{Re}\\ll1, viscous (frictional) forces dominate inertial effects captured by the acceleration term on the left-hand side of the Navier–Stokes equations. Neglecting the acceleration terms, we obtain the model \n0 = - \\frac 1{\\rho} \\nabla p + \\nu\\nabla^2{\\boldsymbol{v}}- g{\\boldsymbol{e}}_z,\\qquad \\nabla\\cdot{\\boldsymbol{v}}=0.\n\\tag{2.8} This is commonly referred to as ‘Stokes flow’, ‘Creeping Flow’ or ‘Viscous-Dominated flow’ and is often encountered in small-scale flows (where L is small, for example on the order of micrometres). The study, and mathematical analysis, of such flows is a topic in its own right which we will have little opportunity to look into. A quick read of E.M.Purcell’s ‘Life at Low Reynolds Number’, concerned with how small organisms are able to swim, will give an insight into this counter-intuitive world, as does the following video.\n\n\n\n\nSimilarity\nKnowing the parameters that govern a flow allows us to unlock powerful methods of similarity. For example, if we consider incompressible flow and assume that gravitational effects are negligible, then the sole dimensionless parameter formed from the Navier–Stokes equations is the Reynolds number. If we then consider two different flows which are geometrically similar and have the same boundary conditions, then at the same Reynolds numbers the fluid flows will be identical.\nIt is this phenomenon which allows small-scale models to be built and tested before constructing full scale models; this is common in shipbuilding: if the flows are dynamically and geometrically similar, then the flows will be too. For example, if the model is reduced in size by a factor of 10 (L\\rightarrow 0.1L), then one could increase the characteristic speed by a factor of 10 (U\\rightarrow 10U) to ensure \\mathrm{Re} remains unchanged. Another alternative is to alter the viscosity by changing the fluid used in an experiment; here one would need to reduce the viscosity by a factor of 10, which may be harder to do!",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Governing Equations of Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "1-2-equations.html#boundary-and-initial-conditions",
    "href": "1-2-equations.html#boundary-and-initial-conditions",
    "title": "2  The Governing Equations of Fluid Dynamics",
    "section": "2.5 Boundary and initial conditions",
    "text": "2.5 Boundary and initial conditions\nThe Navier–Stokes equations (and variants) are partial differential equations (PDEs). As is usual for PDEs, in order to find a unique solution one has to specify appropriate boundary and initial conditions.\n\nInitial conditions\nThe set of relevant fields must be specified at t=0 at each point {\\boldsymbol{x}} in the domain occupied by the fluid, {\\boldsymbol{x}}\\in V \\subset {\\mathbb{R}}^d. For incompressible fluids one only has to specify the initial velocity field {\\boldsymbol{v}}_0 (as there are no time derivatives on \\rho in this case) \n{\\boldsymbol{v}}({\\boldsymbol{x}},t=0) = {\\boldsymbol{v}}_0.\n Obviously, such an initial velocity field must satisfy relevant boundary conditions (discussed below) and should be divergence-free.\n\n\nBoundary conditions at walls\nThe number of boundary conditions required depends on the bulk equations and their form is determined by the properties of the boundaries (i.e. the physics at the boundary). The two choices discussed below are illustrated in Figure 2.4.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 2.4: An illustration of the no slip boundary condition (left) and the free slip boundary conditions (right). In the no slip case, all components of velocity at the boundary must match, so the velocities are identical. In the free slip case, only the normal components of velocity must match, as the fluid can ‘slip’ along the boundary.\n\n\n\n\nViscous Fluids: No slip\nAt solid impenetrable boundaries, it has been found empirically that in many cases the fluid velocity at the boundary \\partial {  V} of the retaining volume {  V} adjusts itself to the boundary’s velocity {\\boldsymbol{v}}_b: this is the famous no-slip boundary condition: \n{\\boldsymbol{v}}({\\boldsymbol{x}},t) = {\\boldsymbol{v}}_b ({\\boldsymbol{x}},t), \\quad {\\boldsymbol{x}}\\in \\partial {  V}.\n\\tag{2.9}\n\n\nInviscid Fluids: Free slip\nFor inviscid fluids, where one only has first derivatives of fluid velocity (no \\nabla^2{\\boldsymbol{v}} term), one can only enforce inpenetrability of the boundary, i.e. that the normal to the boundary velocity component has to match to the one of the boundary, whereas the parallel velocity component remains arbitrary, since the fluid can slip freely along the boundary in the absence of internal friction. This is the so-called free-slip boundary conditions: \n{\\boldsymbol{v}}^\\perp ({\\boldsymbol{x}},t) = {\\boldsymbol{v}}^\\perp_{b} ({\\boldsymbol{x}},t),\n\\quad {\\boldsymbol{x}}\\in \\partial {  V}.\n\\tag{2.10}\nThese conditions often do not ensure that the flow solution is unique: as we will see later, there are typically infinitely many solutions to the Euler equations satisfying the free-slip boundary conditions, and one has to seek an additional prescription on how to select the physically relevant solution out of the infinite set. This uncertainty and non-uniqueness is a “tragic” consequence of the drastic idealisation of assuming the fluid to be inviscid. In reality, no matter how high the Reynolds number is, there is always a thin layer of fluid close to the boundary where viscosity is important and must be taken into account: this is the so-call boundary layer, which we will not have time to consider.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Governing Equations of Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "1-2-equations.html#modelling-frameworks",
    "href": "1-2-equations.html#modelling-frameworks",
    "title": "2  The Governing Equations of Fluid Dynamics",
    "section": "2.6 Modelling Frameworks",
    "text": "2.6 Modelling Frameworks\nThe range of phenomena which the Navier–Stokes equations combined with no-slip at solid surfaces can describe is truly remarkable. However, there are also many cases in which they breakdown - for example, in the flow of non-Newtonian fluids or as one approaches small scales where additional physics comes into play (e.g. thermal motion).\nWe may wonder how to model flows in which \\ell/L is not small, by going to a more well resolved theory than continuum mechanics. Unlike in continuum mechanics, where the Navier–Stokes equations can be (remarkably) used for liquid and gases, for small scale flows, where L\\sim \\ell, different options exist. Notably, for gas flows there is also the possibility that \\ell becomes much larger, as is the case for re-entrant space craft where the atmosphere is significantly more rarefied.\nOne option is molecular dynamics, where individual molecules are evolved via Newton’s laws of motion under the action of a potential, that is typically short range repulsive (so molecules don’t overlap) and long-range attractive (creating cohesion in the fluid). Such techniques can offer us great insight when flows are on molecular scales (e.g. nm), but to do so we must have accurate potentials to describe the motion. Typically, in the fluid dynamics community relatively simple potentials are used (e.g. Lennard Jones, or some water models) and the focus is usually not on the chemical nature of the fluid, but rather its flow properties (viscosity, density, etc). The following video shows the coalescence of water nanodrops.\n\nFor the case of gases, one can also use molecular dynamics, but due to its often dilute nature one can develop statistical approaches that rely on the fact that binary collisions between molecules are their most likely form of interaction (i.e. there is no attractive force considered). The result is the Boltzmann equation (in the field of rarefied gas flows or kinetic theory) which provides a partial differential equation for the particle distribution function f=f({\\boldsymbol{x}},{\\boldsymbol{c}},t) which gives the probability of a molecule having velocity {\\boldsymbol{c}} at position {\\boldsymbol{x}} and time t. Notably, the Boltzmann equation sits in a seven-dimensional space (3 spatial, 3 velocity, 1 time), in contrast to continuum mechanics where is 4-dimensional (3 spatial, 1 time), meaning that computational solutions become far more costly. The usual solution method is so-called direct simulation Monte-Carlo (DSMC) although other approaches are also used.\n\nThere is a huge rich variety of other modelling frameworks including density functional theory (acting below molecular dynamics), coarse grained molecular models (e.g. dissipative particle dynamics), extensions of the Boltzmann equation (e.g. the Enskog equation for less dilute gases), fluctuating hydrodynamics (that puts thermal fluctuations into continuum mechanics) and models that themselves can be considered averages of the Navier–Stokes equations (e.g. Brinkmann or Darcy’s equation of flow through porous media).\nA significant strand of fluids research at Warwick is concerned with models that go ‘beyond’ the Navier–Stokes (–Fourier) paradigm and yet remain broadly within the same PDE framework. An instructive example comes from the kinetic theory of gases where the Navier–Stokes equations can be derived from the Boltzmann equation. However, what one can see clearly in this derivation, e.g. using Grad’s method of moments to derive macroscopic equations from the Boltzmann equation, is that the Navier–Stokes equations are just the start of the story. At higher orders one can have slip between a gas and a solid and more complex constitutive laws appear (leading to larger systems of equations) - more of the story is covered in PX921 Micro & Nano Flows across Scales. Notably, however, as one may expect, many of the conservation laws remain unchanged.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Governing Equations of Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "1-2-equations.html#sec-flu-compressible",
    "href": "1-2-equations.html#sec-flu-compressible",
    "title": "2  The Governing Equations of Fluid Dynamics",
    "section": "2.7 Compressible Fluids*",
    "text": "2.7 Compressible Fluids*\nThis section is extension material on compressible fluids.\n\nConservation of mass\nHere we will consider conservation of mass for a compressible fluid in which density is no longer assumed constant.\nConsider an infinitesimal volume fixed in space (i.e. it does not follow the fluid), which for simplicity is chosen to be a cube, with sides of length d aligned with a Cartesian axes (see Figure 2.1), so that its bottom corner is at {\\boldsymbol{x}}_0 = (x_0, y_0, z_0).\nThe law of conservation of mass tells us that the rate of increase of fluid mass (volume d^3 times rate of change of density \\partial_t \\rho) inside this cube is equal to the total mass flux in through its six sides: \n\\begin{aligned}\nd^3 \\frac{\\partial\\rho}{\\partial t}\n&= d^2 \\Big[-\\rho(x_0+d,y,z) u(x_0+d,y,z) + \\rho(x_0,y,z) u(x_0,y,z) \\\\\n&\\qquad\\qquad- \\rho(x,y_0+d,z) v (x,y_0+d,z) + \\rho(x,y_0,z) v(x,y_0,z)\\\\\n&\\qquad\\qquad- \\rho(x,y,z_0+d) w(x,y,z_0+d) + \\rho(x,y,z_0) w(x,y,z_0)\\Big]\n\\end{aligned}\n\nDividing both sides by d^3, in the limit of small d we get the desired equation: \n\\frac{\\partial\\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} +\\frac{\\partial (\\rho v)}{\\partial y}+\\frac{\\partial (\\rho w)}{\\partial z} =  \\frac{\\partial\\rho}{\\partial t} + \\nabla \\cdot  (\\rho  {\\boldsymbol{v}}) =0.\n\\tag{2.11} Now that the equation is in vector form, we can apply it to any coordinate system (despite being derived in Cartesian).\n\n\nNewton’s Second Law\nThe derivation of Cauchy’s equation Equation 2.2 remains valid for compressible flow, but the consitutive relation for the Cauchy stress tensor will change. In such cases, the most general isotropic form of an isotropic constitutive relation determined as a linear function of the rate of strain tensor e_{ij} is \nS_{ij} = 2 \\mu \\underbrace{\\bigg(e_{ij} - \\frac 1 3  \\delta_{ij} \\, e_{kk}\n\\bigg)}_{\\text{Rate of shear strain}}\\quad + \\quad\n\\xi\\hspace{-6mm}\\underbrace{\\vphantom{\\bigg(}\\,  \\,  e_{kk}\\delta_{ij},\\,}_{\\text{Rate of volumetric strain}}\n\\tag{2.12} where \\mu is the shear viscosity coefficient, \\xi is the bulk viscosity coefficient, and e_{kk} = e_{11}+e_{22}+e_{33}= \\nabla \\cdot {\\boldsymbol{v}} is the trace of tensor e_{ij}.\n\n\nOther considerations\nIn general, for compressible flows we will also require an energy balance relation and an equation of state specifying the properties of the medium. However, there is a simpler class of flows where we can assume p=p(\\rho) to close the system, known as barotropic flows, where for the simplest case of isentropic gas we have \np \\propto {\\rho^\\gamma}\n\\tag{2.13} where \\gamma is a constant whose value depends on the properties of the gas.\nFor many cases, especially for liquids, we will see that the velocity is approximately divergence-free, so that conservation of mass is simply \n\\nabla\\cdot{\\boldsymbol{v}}=0.\n\\tag{2.14} In this case \n\\frac{1}{\\rho}\\frac{D \\rho}{Dt} =0.\n\n\n\nInitial and boundary conditions\nIn compressible fluids, one has to additionally specify the initial density and entropy, or chose another couple of thermodynamic fields which would be most relevant to the specific problem (temperature, pressure, etc.).",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The Governing Equations of Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "1-3-canonical.html",
    "href": "1-3-canonical.html",
    "title": "3  Canonical Flows",
    "section": "",
    "text": "3.1 2D Flows\nIn this chapter we will consider simple flow configurations in which the governing equations can be simplified to allow for analytic solutions to be obtained. Analytic solutions are both useful to gain understanding of a particular problem but also to provide benchmark cases against which CFD solutions can be tested.\nOne possible simplification we can make to the full Navier-Stokes equations is to consider flows that move the fluid in 2D only, reducing the number of dimensions we need by one. In such 2D flows, the velocity field has two components which depend on two physical space coordinates and time, {\\boldsymbol{v}}= (u(x,y,t), v(x,y,t),0). In this case, the vorticity field has only one non-zero component, {\\boldsymbol{\\omega}}= (0,0,\\omega(x,y,t)).\nFor 2D incompressible flows, a mathematically convenient tool is to introduce a representation of the velocity field in terms of a special function, defined as follows.\nThe utility of the stream function is that it guarantees that the flow automatically satisfies the condition of incompressibility, and it means there is one fewer field we need to find (we now only need \\psi and the pressure, p). In terms of the stream function the z-component of vorticity is: \n\\omega =  \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}= -\\nabla^2 \\psi.\n\\tag{3.2}",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Canonical Flows</span>"
    ]
  },
  {
    "objectID": "1-3-canonical.html#d-flows",
    "href": "1-3-canonical.html#d-flows",
    "title": "3  Canonical Flows",
    "section": "",
    "text": "Definition\n\n\n\nThe stream function, denoted \\psi (x,y,t), has the property that \nu = \\frac{\\partial \\psi}{\\partial y}, \\quad\nv = -  \\frac{\\partial \\psi}{\\partial x}.\n\\tag{3.1}\n\n\n\n\nRelation to Streamlines\nWe now explore the reason for the name of the stream function, showing that curves where \\psi=\\text{constant} are streamlines of the flow.\nFrom the definition of the stream function Equation 3.1 we have \n{\\boldsymbol{v}}\\cdot \\nabla\\psi = u\\frac{\\partial \\psi}{\\partial x} +  v\\frac{\\partial \\psi}{\\partial y}=0.\n This mean that in steady flows (where \\frac{\\partial \\psi}{\\partial t} =0 so that \\frac{\\partial{\\boldsymbol{v}}}{\\partial t}=0 too), we have \n\\frac{D \\psi}{D t}=\\frac{\\partial \\psi}{\\partial t}+{\\boldsymbol{v}}\\cdot\\nabla\\psi =0,\n i.e. \\psi is conserved along the fluid paths. This means that in steady flows the fluid particles move along lines of constant \\psi (streamlines, as defined in Chapter 1), and this explains the name ‘stream function’.\n\n\nVolume flux\nAnother nice propert is that there is a nice relation to the volume flux across a curve connecting 2 points. The volume flux of fluid, per unit length (as we’re in 2D), across a curve between points a and b is given by \nQ = \\int_{a}^{b} {\\boldsymbol{v}}\\cdot{\\boldsymbol{n}}\\,ds\n where s is the arclength along a curve between a and b and {\\boldsymbol{n}}=(\\partial_s y, -\\partial_s x) is the normal to this curve. Substituting our expressions for the normal and the velocity in terms of the streamfunction, we obtain \nQ = \\int_{a}^{b} \\left(\\frac{\\partial \\psi}{\\partial y}\\frac{\\partial y}{\\partial s}\n+ \\frac{\\partial \\psi}{\\partial x}\\frac{\\partial x}{\\partial s}\\right) ds\n= \\int_{a}^{b} \\frac{d\\psi}{ds} ds = \\left[\\psi\\right]^{b}_{a} = \\psi(b)-\\psi(a).\n In other words, the difference of the streamfunction at two points tells us the value of Q for any curve connecting those two points. The fact that there is unique value for this is something that arises purely due to incompressibility in 2D!",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Canonical Flows</span>"
    ]
  },
  {
    "objectID": "1-3-canonical.html#plane-parallel-shear-flows",
    "href": "1-3-canonical.html#plane-parallel-shear-flows",
    "title": "3  Canonical Flows",
    "section": "3.2 Plane-Parallel Shear Flows",
    "text": "3.2 Plane-Parallel Shear Flows\nThe most basic 2D flows have plane-parallel configuration in which the velocity field is everywhere in the same direction and constant along that direction, i.e. \n{\\boldsymbol{v}}( {\\boldsymbol{x}}, t) = (u (y,t), 0,0);\n\\tag{3.3} see Figure 3.1. These flows are simple enough that we don’t even really need the stream function; the stream lines are all just lines of the form y=\\text{constant}.\n\n\n\n\n\n\nFigure 3.1: An example of plane-parallel shear flow.\n\n\n\nThe incompressibility condition for such a velocity field is automatically satisfied, as \\frac{\\partial v_i}{\\partial x_i}=0, and the nonlinear term v_j\\frac{\\partial v_i}{\\partial x_j} is automatically zero which greatly simplifies finding solutions. Writing the Navier–Stokes equation in components, we have \n\\begin{aligned}\n\\underbrace{ \\frac{\\partial u}{\\partial t}}_{\\text{Function of }y,t} &= -\\frac 1 \\rho  \\frac{\\partial p}{\\partial x}+\\underbrace{\\nu  \\frac{\\partial^2 u}{\\partial y^2},}_{\\text{Function of }y,t} \\\\\n0 &= -\\frac 1 \\rho  \\frac{\\partial p}{\\partial y}.\n\\end{aligned}\n\\tag{3.4} From the second equation we see that the pressure is independent of y, so that p=p(x,t). From the first one, we see that its dependence on x is linear, i.e. the pressure force is uniform and in the x-direction, -\\nabla p/\\rho = G(t) {\\boldsymbol{e}}_x where G is a function of only time. This leads to the following equation \n\\frac{\\partial u}{\\partial t}  = G +\\nu  \\frac{\\partial^2 u}{\\partial y^2}.\n\\tag{3.5}\n\nInviscid Steady Plane-Parallel Flow\nLet us consider a steady plane-parallel shear flow so that \\partial_t {\\boldsymbol{v}}=0 and \\nu=0. Then we have from Equation 3.4 that \n0=  -\\frac 1 \\rho  \\frac{\\partial p}{\\partial x},\\qquad 0 = -\\frac 1 \\rho  \\frac{\\partial p}{\\partial y},\n so that the equations are satisfied for all {\\boldsymbol{v}}= (u(y), 0, 0) with p=\\text{constant}.\n\n\nCouette Flow (surface driven)\n\n\n\n\n\n\nExample\n\n\n\nConsider now a steady viscous plane shear flow, {\\boldsymbol{v}}= (u(y),0,0), between two infinite plates at y=-W and y=W, which are moving in the x-direction with velocities U and -U respectively; see Figure 3.2. Pressure in the flow is uniform in space (the flow is not pressure driven). What is the velocity field?\n\n\n\n\n\n\n\n\nFigure 3.2: Couette flow.\n\n\n\n\n\nPoiseuille Flow (pressure driven)\nConsider now a steady viscous plane shear flow, with boundaries stationary and the flow is driven by a pressure gradient. Consider a plane-parallel flow, {\\boldsymbol{v}}= (u(y),0,0), between two infinite plates at y=W and y=-W which are fixed (not moving); see Figure 3.3. The flow is driven by a uniform pressure gradient in the x-direction, -\\frac{\\partial p }{\\partial x} /\\rho = G where G= const.\n\n\n\n\n\n\nFigure 3.3: Poiseuille flow.\n\n\n\nTherefore from Equation 3.5 we have \n\\frac{\\partial p }{\\partial x} /\\rho = - G= \\nu \\frac{\\partial^2 u}{\\partial y^2} .\n The solution of this equation is u(y)=-\\frac G {2 \\nu} y^2 +By+C. The no-slip boundary conditions to be satisfied are u(W) =u(-W) =0. Thus B=0 and C=  \\frac G {2\\nu} W^2, i.e. \nu(y) = \\frac G {2\\nu} (W^2 -y^2).\n\nThe volume flux can then be computed as \nQ=\\int_{-W}^{W} u \\,dy = \\left[\\frac{ G}{2\\nu} (W^2y -y^3/3)\\right]_{-W}^{W} = \\frac{2 G W^3}{3\\nu}\\propto W^3,\n which shows that the mass flux is proportional to the cube of the channel width W for a given pressure gradient.\nFor obvious reasons the Poiseuille flow is often called channel flow. Its analogue in cylindrical geometry is a flow commonly observed in pipes/tubes or our blood vessels and here, Q\\propto R^4 where R is the radius of the pipe. A video showing this can be found below.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Canonical Flows</span>"
    ]
  },
  {
    "objectID": "1-3-canonical.html#sec-flu-proj1",
    "href": "1-3-canonical.html#sec-flu-proj1",
    "title": "3  Canonical Flows",
    "section": "3.3 Fluids Coursework Project Option 1",
    "text": "3.3 Fluids Coursework Project Option 1\nThis project is entitled Poiseuille Flow at the Micro and Nanoscale, and is one of two project options you will have in this section of the module. The second will be described in Section 4.4.\n\nProject aims\nYou should write an approximately 10 page report that demonstrates:\n\nEngagement with the literature on flow through micro and nano geometries where the no-slip boundary condition is violated;\nComputational results for Poiseuille flow through channels and pipes for a variety of different boundary conditions; and\nValidation of code against your own analytic results as well as experimental and/or theoretical results from the published literature.\n\n\n\n\nPipe flow\nA more common pressure-driven flow than channel flow is the flow of liquids and gases through pipes/tubes. For pipe flow, the natural coordinate system to consider is the cylindrical coordinates (r,\\theta,z), with the z-coordinate along the centre-line of the pipe and the boundary located at a constant radius r=R (see Figure 3.4) - in this case the domain will be 0\\le r\\le R. We can assume that the velocity takes the form {\\boldsymbol{v}}= v_z(r){\\boldsymbol{e}}_z, so that, using the Navier–Stokes in cylindrical coordinates (see Appendix) and in the absence of gravity, we have: \n0 =  -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial z} +\\nu\\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial v_z}{\\partial r}\\right)\n where we have applied the boundary condition of no slip u(R)=0 and smoothness at r=0, i.e. \\frac{\\partial v_z}{\\partial r}=0 there.\n\n\n\n\n\n\nFigure 3.4: Pipe flow geometry.\n\n\n\nAs an exercise you should show that when you haven no-slip v_z(r=R)=0 the analytic solution to this equation is \nv_z =  \\frac{G}{4\\nu}(R^2 - r^2)\n where G=-\\frac{1}{\\rho}\\frac{\\partial p}{\\partial z} is the (constant) imposed pressure gradient. From this you should be able to find the volume flux and show that it is \\propto R^4.\n\n\nSlip\nA generalisation of the no-slip condition is the Navier slip (known as Maxwell slip for gases) condition which states that the tangential velocity at a solid surface is linearly proportional to the shear stress imposed upon this boundary. The coefficient of proportionality is known as the ‘slip length’ \\ell; when \\ell=0 the no-slip boundary condition is recovered.\nFor the case of a plane-parallel shear flow, in the geometry considered above, the Navier slip condition is \n\\ell \\frac{\\partial u}{\\partial y} = \\pm u\\qquad \\text{at}\\qquad y=\\mp W\n and replaces the tangential part of the no-slip boundary condition. This mean we still have zero velocity normal to the boundary v=0, due to impermeability, but now u\\neq0 in general, just as happens for a free slip condition. Note that the \\pm comes from the fact that the shear stress {\\boldsymbol{n}}\\cdot{\\boldsymbol{S}}\\cdot{\\boldsymbol{t}} depends on the normal vector to a boundary\nIn cylindrical coordinates this condition takes the form \n\\ell \\frac{\\partial v_z}{\\partial r} = -v_z\\qquad \\text{at}\\qquad r=R\n\nGenerally, at large scales the no-slip boundary condition provides exceptionally accurate results (e.g. for aeronautics); however, as one goes to micro- and nano-scales, large deviations are observed, both experimentally and from molecular simulations, for the flow of both gases and liquids. This suggests the slip length is of the order of microns or below. The easiest system in which to measure these deviations is pipe flow, where one can measure the flux through a tube and compare to analytic solutions obtained with different boundary conditions. This has become a particularly hot-topic due to the possibility of using carbon nanotubes in a membrane to filtrate seawater into drinking water - see article by Reese 2011 (in the Reading List).\n\n\n\nProject Ideas\nThe suggestions below are intended to give you ideas of what can be done, but you should feel free to follow your own path if you wish.\nA starting point for this project is to compute Poiseuille flow in a channel, as considered within the Week 3 Workshop. Two extensions that should be considered are to consider flow through a pipe, rather than a channel, and to change the boundary conditions to allow for slip. You will then be able to compare your results to experiments, such as the volume flux data provided in Whitby et al 2008 (see Reading List below).\n\nPipe Flow\nSuggested tasks:\n\nDerive an analytic solution for 3D axisymmetric flow and use this to calculate the volume flux.\nExtend your 2D code to 3D axisymmetric flow and ensure agreement with the analytic result. Note, care must be taken at r=0 as the coordinate system creates 1/r terms there. A simple way to impose \\frac{\\partial v_z}{\\partial r}=0 there is to directly impose this equation (instead of the bulk one) by setting v_1=v_2, which is equivalent to a forward difference at this point. You can also explore other possibilities if you like.\nRepeat any steps for channel flow of interest to you.\n\n\n\nSlip\nSuggested tasks:\n\nIncorporate a Navier-Slip condition for channel flow and see how this modifies the solution (note: an analytic solution is still easily attainable) and in particular he volume flux.\nDo the same for pipe flow.\n\n\n\nGoing further\nFor those feeling ambitious, here are some further suggestions:\n\nImplement the non-linear slip condition derived in Thompson & Troian’s 1997 article (see Reading List), which is an extension of the Navier-Slip condition. Derive an appropriate boundary condition for pipe flow.\nUse a higher order boundary condition derived for gases and see what this changes. One example is equation (7) in Lockerby et al’s 2004 article (see Reading List).\nConsider the model proposed in Myers 2011, where the nanoscale effects are attributed to changes in the viscosity near the wall, with no-slip retained.\n\n\n\nReading List\nArticles below are just a starting point for your investigations and should not be considered exhaustive:\n\nReese, J., 2011. ‘Water, water, everywhere, Nor any drop to drink’?. Physics World, 24(06), p.28.\nPopular article about the use of molecular dynamics simulations to aid in the development of filtration technologies based on carbon nanotubes.\nLauga, E., Brenner, M. and Stone, H., 2007. Microfluidics: the no-slip boundary condition. Springer handbook of experimental fluid mechanics, pp.1219-1240.\nGood background/historical perspective for the no-slip boundary condition and a good source of references. Sections 1-3 are most relevant.\nLauga, E. and Stone, H.A., 2003. Effective slip in pressure-driven Stokes flow. Journal of Fluid Mechanics, 489, pp.55-77.\nConsideration of slip in pipes caused by alternating regions of no-slip and no-shear (probably induced by trapped gas at the solid).\nWhitby, M., Cagnon, L., Thanou, M. and Quirke, N., 2008. Enhanced fluid flow through nanoscale carbon pipes. Nano letters, 8(9), pp.2632-2637.\nExperimental measurements of flow through carbon nanotubes.\nThompson, P.A. and Troian, S.M., 1997. A general boundary condition for liquid flow at solid surfaces. Nature, 389(6649), p.360.\nExtension of the Navier-Slip boundary condition to a non-linear equation.\nLockerby, D.A., Reese, J.M., Emerson, D.R. and Barber, R.W., 2004. Velocity boundary condition at solid walls in rarefied gas calculations. Physical Review E, 70(1), p.017303.\nConsideration of potential slip conditions at the solid boundary of a gas flow.\nMyers, T. G., 2011. Why are slip lengths so large in carbon nanotubes?. Microfluidics and nanofluidics, 10(5), pp.1141-1145.\nA model using no-slip but accounting for nano-effects via a thin layer of fluid attached to the solid that has a different viscosity.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Canonical Flows</span>"
    ]
  },
  {
    "objectID": "1-3-canonical.html#sec-vortices",
    "href": "1-3-canonical.html#sec-vortices",
    "title": "3  Canonical Flows",
    "section": "3.4 Circular Flows",
    "text": "3.4 Circular Flows\nSimilar to the plane parallel shear flows in which velocity is a function of one Cartesian coordinate only, one can consider flows with circular streamlines. Again, this leads to simple enough situations that we don’t need to use the full stream function \\psi.\nWe consider cylindrical polar coordinates (r,\\theta,z) with 2D flow in the (r,\\theta)-plane. Here, the power of using vector calculus becomes apparent, as the vector equations are valid in all coordinate systems and the relevant operators can quickly be looked up when required (they are in the Appendix)\n\nCircular flows\nLet us consider a steady 2D flow, {\\boldsymbol{\\omega}}= (0,0,\\omega), such that in polar coordinates the velocity depends only on the radius and not on the polar angle, {\\boldsymbol{v}}= {\\boldsymbol{v}}(r) where r =\\sqrt{x^2+y^2}. An example of such a flow is shown in Figure 3.5.\n\n\n\n\n\n\nFigure 3.5: A generic circular flow; streamlines are dashed, velocity vectors shown in red.\n\n\n\nFrom the incompressibility condition, with {\\boldsymbol{v}}={\\boldsymbol{v}}(r) = v_r{\\boldsymbol{e}}_r + v_\\theta {\\boldsymbol{e}}_\\theta, \n\\nabla\\cdot{\\boldsymbol{v}}= \\frac{1}{r}\\frac{\\partial (rv_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_{\\theta}}{\\partial\\theta} = 0,\n we find that the radial component of the velocity field is zero everywhere in physical space, as v_r\\propto r^{-1} would mean there is a source of mass at r=0, which there is not. We have \n{\\boldsymbol{v}}= v_\\theta (r) \\, {\\boldsymbol{e}}_\\theta,\n so that the Navier–Stokes equations become: \n- \\frac{v_\\theta^2}{r}  =  -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\n \n0 =  -\\frac{1}{\\rho r}\\frac{\\partial p}{\\partial \\theta} + \\underbrace{\\nu\\left( \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial  v_\\theta }{\\partial r}\\right) -\\frac{v_\\theta}{r^2} \\right)}_{\\text{function of }r\\text{ only}},\n As \\frac{\\partial p}{\\partial \\theta} is a function of only r, to keep p single valued we must have \\frac{\\partial p}{\\partial \\theta}=0. Otherwise, if \\frac{\\partial p}{\\partial \\theta}=f(r), for some function f(r), then p=f(r)\\theta+\\text{constant}, which would be multi-valued.\nIf we make the further assumption that the flow is inviscid \\nu=0 then we are simply left with \n- \\frac{v_\\theta^2}{r}  =  -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r},\n so that any v_\\theta(r) satisfies the equations and can then be used to find the pressure distribution, as if often the case for inviscid flow.\nThe vorticity is then \n{\\boldsymbol{\\omega}}= \\frac{1}{r} \\frac{\\partial (r v_\\theta)}{\\partial r} {\\boldsymbol{e}}_z.\n which has an axis in the z-direction (‘out of the page’) as we would expect for flow confined to the (r,\\theta)-plane.\n\n\nSolid Body Rotation\nConsider the circular streamlines generated by the velocity field \nv_{\\theta}(r) = \\Omega r.\n\nWith this velocity, the fluid moves as a rigid body, so that there is local rotation, i.e. the vorticity is non-zero: \\omega = 2\\Omega and is twice the angular velocity \\Omega, as expected. Therefore, there is local rotation, see Figure 3.6, and fluid particles on the circular streamlines rotate.\nThe pressure distribution can then be calculated as \n\\frac{\\partial p}{\\partial r} = \\rho v_{\\theta}^2/r= \\rho \\Omega^2 r \\qquad\\rightarrow\\qquad p = \\rho \\Omega^2 r^2/2 + C\n where C is a constant.\nA video showing rigid body rotation can be found below.\n\n\n\nPoint Vortices\nA point vortex is a useful idealisation in which we consider all of the vorticity to be concentrated at a point. The velocity field is then \nv_{\\theta}(r) = \\frac{a}{r}.\n\nInterestingly, we see that with this velocity field, the flow outside the singularity at the origin is irrotational \n\\omega = \\frac{1}{r}\\frac{\\partial (r v_{\\theta})}{\\partial r} - \\frac{1}{r}\\xcancel{\\frac{\\partial v_r}{\\partial \\theta}} = 0,\n i.e. there is no local rotation in the flow field. The velocity field then looks as shown in the first panel of Figure 3.6, with fluid particles on the circular streamlines retaining a fixed orientation.\nHowever, if we can use Stokes’ theorem to show that a point vortex has a singular vorticity which is located at the origin. Taking a circular contour of radius R around the origin we have that the circulation \\Gamma is given by: \n\\Gamma = \\oint_{C} {\\boldsymbol{v}}\\cdot d\\boldsymbol{\\ell} = 2\\pi R v_{\\theta} = 2\\pi a\n so that using Stokes’ theorem, we find \n\\Gamma = \\int_{A} {\\boldsymbol{\\omega}}\\cdot{\\boldsymbol{n}}\\,dA = 2\\pi a\\neq 0.\n However, we know that the flow is irrotational for r&gt;0, so we must have all of the vorticity concentrated at the origin \n\\omega = \\Gamma \\delta({\\boldsymbol{x}}) = 2\\pi a \\delta({\\boldsymbol{x}}).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.6: Examples of round vortices. First panel: a solid-body rotation, in which fluid particles (smiley faces) rotate. Second panel: a point vortex flow, in which the motion is irrotational. A simple analogy is that the solid body rotation is to think of a person on a merry-go-round for the solid body rotation (where the rotate with the motion) and a Ferris wheel for the point vortex (where you always remain orientated in an upright position, hopefully!).\n\n\n\nThe pressure distribution, satisfies the r-component of the steady state Euler equation \n\\frac{\\partial p}{\\partial r} =\\rho v_{\\theta}^2/r = \\rho a^2/r^3 \\qquad\\rightarrow\\qquad p = p_{\\infty}-\\rho a^2/ (2r^2)\n where p_{\\infty} is the constant pressure value ‘at’ infinity.\nA video showing this motion can be found below.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Canonical Flows</span>"
    ]
  },
  {
    "objectID": "1-3-canonical.html#navierstokes-in-cylindrical-polar-coordinates",
    "href": "1-3-canonical.html#navierstokes-in-cylindrical-polar-coordinates",
    "title": "3  Canonical Flows",
    "section": "3.5 Navier–Stokes in Cylindrical Polar Coordinates*",
    "text": "3.5 Navier–Stokes in Cylindrical Polar Coordinates*\nIn this extension section, we provide a brief discussion of the Navier-Stokes equations in cylindrical polar coordinates. These are useful for general problems which have circular symmetry, such as that considered in pipe flow.\nIn cylindrical polar coordinates (r,\\theta,z), for a velocity field {\\boldsymbol{v}}= v_r {\\boldsymbol{e}}_r + v_\\theta {\\boldsymbol{e}}_\\theta + v_z {\\boldsymbol{e}}_z, we have that the divergence is expressed as \n\\nabla\\cdot{\\boldsymbol{v}}= \\frac{1}{r}\\frac{\\partial (rv_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_\\theta}{\\partial \\theta}+\\frac{\\partial v_z}{\\partial z}.\n This expression allows us to find the incompressibility condition in this cylindrical coordinate system.\nThe vorticity in cylindrical coordinates is the curl, which is expressed as is \n{\\boldsymbol{\\omega}}= \\nabla\\times{\\boldsymbol{v}}= \\left(  \\frac{1}{r}\\frac{\\partial v_z}{\\partial \\theta} - \\frac{\\partial v_\\theta}{\\partial z}  \\right){\\boldsymbol{e}}_r + \\left( \\frac{\\partial v_r}{\\partial z} - \\frac{\\partial v_z}{\\partial r}  \\right){\\boldsymbol{e}}_\\theta + \\frac{1}{r}\\left( \\frac{\\partial (r v_\\theta)}{\\partial r} - \\frac{\\partial v_r}{\\partial \\theta}  \\right){\\boldsymbol{e}}_z.\n For a scalar field f=f(r,\\theta,z,t), the gradient is \n\\nabla f= \\frac{\\partial f}{\\partial r}{\\boldsymbol{e}}_r + \\frac{1}{r}\\frac{\\partial f}{\\partial \\theta}{\\boldsymbol{e}}_\\theta+\\frac{\\partial f}{\\partial z}{\\boldsymbol{e}}_z.\n All of these expressions can be derived from their Cartesian equivalents, but is a rather time-consuming exercise. A handy online reference for these (and other operators in other coordinate systems) is provided on Wikipedia, see the table here.\nUsing these calculus operators, and working through, Navier–Stokes equations, with gravitational force in the negative z-direction are given by: \n\\begin{aligned}\n\\frac{\\partial v_r}{\\partial t} + v_r \\frac{\\partial v_r}{\\partial r} + \\frac{v_\\theta}{r}\\frac{\\partial v_r}{\\partial \\theta} + v_z\\frac{\\partial v_r}{\\partial z} - \\frac{v_\\theta^2}{r}\n&=  -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} + \\nu\\left(\\Delta v_r -\\frac{v_r}{r^2}-\\frac{2}{r^2}\\frac{\\partial v_\\theta}{\\partial \\theta} \\right),\\\\\n\\frac{\\partial v_\\theta}{\\partial t} + v_r \\frac{\\partial v_\\theta}{\\partial r} + \\frac{v_\\theta}{r}\\frac{\\partial v_\\theta}{\\partial \\theta} + v_z\\frac{\\partial v_\\theta}{\\partial z} + \\frac{v_r v_\\theta}{r}\n&=  -\\frac{1}{\\rho r}\\frac{\\partial p}{\\partial \\theta} + \\nu\\left(\\Delta v_\\theta -\\frac{v_\\theta}{r^2}+\\frac{2}{r^2}\\frac{\\partial v_r}{\\partial \\theta} \\right),\\\\\n\\frac{\\partial v_z}{\\partial t} + v_r \\frac{\\partial v_z}{\\partial r} + \\frac{v_\\theta}{r}\\frac{\\partial v_z}{\\partial \\theta} + v_z\\frac{\\partial v_z}{\\partial z}\n&=  -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial z} +\\nu\\Delta v_z - g,\\\\\n\\frac{1}{r}\\frac{\\partial (rv_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_\\theta}{\\partial \\theta}+\\frac{\\partial v_z}\n{\\partial z}\n&=0,\n\\end{aligned}\n where the first three equations are Cauchy’s momentum equation Equation 2.2, the latter equation is the incompressibility condition Equation 2.1, and the Laplace operator \\Delta used in the equations is expressible as \n\\Delta = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial }{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial \\theta^2} + \\frac{\\partial^2 }{\\partial z^2}.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Canonical Flows</span>"
    ]
  },
  {
    "objectID": "1-4-free-surfaces.html",
    "href": "1-4-free-surfaces.html",
    "title": "4  Free Surface Flows",
    "section": "",
    "text": "4.1 Boundary conditions at a free surface\nFree surfaces exist in a variety of contexts where two phases that are immiscible (i.e. they don’t mix) meet at an interface. Examples include the solidification front of ice in a water drop, or the surface of a pond where water meets air. We will be interested in the latter case, where two immiscible fluids come into contact with each other. Later on, for simplicity, we will focus on the relatively simple situation where one of these fluids is a liquid and the other is a passive gas.\nA significant focus in this chapter will be the introduction of boundary conditions that can be applied at the liquid-gas interface. In this case, there is a so-called ‘free boundary’ between the liquid and a fluid above, as occurs on the surface of the sea, on the surface of a gas bubble in a fizzy drink, or on the surface of a raindrop. We need to formulate boundary conditions for these cases which reflect the fact that the surface’s shape must be obtained as a part of the solution (i.e. it is ‘free’), rather than imposed as has previously been the case, e.g. at a solid surface.\nIn the most general case of a free surface between 2 viscous fluids, there are 4 boundary conditions required for 4 unknowns (3 velocity components, and 1 variable representing the free surface shape). These are provided by the kinematic and dynamic boundary conditions.\nTo set up our problem, we will consider a free surface given in implicit form as f({\\boldsymbol{x}},t)=0 with f&lt;0 corresponding to fluid 1 and f&gt;0 corresponding to fluid 2, see Figure 4.1. Variables corresponding to fluid 1 will be denoted with a superscript - whilst those in fluid 2 will be given a +. In this case, the free surface’s unit normal (pointing from fluid 1 into fluid 2) is {\\boldsymbol{n}}= \\frac{\\nabla f}{|\\nabla f|}.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Free Surface Flows</span>"
    ]
  },
  {
    "objectID": "1-4-free-surfaces.html#boundary-conditions-at-a-free-surface",
    "href": "1-4-free-surfaces.html#boundary-conditions-at-a-free-surface",
    "title": "4  Free Surface Flows",
    "section": "",
    "text": "Figure 4.1: The general setup for free surface flows, where the free surface dividing the two fluids is defined implicitly to be f({\\boldsymbol{x}},t) = 0.\n\n\n\n\n\n\n\n\n\nExample\n\n\n\nFor two-dimensional flow, one natural representation for the free surface is to set y = h(x,t) where h is the height of the surface, which needs to be obtained as part of the solution. Fluid 1 sits below the graph of h, i.e. in the region y&lt;h(x,t), and Fluid 2 sits above. In this case, we can define f(x,y,t) = y-h(x,t) so that f&lt;0 in fluid 1. At the free surface we have f=0 and unit normal vector \n{\\boldsymbol{n}}= \\frac{1}{\\sqrt{1+(\\partial_x h)^2}}(-\\partial_x h,1)\n which points out of fluid 1.\n\n\n\nKinematic Boundary Condition\nThe free surface must move with the velocity of the fluid just adjacent to it, so that fluid particles which begin on the free surface remain there. In other words, the surface ‘follows the fluid’. This means that we have conservation of f along the fluid paths of the surface particles, i.e. \n\\frac{Df}{Dt} = \\frac{\\partial f}{\\partial t} +({\\boldsymbol{v}}\\cdot \\nabla)f =0.\n As \\nabla f = |\\nabla f|\\,{\\boldsymbol{n}}, we can substitute and rearrange, giving \n\\frac{1}{|\\nabla f|}\\frac{\\partial f}{\\partial t} +{\\boldsymbol{v}}\\cdot {\\boldsymbol{n}}=0.\n For steady problems where \\frac{\\partial f}{\\partial t} =0, we therefore find that {\\boldsymbol{v}}\\cdot {\\boldsymbol{n}}=0. This means the surface is impermeable, i.e. the fluid cannot cross it, just as we would expect.\n\n\n\n\n\n\nExample\n\n\n\nFor f(x,y,t) = y-h(x,t), we have \\nabla f = (-\\partial_x h,1), and we find that the kinematic boundary condition becomes \n-\\partial_t h + \\left(u\\frac{\\partial}{\\partial x} + v\\frac{\\partial}{\\partial y}\\right)\\big(y-h(x,t)\\big) =0.\n Differentiating out and rearranging, this can be written \n\\partial_t h + u \\partial_x h = v.\n\\tag{4.1}\n\n\n\n\nDynamic Boundary Condition\nTo obtain a dynamic boundary condition, we apply Newton’s second law to the surface separating the two fluids. As the surface has no inherent mass, the forces acting on the surface from either side must balance. As we know from our discussion in Chapter 2, the forces acting on the surface are expressible as stresses acting.\nOf particular interest to us will be the influence of surface tension, which is a property of the surface which appears due to the asymmetry of intermolecular forces acting in the interfacial region (typically of nanometric width). As one goes to smaller length scales, surface forces (\\sim L^2) begin to dominate volume forces (\\sim L^3). In particular, the surface tension force typically begins to dominate gravity when the length scale goes below the millimetre scale.\nSurface tension acts like an elastic membrane sitting on the interface, forcing it to attempt to minimise its area. Crudely, this is because it is energetically favourable for molecules to be in the bulk of the liquid, rather than at its surface. Surface tension is responsible for a whole host of effects ranging from the suspension of small objects (e.g. water striders) through to the breakup of liquid jets (e.g. from a tap in a kitchen), which occurs when the liquid can reduce its surface area by forming a series of spheres (drops) rather than one cylinder (the jet). Problems in which surface tension is a significant factor are known as capillary flows.\n\nWe will assume that the surface tension force \\sigma per unit length of line is constant along the surface, and is directed tangentially along the surface. Parametrising the surface by coordinates (x,y) so that the surface is z = h(x,y), the tangent vectors in the coordinate directions are {\\boldsymbol{t}}_i for i=1,2, where \n{\\boldsymbol{t}}_1 = \\frac{1}{\\sqrt{1+\\big(\\frac{\\partial h}{\\partial x}\\big)^2}}\\left(1,0,\\frac{\\partial h}{\\partial x}\\right)\\qquad\\text{and}\\qquad{\\boldsymbol{t}}_2 = \\frac{1}{\\sqrt{1+\\big(\\frac{\\partial h}{\\partial y}\\big)^2}}\\left(0,1,\\frac{\\partial h}{\\partial y}\\right).\n Consider an approximately rectangular section of surface with side length \\delta centred at the point (x_0,y_0,h(x_0,y_0)), as illustrated in Figure 4.2. The net force acting on the top surface is approximately \\delta^2{\\boldsymbol{S}}^+{\\boldsymbol{n}}, and likewise on the bottom surface is \\delta^2{\\boldsymbol{S}}^-(-{\\boldsymbol{n}}). On the edges of the rectangle, surface tension pulls outwards, so that the net forces on the right edge are \n\\sigma \\delta{\\boldsymbol{t}}_1(x_0+\\tfrac12\\delta,y_0),\n with similar expressions for the other edges. Since these forces must balance, summing these contributions up we obtain: \n\\delta^2({\\boldsymbol{S}}^+-{\\boldsymbol{S}}^-){\\boldsymbol{n}}+\\sigma\\delta\\Big({\\boldsymbol{t}}_1(x_0+\\tfrac12\\delta,y_0)\n-{\\boldsymbol{t}}_1(x_0-\\tfrac12\\delta,y_0)+{\\boldsymbol{t}}_2(x_0,y_0+\\tfrac12\\delta)-{\\boldsymbol{t}}_2(x_0,y_0-\\tfrac12\\delta)\\Big)={\\boldsymbol{0}}.\n Taylor expanding the terms in brackets about (x_0,y_0), dividing by \\delta^2 and send \\delta\\to0, we get \n\\left({\\boldsymbol{S}}^{+} - {\\boldsymbol{S}}^{-}\\right){\\boldsymbol{n}}=- \\sigma\\left(\\frac{\\partial {\\boldsymbol{t}}_1}{\\partial x} + \\frac{\\partial {\\boldsymbol{t}}_2}{\\partial y}\\right) \\equiv \\sigma\\kappa {\\boldsymbol{n}}\n on the surface. Here, we have defined the curvature of the interface \\kappa using the geometric identity \n\\kappa{\\boldsymbol{n}}= -\\left(\\frac{\\partial {\\boldsymbol{t}}_1}{\\partial x} + \\frac{\\partial {\\boldsymbol{t}}_2}{\\partial y}\\right),\n where {\\boldsymbol{n}} is the unit normal to the surface.\nWe can now take components in different directions. In directions tangent to the surface, we find that \n{\\boldsymbol{t}}\\cdot\\Big(({\\boldsymbol{S}}^+-{\\boldsymbol{S}}^-){\\boldsymbol{n}}\\Big) = 0\\qquad\\text{so}\\qquad\n{\\boldsymbol{t}}\\cdot({\\boldsymbol{S}}^+{\\boldsymbol{n}}) = {\\boldsymbol{t}}\\cdot({\\boldsymbol{S}}^-{\\boldsymbol{n}}),\n so the tangential stresses on the interface are continuous across it. On the other hand, the normal stress has a jump caused by the surface tension force with magnitude \\sigma\\kappa. This jump remains for an inviscid fluid. In this case we recall that the stress tensor takes the form S_{ij} = p\\delta_{ij}, and so {\\boldsymbol{n}}\\cdot({\\boldsymbol{S}}{\\boldsymbol{n}}) = pn_i\\delta_{ij}n_j = p. Working things through, this leads to the single dynamic boundary condition \np^{-} - p^{+} = \\sigma\\kappa\n on the surface. This is known as the Young-Laplace equation and states that the pressure jump across the interface is caused by the surface tension force. The same equation also applies for the viscous case in a static situation.\n\n\n\n\n\n\nFigure 4.2: Forces acting at the interface. The stress from the two fluids act on the faces of the volume, which have area \\frac{\\delta}{2} and the surface tension, which acts on acts on a line, tugs on the four ends of length \\delta (the height of the control volume is considered negligible). The interface is parameterised by coordinates (x,y) and the control volume’s centre is at (x_0, y_0, h(x_0,y_0)).",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Free Surface Flows</span>"
    ]
  },
  {
    "objectID": "1-4-free-surfaces.html#bubbles",
    "href": "1-4-free-surfaces.html#bubbles",
    "title": "4  Free Surface Flows",
    "section": "4.2 Bubbles",
    "text": "4.2 Bubbles\nConsider a gas bubble in a liquid, see Figure 4.3. If the bubble is spherical with radius R, then in spherical polar coordinates (r,\\theta,\\phi) centred in the middle of the bubble, the normal at the interface is {\\boldsymbol{n}}= (-1,0,0) (we define the liquid as the - phase, so that the normal points into the gas, the + phase). In this case, it can be shown that the curvature of the spherical surface is \\kappa = -\\frac{2}{R}. Using our argument above, the pressure just inside the gas bubble p^{+} is related to that in the liquid just outside p^{-} by the relationship \np^{-} - p^{+} = - \\frac{2\\sigma}{R}\\qquad\\hbox{i.e.}\\qquad p^{+}  = p^{-} + \\frac{2\\sigma}{R}.\n This means the pressure in the gas is increased by 2\\sigma/R. This makes intuitive sense: if the surface tension acts to pull inwards on the bubble like an elastic membrane, the pressure will rise in the bubble as it gets squeezed. Smaller bubbles have a larger pressure inside and this is why smaller bubbles are louder when they burst at a liquid’s surface – you can test this in the real world, as champagne is louder than beer!\n\n\n\n\n\n\nFigure 4.3: Surface tension forces increasing the pressure within a spherical gas bubble of radius R.\n\n\n\n\nThe Bond number\nWe have seen that the pressure generated by surface tension is of the order of \\sigma/L, where L is a characteristic length scale. This length scale is the approximate radius of curvature of our interface. Therefore, capillary forces (due to surface tension) will be important when \\sigma/L is comparable to the pressure generated by gravitational forces, i.e. the hydrostatic pressure \\rho g L. To compare the influence of these effects, we consider the dimensionless Bond number, defined to be \n\\mathrm{Bo}= \\frac{\\rho g L}{\\sigma/L} = \\frac{\\rho g L^2}{\\sigma}.\n When \\mathrm{Bo}=1, these effects are in balance, and we can rearrange to show that this occurs when \nL_{\\sigma} = \\sqrt{\\frac{\\sigma}{\\rho g}}.\n The special length scale L_{\\sigma} is known as the capillary length. For water in air, where the surface tension is \\sigma = 0.07 N/m, we have L_{\\sigma}=3 mm. Therefore, for large scale flows, such as sea waves, surface tension has no meaningful effect, but for small scale flows, such as those encountered in micro and nanofluidics, the importance of surface tension far outweighs that of gravity.\n\n\nThe capillary number\nIn many cases, we are interested in knowing the shape of a liquid drop or bubble whose flow has negligible force in comparison to the surface tension forces. In the latter case, for low Reynolds number flows, where viscous forces dominate inertial ones, looking at the dynamic boundary condition we can see that the viscous force has magnitude \\mu U/L whilst the surface tension force is \\sigma/L. The ratio of these forces gives the capillary number: \n\\mathrm{Ca}= \\frac{\\mu U}{\\sigma}.\n When \\mathrm{Ca}\\ll 1, the flow within the drop has a negligible effect on the free surface, so that the shape can be calculated independently of the flow (this is a huge simplification!).\n\n\nYoung-Laplace Equation\nWhen \\mathrm{Ca}\\ll 1 in the viscous case, we can neglect viscous effects and again obtain the Young-Laplace equation: \np^{-} - p^{+} = \\sigma\\kappa.\n To make some progress we can simplify matters further. Let us consider a steady two-dimensional flow in Cartesian coordinates (x,y) with gravity now pointing in the negative y-direction, as shown in Figure 4.4.\n\n\n\n\n\n\nFigure 4.4: Parametrisation of the free surface.\n\n\n\nFurthermore, let us consider cases in which we can parameterise the free surface in terms of a height function y=h(x), so that f(x,y)=y-h(x). Then some tedious calculations allow us to show that \n{\\boldsymbol{n}}= \\frac{(-h',1)}{\\big(1+(h')^2\\big)^{1/2}}\\qquad\\hbox{and}\\qquad\\kappa= -\\frac{h''}{\\big(1+(h')^2\\big)^{3/2}};\n here, primes denotes derivatives with respect to x.\nIf we consider liquid–gas systems in which the pressure in the liquid is hydrostatic, so p^- = p^-_0-\\rho g y (where p^-_0 is some constant pressure at y=0) and the gas is dynamically passive so that it experiences negligible variations in hydrostatic pressure due to its lower density, hence p^{+}=p^{+}_0 is constant, then we find \n- P - \\rho g y= \\sigma\\kappa\n on the free surface, where P= p^+_0 - p^-_0 is the pressure drop across the interface.\nPutting everything together and substituting y=h(x), the Young-Laplace equation becomes: \n- P - \\rho g h =  -\\frac{\\sigma h''}{\\big(1+(h')^2\\big)^{3/2}} \\qquad\\hbox{at}\\qquad y=h(x,t).\n One can see immediately that this is a nonlinear, second–order PDE for h and hence we must specify a boundary condition for h (or its derivative) at each end of the free surface. On top of this one either needs to specify the pressure drop P or, more often, the volume of the liquid which can then be used to find P.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Free Surface Flows</span>"
    ]
  },
  {
    "objectID": "1-4-free-surfaces.html#contact-lines",
    "href": "1-4-free-surfaces.html#contact-lines",
    "title": "4  Free Surface Flows",
    "section": "4.3 Contact Lines",
    "text": "4.3 Contact Lines\nAs we have seen, free surfaces are located where two phases meet each other (e.g. water-air) but these surfaces often come into contact with a third surface (e.g. a solid wall). The three surfaces join along a ‘three phase’ contact line. Common examples of contact lines are liquid–liquid–gas, e.g. an oil drop resting on a water-air interface, and liquid–solid–gas, e.g. a raindrop on a windscreen. Our focus will be on the latter case.\nWe will be modelling only the liquid and will assume that the solid is rigid, so that is does not deform. A current ‘hot topic’ is contact lines that are formed at soft solids, but this is beyond our scope — see here for a recent review article. As our free surface equations are themselves differential equations, with a \\kappa term that becomes \\propto h'' in the parameterisation above, typically we need a boundary condition at either end of the free surface where it meets the solid (Figure 4.4). The two most common choices are:\n\nA pinned contact line, where the position of the contact line is prescribed at a fixed coordinate. For example, one may insist that a contact line is at x=R, in which case if the solid is at y=0 in our 2D Cartesian example then the boundary condition would simply be h(R)=0 which ensures the free surface meets the solid at x=R.\nA prescribed contact angle - in this case the position of the contact line is found as part of the solution, and instead we impose the angle \\theta at which the free surface meets the solid, so in our 2D Cartesian example we would have \\frac{\\partial h}{\\partial x}=\\pm \\tan\\theta at x=\\mp R (note R is now an unknown) with the \\pm depending on which side of the drop we are considering.\n\nPhysically, both of these cases are possible and reasonable, and a typical drop spreading event may include both behaviours. If we were to consider a perfectly smooth homogeneous solid surface, we would expect a drop landing on it to spread with its prescribed contact angle (a significant oversimplification!) until it reaches an equilibrium state. The prescribed contact angle will depend on the liquid-solid-gas combination in question: if the solid is ‘wettable’ (i.e. hydrophilic for water) this angle will be close to zero, so the drop will spread out a lot; this is the case for water on glass. If the angle is high (close to 180^\\circ) then the solid is non-wettable (aka hydrophobic) and the drop beads up (e.g. water on a lotus leaf).\n\nThe problem is that most ‘real’ solids are not chemically heterogeneous or smooth and the result is that the contact line becomes pinned on these features before it can reach its equilibrium state. This is the reason we usually don’t see spherical cap shapes (the false equilibrium state) when we look at raindrops on typical solids. In what follows, we will consider these cases separately, but one should keep in mind that in reality both behaviours often occur in the same event.\n\nExample: shape of a liquid drop on a solid\nConsider a liquid drop sat on a solid surface. There are a number of different configurations we could think of, but the simplest is to consider a ‘2D drop’ with contact lines ‘pinned’ at x=\\pm R so that h(x=\\pm R)=0, see Figure 4.5 (one of the Project tasks is to extend this to a cylindrical coordinate system geometry, which is the more practically relevant case). To further simplify matters, we can prescribe P and find the shape (and hence the volume).\n\n\n\n\n\n\nFigure 4.5: A two-dimensional drop with contact lines at x=\\pm R and contact angle \\theta.\n\n\n\nIn this case, our problem formulation is the Young-Laplace equation \n- P \\mp \\rho g h =  -\\frac{\\sigma \\frac{d^2 h}{dx^2}}{(1+\\left(\\frac{dh}{dx}\\right)^2)^{3/2}}\n combined with boundary conditions h(x=\\pm R)=0. Our aim is to find the function h. Note that we include \\mp g as -g corresponds to a drop on top of a surface perpendicular to the gravitaitonal field and +g corresponds to a drop hanging beneath a surface.\nTherefore, to find the drop shape in this case, one solves the Young-Laplace equation, with P prescribed alongside boundary conditions h(x=\\pm R)=0. This is the starting point for Project 2.\nIf we want a physical example, we may consider \\rho=1000kg m^{-3}, g=9.8 m s^{-2} and \\sigma=0.07N m^{-1} which are values for water. Then a typical drop size (e.g. a raindrop) may be in the range R=1-20mm=1-20\\times10^{-3}m. Recalling that \\mathrm{Bo}=\\frac{\\rho g R^2}{\\sigma} (where we have used R as a characteristic length scale) will enable us to establish what is dominant out of gravity and capillarity. For \\mathrm{Bo}\\gg1 we will see pancake shapes, whereas for \\mathrm{Bo}\\ll1 we will see spherical caps. For the range considered above, we will encounter both large and small \\mathrm{Bo} which is why we can observe both pancakes and spherical caps when it rains.\n\nA useful starting point is to see if we can find any analytic solutions in special cases. Two immediately come to mind and both involve neglecting the gravitational field, which we know is valid when \\mathrm{Bo}\\ll 1. These solutions will provide both tests for our computational codes (which will solve the full problem) as well as initial guesses for iterative solution methods.\n\nSolution for small heights with g=0\nThe simplest case to consider is when the free surface remains relatively close to the solid so that h'\\ll 1. In this case we can linearise our equations (basically ignoring all products of small terms like h, h', h'') to obtain \nP=  \\sigma \\frac{d^2 h}{dx^2}\n with solution a parabola \nh_{lin}=-\\frac{P}{2\\sigma}\\left(R^2-x^2\\right).\n Notably, we see, as expected, that for meaningful solutions we need P&lt;0 as P represents the pressure in the gas minus the pressure in the liquid, which we expect to be higher for a drop, due to surface tension.\n\n\nGeneral Solution for g=0\nConsider now the solution to the nonlinear ODE: \nP= \\frac{\\sigma \\frac{d^2 h}{dx^2}}{(1+\\left(\\frac{dh}{dx}\\right)^2)^{3/2}}.\n which is given by a circle (no surprise, as this minimises the length of the free surface for a given volume): \nx^2 + \\left(h+\\sqrt{\\sigma^2/P^2-R^2}\\right)^2 = \\frac{\\sigma^2}{P^2}.\n\n\n\nGeneral Solution for g\\neq0\nThese must be obtained computationally, and are the subject of the Week 4 Workshop. Notably, the solutions for g=0 will provide a benchmark for our code.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Free Surface Flows</span>"
    ]
  },
  {
    "objectID": "1-4-free-surfaces.html#sec-flu-proj2",
    "href": "1-4-free-surfaces.html#sec-flu-proj2",
    "title": "4  Free Surface Flows",
    "section": "4.4 Fluids Coursework Projection Option 2",
    "text": "4.4 Fluids Coursework Projection Option 2\nThis project is entitled Shapes of Liquid Drops, and is the second of the two project options you will have in this section of the module. The other was described in Section 3.3.\n\nProject aims\nYou should write an approximately 10 page report that demonstrates:\n\nEngagement with the literature on capillarity;\nComputational results for the shapes of drops in different contexts; and\nValidation of code against your own analytic results as well as experimental and/or theoretical results from the published literature.\n\n\n\n\nThe Young-Laplace equation in cylindrical polar coordinates\nA more realistic drop is obtained if we consider an axisymmetric (nothing depends on \\theta) drop in a cylindrical polar coordinate system (r,\\theta,z), so that the equivalent height function is given by z=h(r), where h is the height of the free surface and r is the radial coordinate. In this case we need to know the curvature of our free surface, which is given by (feel free to work this out / check): \n\\kappa = -\\frac{\\frac{d^2 h}{dr^2}}{\\left(1+ \\left(\\frac{dh}{dr}\\right)^2\\right)^{3/2}} - \\frac{\\frac{dh}{dr}}{r\\left(1+ \\left(\\frac{dh}{dr}\\right)^2\\right)^{1/2}}\n\n\n\nProject Ideas\nThe suggestions below are intended to give you ideas of what can be done, but you should feel free to follow your own path if you wish.\nA starting point for this project is to compute the static shape of a 2D drop in a gravitational field whose contact line is pinned, as considered within the Week 4 Workshop, where we recall the suggested tasks below.\n\nSolve the linearised Young-Laplace equation and ensure you get the analytic solution in this case.\nExtend the code to solve the nonlinear problem via iteration and compare for g=0 to (i) the linearised solution for small heights and (ii) the nonlinear solution in all cases.\nVary P to obtain different drop shapes (for different material parameters, if you like).\nConsider if there is a solution for all values of P. If not, what can go wrong and why?\nDetermine the dimensionless parameter appears from the Young-Laplace equation. How do drop shapes vary as you change this parameter?\n\nAlso, recall some of the more challenging suggestions for extending the 2D code:\n\nCan you extend the code to consider prescribing the drop’s volume V (or more precisely its area in 2D) and then finding P as part of the solution? Hint: you will have to introduce an extra unknown into the problem, namely P, and an additional equation, which is that the drop volume is V and will involve an integral over all nodes.\nConsider the case of a gas bubble on a solid surface surrounded by an exterior liquid. How do the drop shapes change?\nThink about implementing the Newton method, which has superior convergence qualities over Picard iteration (error decreases quadratically, rather than linearly). You may have seen this method for the solution of a single equation for a single variable, i.e. E_1(h_1)=0, where we update the values of h_1 using \nh_1^{k+1} = h_1^{k} - \\left(\\frac{dE_1(h_1^{k})}{dh_1}\\right)^{-1}E_1(h_1^{k})\n and see that the left hand side is the new solution, where the right hand side is evaluated purely at already-existing values. To extend this to a system of equations where we want E_i(h_1,h_2,...,h_n)=0 at every node, we must use \nh_i^{k+1} = h_i^{k} - J_{ij}^{-1} E_j(h_i^{k})  \\qquad J_{ij} = \\frac{dE_i(h_i^{k})}{dh_j}\n and J_{ij}^{-1} is the inverse of J_{ij}. In other words, to find the amount we need to update our solution by \\triangle h_i = h_i^{k+1}-h_i^{k} we must solve the linear equations \nJ_{ij}\\triangle h_i = - E_j (h_i^{k})\n\n\nPotential extensions are now described — feel free to follow whatever interests you.\n\nMoving contact lines\n\nConsider a free (unpinned) contact line, so that R is now an unknown of the problem and a condition is applied on the angle \\theta at which the free surface meets the solid (see Figure 4.5) which can be varied (h'(x=\\pm R)=\\mp \\tan\\theta). This ‘contact angle’ can vary from \\theta=0, where the drop will completely wet the solid with a thin liquid film, through to \\theta \\approx 180^\\circ where there is almost no contact between the drop and solid (these are ‘superhydrophobic surfaces’). Again, you can consider both prescribing P and finding V or vice versa.\n\n\n\nAxisymmetric (real) drops\n\nConsider 3D axisymmetric drops so that comparisons can be made to experimental data for drops (or bubbles). In this case, the domain will be from 0\\le r\\le R, where R is the radial position of the contact line, and at the axis of symmetry (r=0) one has a condition that the free surface is smooth \\frac{dh}{dr}=0. Numerically, a crude way to impose this is to enforce that the height of the free surface at the first node h_1 is equal to that at the second node h_1=h_2.\nAttempt to derive an analytic solution in this case for g=0. Noting that the profile is a spherical cap may help.\nTry to compare your drop shapes to those found in the experimental literature (you may find you need to use a fixed contact angle rather than a fixed drop size). You could look into Bonn et al 2009 for ideas/images (see Reading List) or find your own pictures of static drops.\n\n\n\nFat drops\n\nParametrise the free surface so that shapes are not restricted to single valued functions of h=h(x) - i.e. one can consider ‘fat drops’. To do so, one option is to switch to the parameterisation x=f(y), where the f is now the unknown function (perhaps everywhere, or maybe only in regions where this parameterisation suits better). To utilise this approach one need to know the curvature in this representation, which will be easy to obtain in Cartesian coordinates and in cylindrical polar coordinates where r=f(z) will be given by \n\\kappa = \\frac{-\\frac{d^2 f}{d z^2}}{\\left(1+(\\frac{df}{dz})^2\\right)^{3/2}} + \\frac{1}{f\\left(1+(\\frac{df}{dz})^2\\right)^{1/2}}.\n One needs to be careful near r=0 with this setup.\nAn alternative popular approach is to use the arclength coordinate s to find the free surface coordinates as (r(s),z(s)). A common way to achieve this was first described by Adams and Bashforth (see Reading List) and can be found more recently in Thoroddsen et al 2005 and Extrand & Moon 2010 as well as no doubt countless other papers. Note that to use this approach one will need to discretise s rather than x and that the ‘shooting method’ described in papers is similar to treating s as time and using an explicit stepping method. Note also that here you will have more than one equation at each nodes, but the principles we have developed can still be applied to this new setting (i.e. 3 equations at each node means we will have a 3n\\times 3n system of equations).\nExtract data from Figure~3 in Thoroddsen et al 2005 (e.g. using DataThief) and compare to your results. Or try similar approaches with results in Berry et al 2015 (see Reading List), where the Young-Laplace equation is used to determine the surface tension of hanging liquid drops. Similarly you may look into Extrand & Moon 2010 (again in the Reading List).\nOr compare to gas bubble shapes obtained in Simmons et al 2015 in the Reading List below.\n\n\n\nGoing further\nFor those feeling very ambitious:\n\nConsider the influence of additional physical effects on drop shapes, for example electric fields (look into the published literature for examples).\nExtend your code to consider quasi-static flows, where the free surface is still computed by the Young-Laplace equation but either (i) for a pinned contact line the volume of the drop changes in time, as in Simmons et al 2015 below, or (ii) there is a relation between the contact angle and the speed of the contact line U_c=dR/dt such as dR/dt = (\\theta^3(t) - \\theta_e^3). Consider the approach of a drop from some initial shape with angle \\theta_0=\\theta(t=0) towards its equilibrium shape with angle \\theta_e (at which point dR/dt=0).\nDownload and have a play with Surface Evolver, which is a code known to accurately compute equilibrium free surface shapes (note: I have never used it, so you are on your own!). Consider using previous solutions from your own codes as a benchmark and then consider more interesting cases - for example, fully-3D non-axisymmetric cases (e.g. a drop on an inclined plane with a pinned contact line, as you’d see on a car window when it rains).\n\n\n\nReading List\nArticles below are just a starting point for your investigations and should not be considered exhaustive:\n\nPomeau, Y. and Villermaux, E., 2006. Two hundred years of capillarity research. Physics Today, 59(3), p.39.\nHistory of flows with surface tension considering a range of phenomena. Read for an overview of the topic.\nBashforth, B., 1883. An attempt to test the theories of capillary action by comparing the theoretical and measured forms of drops of fluid. (with supplement by Adamsg, J.C.).\nEarly attempt to compute the shapes of static drops on or underneath solid surfaces. Quadrature is used to solve the differential equation and this was incredibly laborious in the pre-computer age! The article can be found here.\nThoroddsen, S.T., Takehara, K. and Etoh, T.G., 2005. The coalescence speed of a pendent and a sessile drop. Journal of Fluid Mechanics, 527, pp.85-114.\nA paper on the coalescence of liquid drops. Most relevantly, Section 3.1 contains a method for calculating the static shapes of drops using the Young-Laplace equation and Figure~3 shows computed shapes compared to experimental data.\nBonn, D., Eggers, J., Indekeu, J., Meunier, J. and Rolley, E., 2009. Wetting and spreading. Reviews of modern physics, 81(2), p.739.\nBerry, J.D., Neeson, M.J., Dagastine, R.R., Chan, D.Y. and Tabor, R.F., 2015. Measurement of surface and interfacial tension using pendant drop tensiometry. Journal of colloid and interface science, 454, pp.226-237.\nMethod for calculating the surface tension by analysing the shape of a drop and comparing it to the Young-Laplace equation’s solutions.\nSimmons, J.A., Sprittles, J.E. and Shikhmurzaev, Y.D., 2015. The formation of a bubble from a submerged orifice. European Journal of Mechanics-B/Fluids, 53, pp.24-36.\nGrowth of a gas bubble from a submerged orifice. Here, Section 5.2.1 considers how well the Young-Laplace equation can be used to describe the dynamics (see equation 15 and figure~7), when they are in a quasi-static regime.\nExtrand, C.W. and Moon, S.I., 2010. Contact Angles of Liquid Drops on Super Hydrophobic Surfaces: Understanding the Role of Flattening of Drops by Gravity. Langmuir, 26, pp.17090-17099.\nArticle considering how well static drops on superhydrophobic surfaces (those with \\theta \\to 180^\\circ) can be described by the Young-Laplace equation. Includes further explanation of method of Adams and Bashforth.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Free Surface Flows</span>"
    ]
  },
  {
    "objectID": "1-5-thin-films.html",
    "href": "1-5-thin-films.html",
    "title": "5  Lubrication and Thin Film Dynamics",
    "section": "",
    "text": "5.1 The Lubrication Equation\nIn this chapter we consider situations in which the flow domain is long and thin, leading to so–called ‘lubrication flows’. These are routinely observed in industry (e.g. via coatings applied to almost all products we own, such as mobile phones), nature (e.g. avalanches or ice sheet dynamics), agriculture (e.g. in crop spraying), DIY (when we apply paints to a wall) and biology (e.g. tear film on the eye or coatings within the body). Such flows can produce remarkably complex behaviour.\nFrom a mathematical modelling perspective, the geometry of the flow will allow us to make significant simplifications to the full system of Navier-Stokes equations, firstly for the case of a fluid trapped between two solid surfaces, and secondly for the case of a liquid film on a solid surface, where the free surface boundary conditions add even further complexity. This chapter will bring together many of the aspects from the earlier ones and also introduce further techniques of applied mathematics, namely non-dimensionalisation (done in full detail now!) and a brief look at asymptotic techniques.\nWe begin by considering the two-dimensional incompressible Navier-Stokes equations in Cartesian coordinates, with gravitational acceleration pointing in the negative y-direction: \n\\begin{aligned}\n\\frac{\\partial u}{\\partial x}+\\frac{\\partial v}{\\partial y} &= 0, \\\\\n\\rho\\left(\\frac{\\partial u}{\\partial t} + u\\frac{\\partial u}{\\partial x} + v\\frac{\\partial u}{\\partial y} \\right)&= -\\frac{\\partial p}{\\partial x} + \\mu\\left(\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}\\right), \\\\\n\\rho\\left(\\frac{\\partial v}{\\partial t} + u\\frac{\\partial v}{\\partial x} + v\\frac{\\partial v}{\\partial y}\\right) &= -\\frac{\\partial p}{\\partial y} + \\mu\\left(\\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2}\\right) - \\rho g.\n\\end{aligned}",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lubrication and Thin Film Dynamics</span>"
    ]
  },
  {
    "objectID": "1-5-thin-films.html#the-lubrication-equation",
    "href": "1-5-thin-films.html#the-lubrication-equation",
    "title": "5  Lubrication and Thin Film Dynamics",
    "section": "",
    "text": "Non-Dimensionalisation\nNow, we consider characteristic scales for all the quantities involved in the equations above: velocity components U, pressure P, length L and time T=L/U. It is possible that the characteristic time scale may be set by something else, e.g. the frequency of an oscillating body, but here we will consider the simplest case where it is related to the length and velocity scales. Furthermore, let us consider different scales for lengths and velocities in the x-direction and y-direction which will be important for allowing us to simplify our equations based on the geometry of the flow domain. Because we are looking at thin films, we expect the domain to be long and thin, so we let the characteristic length in the x-direction be L_x=L and the characteristic one in the y-direction be L_y=\\varepsilon L, where \\varepsilon is a (dimensionless) number which gives the aspect ratio L_x/L_y of our geometry. We will later exploit the fact that \\varepsilon\\ll 1 to simplify our problem. Similarly, we expect a scale separation in the velocities, and the corresponding choices are U_x=U and U_y=\\varepsilon U. See Figure 5.1 for an example.\n\n\n\n\n\n\nFigure 5.1: Characteristic geometry for a lubrication flow.\n\n\n\nWe use these scales to represent all variables in terms of their characteristic size multiplied by a dimensionless variable. By definition, the dimensionless variables must have characteristic ‘size’ \\sim 1. In doing so, we are able to establish the size of different terms and thus work out which are negligible. We consider \nx=L\\tilde{x},\\qquad y=\\varepsilon L\\tilde{y},\\qquad  u=U\\tilde{u},\\qquad v=\\varepsilon U\\tilde{v},\\qquad p=P\\tilde{p}\n and substituting these into the Navier-Stokes equations gives \n\\begin{aligned}\n\\frac{U}{L}\\frac{\\partial \\tilde{u}}{\\partial \\tilde{x}}+\\frac{U}{L}\\frac{\\partial \\tilde{v}}{\\partial \\tilde{y}} &= 0, \\\\\n\\frac{\\rho U^2}{L}\\left(\\frac{\\partial\\tilde{u}}{\\partial \\tilde{t}} + \\tilde{u}\\frac{\\partial \\tilde{u}}{\\partial \\tilde{x}} + \\tilde{v}\\frac{\\partial \\tilde{u}}{\\partial \\tilde{y}}\\right) &= -\\frac{P}{L}\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}} + \\frac{\\mu U}{L^2}\\left(\\frac{\\partial^2 \\tilde{u}}{\\partial \\tilde{x}^2} + \\frac{1}{\\varepsilon^2} \\frac{\\partial^2 \\tilde{u}}{\\partial \\tilde{y}^2}\\right), \\\\\n\\frac{\\varepsilon \\rho U^2}{L}\\left(\\frac{\\partial \\tilde{v}}{\\partial \\tilde{t}} + \\tilde{u}\\frac{\\partial \\tilde{v}}{\\partial \\tilde{x}} + \\tilde{v}\\frac{\\partial \\tilde{v}}{\\partial \\tilde{y}}\\right) &= -\\frac{P}{\\varepsilon L}\\frac{\\partial \\tilde{p}}{\\partial \\tilde{y}} + \\frac{\\varepsilon \\mu U}{L^2}\\left(\\frac{\\partial^2 \\tilde{v}}{\\partial \\tilde{x}^2} + \\frac{1}{\\varepsilon}\\frac{\\partial^2 \\tilde{v}}{\\partial \\tilde{y}^2}\\right) - \\rho g.\n\\end{aligned}\n from which we can see that a good scale for the pressure would be \\frac{P}{L} =  \\frac{\\mu U}{\\varepsilon^2 L^2} which would ensure that pressure term \\frac{P}{L}\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}} is comparable with the (dominant as \\varepsilon \\to 0) viscous term \\frac{\\mu U}{L^2 \\varepsilon^2}\\frac{\\partial^2 \\tilde{u}}{\\partial \\tilde{y}^2} which we have already seen drives Poiseuille flow. Making this choice and rearranging gives \n\\begin{aligned}\n\\frac{\\partial \\tilde{u}}{\\partial \\tilde{x}}+\\frac{\\partial \\tilde{v}}{\\partial \\tilde{y}} &= 0, \\\\\n\\varepsilon^2 \\mathrm{Re}\\left(\\frac{\\partial\\tilde{u}}{\\partial \\tilde{t}} + \\tilde{u}\\frac{\\partial \\tilde{u}}{\\partial \\tilde{x}} + \\tilde{v}\\frac{\\partial \\tilde{u}}{\\partial \\tilde{y}}\\right) &= -\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}} + \\varepsilon^2\\frac{\\partial^2 \\tilde{u}}{\\partial \\tilde{x}^2} +\\frac{\\partial^2 \\tilde{u}}{\\partial \\tilde{y}^2}, \\\\\n\\varepsilon^4 \\mathrm{Re}\\left(\\frac{\\partial \\tilde{v}}{\\partial \\tilde{t}} + \\tilde{u}\\frac{\\partial \\tilde{v}}{\\partial \\tilde{x}} + \\tilde{v}\\frac{\\partial \\tilde{v}}{\\partial \\tilde{y}}\\right) &= -\\frac{\\partial \\tilde{p}}{\\partial \\tilde{y}} + \\varepsilon^4\\frac{\\partial^2 \\tilde{v}}{\\partial \\tilde{x}^2} + \\varepsilon^2\\frac{\\partial^2 \\tilde{v}}{\\partial \\tilde{y}^2} - \\varepsilon^3 \\mathrm{St},\n\\end{aligned}\n where we have recognised the Reynolds number \\mathrm{Re}=\\frac{\\rho U L}{\\mu} and we introduce a new dimensionless number, the Stokes number \\mathrm{St}=\\frac{\\rho gL^2}{\\mu U}. The latter number describes the ratio between gravitational and viscous forces.\n\n\nLubrication Approximation\nSetting \\varepsilon=1 at this stage would give us the dimensionless Navier-Stokes equations for the case in which the characteristic dimensions are roughly the same in all directions. We could then decide whether or not the inertial terms are negligible or not by calculating \\mathrm{Re}, as we did before. However, this time we want to use the fact that \\varepsilon \\ll 1 to simplify our equations. Assume further that \\varepsilon^2 \\mathrm{Re}\\ll 1 and \\varepsilon^3 \\mathrm{St}\\ll1. This does not meean that \\mathrm{Re} or \\mathrm{St} are small themselves, just that they are not too big when compared to the aspect ratio of the domain. We then simply ignore all terms multiplied by \\varepsilon (and higher powers, which are even smaller) to obtain: \n\\frac{\\partial \\tilde{u}}{\\partial \\tilde{x}}+\\frac{\\partial \\tilde{v}}{\\partial \\tilde{y}}= 0,\n\\tag{5.1} \n0 = -\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}} +\\frac{\\partial^2 \\tilde{u}}{\\partial \\tilde{y}^2},\n\\tag{5.2} \n0 = -\\frac{\\partial \\tilde{p}}{\\partial \\tilde{y}},\n\\tag{5.3} which is a huge simplification on the full system above. Strictly speaking, we could use regular asymptotics and take the leading order terms, but for this situation the result would be the same. Asymptotic expansions work by writing the dependent variables as a power series (usually) in the small variable, e.g. \\tilde{u}=\\tilde{u}_0 + \\varepsilon\\tilde{u}_1+\\varepsilon^2\\tilde{u}_2+..., which allows one to keep track of the size of each term in the equations. However, this is only necessary here if we take a second term in the expansion, e.g. consider the equations for \\tilde{u}_1, which we will not be doing. Notice that all the inertial terms are gone (the time derivatives and convective terms on the left-hand side of second and third equations), as is the gravitational force. What remains is the equation of incompressibility, the pressure gradients and a viscous terms associated with gradients of u with respect to y, as we also saw for plane-parallel shear flows (i.e. Couette and Poiseuille flow). The assumption \\varepsilon \\ll 1 is known as the lubrication approximation, for reasons that will become apparent.\n\n\nReynolds’ Lubrication Equation\nConsider now a particular situation, in which a fluid is trapped between rigid solid boundaries: one at \\tilde{y}=0, which moves parallel to itself with speed \\tilde{u}=\\tilde{U}_b, and the other one at \\tilde{y}=\\tilde{h}(\\tilde{x},\\tilde{t}) (i.e. the solid top is not necessarily flat and can move in time). Clearly it is natural to scale h with L_y so that h = \\varepsilon L \\tilde{h}. This is the typical setup for lubrication problems - e.g. for a slider bearing where solid parts ‘slip’ past each other due to a thin lubricating layer of liquid (see example below). In this case, our boundary conditions become no-slip \n\\begin{aligned}\n\\tilde{u}&=\\tilde{U}_b,&\\tilde{v}&=0 &\\qquad&\\text{at} &\\tilde{y}&=0 \\\\\n\\tilde{u}&=0,& \\tilde{v}&=\\frac{\\partial \\tilde{h}}{\\partial \\tilde{t}} &\\qquad&\\text{at} &\\tilde{y}&=\\tilde{h}(\\tilde{x},\\tilde{t})\n\\end{aligned}\n where, for simplicity, we have assumed that the solid at \\tilde{y}=\\tilde{h} only moves vertically.\nWe start by integrating the incompressibility equation Equation 5.1 ‘across the channel’, i.e. in the y-direction, to give \n0 = \\int^{\\tilde{h}(\\tilde{x},\\tilde{t})}_{0}  \\left(\\frac{\\partial \\tilde{u}}{\\partial \\tilde{x}}+\\frac{\\partial \\tilde{v}}{\\partial \\tilde{y}}\\right) d\\tilde{y} = \\frac{\\partial}{\\partial \\tilde{x}}\\left(\\int^{\\tilde{h}(\\tilde{x},\\tilde{t})}_0 \\tilde{u} d\\tilde{y}\\right) - \\left.\\tilde{u}\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}\\right|_{\\tilde{y}=\\tilde{h}(\\tilde{x},\\tilde{t})} + \\left[\\tilde{v}\\right]^{\\tilde{y}=\\tilde{h}(\\tilde{x},\\tilde{t})}_{\\tilde{y}=0}\n where to bring the derivative out of the integral we have used Leibniz’s rule (see the corresponding Wikipedia article), where care must be taken when the limits of integration are themselves functions. Applying our boundary conditions for \\tilde{u} and \\tilde{v} we obtain \n\\frac{\\partial \\tilde{h}}{\\partial \\tilde{t}} + \\frac{\\partial (\\tilde{h}\\bar{\\tilde{u}}) }{\\partial \\tilde{x}}=0\n\\tag{5.4} where we have introduced the mean velocity across the channel (i.e. ‘depth-wise averaged velocity’) \n\\bar{\\tilde{u}} = \\frac{1}{\\tilde{h}} \\int^{\\tilde{h}(\\tilde{x},\\tilde{t})}_0 \\tilde{u} d\\tilde{y}.\n\\tag{5.5}\nNext, to obtain an expression for \\bar{\\tilde{u}} we must integrate the momentum equations. From the y-momentum equation Equation 5.3 we find that \\tilde{p} = \\tilde{p}(\\tilde{x},\\tilde{t}), i.e. the pressure does not change across the channel at a given \\tilde{x}, so we can integrate the x-momentum equation Equation 5.2 across the channel in \\tilde{y} to obtain \n\\tilde{u}(\\tilde{x},\\tilde{t}) = \\frac{\\tilde{y}^2}{2}\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}}  + A(\\tilde{x},\\tilde{t}) \\tilde{y} + B(\\tilde{x},\\tilde{t})\n where A and B are arbitrary functions appearing after partial integration in \\tilde{y}. Applying the no-slip boundary conditions gives \n\\tilde{u}(\\tilde{x},\\tilde{t}) = -\\frac{1}{2}\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}} \\tilde{y}(\\tilde{h}-\\tilde{y}) + \\tilde{U}_b\\left(1-\\frac{\\tilde{y}}{\\tilde{h}}\\right)\n from which we can clearly identify a Poiseuille component driven by the pressure gradient (first term on the right-hand side) and a Couette flow component (second term) driven by the motion of the bottom boundary. Integrating this expression in y across the channel gives \n\\bar{\\tilde{u}} = -\\frac{\\tilde{h}^2}{12}\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}} + \\frac{\\tilde{U}_b}{2}.\n Substituting the resulting expressions back into Equation 5.4 gives Reynolds’ equation \n\\frac{\\partial \\tilde{h}}{\\partial \\tilde{t}} +\\frac{\\tilde{U}_b}{2} \\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}= \\frac{\\partial}{\\partial \\tilde{x}}\\left( \\frac{\\tilde{h}^3}{12}\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}}\\right),\n\\tag{5.6} which in dimensional variables would give us \n\\mu\\frac{\\partial h}{\\partial t} +\\frac{\\mu U_b}{2} \\frac{\\partial h}{\\partial x}= \\frac{\\partial}{\\partial x}\\left( \\frac{h^3}{12}\\frac{\\partial p}{\\partial x}\\right).\n Note that this is an equation for the unknown pressure p=p(x,t), as the film thickness h is assumed to be prescribed in this case.\n\n\nExample: Slider Bearing\nA classical case for demonstrating the power of lubrication is to consider the slider bearing Figure 5.2 which works by forcing liquid (of viscosity \\mu) into a converging channel in order to support loads and reduce wear associated with solid-on-solid contacts.\nConsider a solid boundary at y=h(x) and sit in a frame of reference in which the top boundary is stationary and the bottom boundary moves with speed U_b. To make things a little more specific, we consider the region 0\\le x\\le L_x the top boundary at h(x) = L_y - \\varepsilon^2 m x, where we have chosen the gradient of the slope to scale with \\varepsilon^2 to represent a small change in height across the domain which also ensures the top boundary never touches the bottom one. Outside the lubrication region we assume the pressure takes its atmospheric value p_{\\text{atm}} and to simplify matters we shift the pressure p\\to p+p_{\\text{atm}}, taking it relative to the value p_{\\text{atm}} so that p(0)=p(L_x)=0.\n\n\n\n\n\n\nFigure 5.2: Geometry for a slider bearing.\n\n\n\nSensible characteristic scales for our problem are then U_b (so that \\tilde{U}_b=1), L_x and L_y so our dimensionless problem, which is steady, is \n\\frac{1}{2} \\frac{d \\tilde{h}}{d\\tilde{x}}= \\frac{d}{d\\tilde{x}}\\left( \\frac{\\tilde{h}^3}{12}\\frac{d\\tilde{p}}{d\\tilde{x}}\\right)\n subject to \\tilde{p}(0)=\\tilde{p}(1)=0 and with \\tilde{h}(\\tilde{x}) = 1- \\varepsilon m \\tilde{x}. Full derivatives our now used as \\tilde{p} is a function of \\tilde{x} only. Integrating, we obtain \n\\frac{d \\tilde{p}}{d\\tilde{x}}=\\frac{6(\\tilde{h}-\\tilde{h}_0)}{\\tilde{h}^3}\\qquad\\hbox{where } \\tilde{h}_0 \\hbox{ is a constant},\n and integrating again we find \n\\tilde{p}(\\tilde{x})=\\int_0^{\\tilde{x}} \\frac{6(\\tilde{h}(\\tilde{s})-\\tilde{h}_0)}{\\tilde{h}(s)^3} d\\tilde{s}\n where \\tilde{s} is a dummy integration variable. The result (check this yourself) for our particular geometry is \n\\tilde{p}(\\tilde{x}) = 6\\left[\\left(\\frac{1}{\\varepsilon m(1-\\varepsilon m\\tilde{x})}-\\frac{h_0}{2\\varepsilon m(1-\\varepsilon m\\tilde{x})^2}\\right)-\\left(\\frac{1}{\\varepsilon m} - \\frac{h_0}{2\\varepsilon m}\\right)\\right]\n and we can fix the constant of integration by applying \\tilde{p}(1)=0 to find h_0 = \\frac{2(\\varepsilon m-1)}{\\varepsilon m-2}, so that finally \n\\tilde{p}(\\tilde{x}) = \\frac{6\\varepsilon m \\tilde{x}(\\tilde{x}-1)}{(\\varepsilon m-2)(1-\\varepsilon m \\tilde{x})^2}.\n Recalling that pressure was scaled with p = \\tilde{p}\\frac{\\mu U_b}{\\varepsilon^2 L_x} we find that \np(x)= \\frac{6\\mu U_b}{\\varepsilon L_x} \\,\\frac{m  (x/L_x)(x/L_x-1)}{(\\varepsilon m-2)(1-\\varepsilon m x/L_x)^2}.\n Notably, we find p\\sim 1/\\varepsilon (the \\sim indicates the ‘order of’ a term, i.e. the most important term, as a limit is taken) as \\varepsilon \\to 0, which shows that the pressure diverges (i.e. goes to infinity) as the channel becomes thinner \\varepsilon\\to0.\nTo see how the lubricant can support a load, we must calculate the upward force (per unit length, as we are in 2D) on the body. In the lubrication formulation, the leading order terms for the stress (see below) are the pressure normal to the solid and the viscous shear stress (the \\mu\\left(\\frac{\\partial u}{\\partial y}+\\frac{\\partial v}{\\partial x}\\right) term) tangential to it. Notably, one can show that the tangential force scales as F_x\\sim 1 (try to do this, if you like). This is why lubrication films support massive normal forces, as F_y\\sim 1/\\varepsilon whilst allowing tangential slippage as F_x \\sim 1 \\ll F_y when the channel is sufficiently thin (\\varepsilon \\ll1).",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lubrication and Thin Film Dynamics</span>"
    ]
  },
  {
    "objectID": "1-5-thin-films.html#thin-film-equations",
    "href": "1-5-thin-films.html#thin-film-equations",
    "title": "5  Lubrication and Thin Film Dynamics",
    "section": "5.2 Thin Film Equations",
    "text": "5.2 Thin Film Equations\nLet us now consider a different application of the lubrication approximation, where we would like to consider the dynamics of thin liquid films with free surfaces. In other words, we are now primarily interested in liquid films, whose free surface is at y=h(x,t), supported on solid surfaces. So the problem changes in character, rather than knowing the height of the upper boundary and finding the pressure (and hence the force) acting on it using the Reynolds equation Equation 5.6, we now have an equation for the pressure at the boundary (involving surface tension) and would like to find the height as part of the solution. In order to proceed, we must first consider what happens to our boundary conditions under the lubrication approximation.\n\n\n\n\n\n\nFigure 5.3: Setup for a thin film flow, where the surface at y=h(x,t) is now free.\n\n\n\n\nFree Surface Boundary Conditions Under Lubrication Approximation\nAt the free surface y=h(x,t) we first note that under the lubrication approximation \n\\begin{aligned}\n{\\boldsymbol{n}}\n&= \\frac{(-\\frac{\\partial h}{\\partial x},1)}{\\left(1+\\left(\\frac{\\partial h}{\\partial x}\\right)^2\\right)^{1/2}} =  \\frac{(-\\varepsilon\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}},1)}{\\left(1+\\varepsilon^2\\left(\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}\\right)^2\\right)^{1/2}}\n\\approx \\left(-\\varepsilon\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}},1\\right), \\\\\n{\\boldsymbol{t}}\n&= \\frac{(1,\\frac{\\partial h}{\\partial x})}{\\left(1+\\left(\\frac{\\partial h}{\\partial x}\\right)^2\\right)^{1/2}}\\approx \\left(1,\\varepsilon\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}\\right)\\\\\n\\nabla\\cdot{\\boldsymbol{n}}\n&= -\\frac{\\frac{\\partial^2 h}{\\partial x^2}}{\\left(1+\\left(\\frac{\\partial h}{\\partial x}\\right)^2\\right)^{3/2}}\n\\approx -\\frac{\\varepsilon}{L}\\frac{\\partial^2 \\tilde{h}}{\\partial \\tilde{x}^2}\n\\end{aligned}\n and that the viscous stress tensor S_{ij} is given by \nS_{ij} =\\frac{\\mu U}{L}\\begin{pmatrix}\n-\\frac{\\tilde{p}}{\\varepsilon^2}   +2\\frac{\\partial \\tilde{u}}{\\partial \\tilde{x}} & \\varepsilon^{-1} \\frac{\\partial \\tilde{u}}{\\partial \\tilde{y}} + \\varepsilon\\frac{\\partial \\tilde{v}}{\\partial \\tilde{x}}\\\\\n\\varepsilon^{-1}\\frac{\\partial \\tilde{u}}{\\partial \\tilde{y}} + \\varepsilon\\frac{\\partial \\tilde{v}}{\\partial \\tilde{x}} & -\\frac{\\tilde{p}}{\\varepsilon^2}  +2\\frac{\\partial \\tilde{v}}{\\partial \\tilde{y}}\n\\end{pmatrix}.\n\nOur boundary conditions are the kinematic (\\frac{D f}{Dt}=0) condition \n\\frac{\\partial h}{\\partial t} +  u\\frac{\\partial h}{\\partial x} = v\n and our dynamic condition (-p_{\\text{atm}}\\,{\\boldsymbol{n}}-{\\boldsymbol{S}}\\cdot{\\boldsymbol{n}}= {\\boldsymbol{n}}\\,\\sigma\\nabla\\cdot{\\boldsymbol{n}}) which we split into tangential and normal components (by dotting our dynamic condition with {\\boldsymbol{t}} and {\\boldsymbol{n}}, respectively) to obtain \n{\\boldsymbol{t}}\\cdot({\\boldsymbol{S}}{\\boldsymbol{n}}) =0 \\qquad \\hbox{and}\\qquad -p_{\\text{atm}}-{\\boldsymbol{n}}\\cdot({\\boldsymbol{S}}{\\boldsymbol{n}}) = \\sigma\\nabla\\cdot{\\boldsymbol{n}}.\n\nTherefore, after identifying the dominant terms in each equation, our leading order dimensionless equations are the kinematic equation \n\\frac{\\partial \\tilde{h}}{\\partial \\tilde{t}} +  \\tilde{u}\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}} = \\tilde{v}\n\\tag{5.7} tangential stress equation \n\\frac{\\partial \\tilde{u}}{\\partial \\tilde{y}}=0\\qquad\\hbox{at}\\qquad \\tilde{y}=\\tilde{h}(\\tilde{x},\\tilde{t})\n\\tag{5.8} and normal stress equation \n\\tilde{p} - \\tilde{p}_{\\text{atm}} =  -\\frac{\\sigma\\varepsilon^3}{\\mu U}\\frac{\\partial^2 \\tilde{h}}{\\partial \\tilde{x}^2}\\qquad\\hbox{at}\\qquad \\tilde{y}=\\tilde{h}(\\tilde{x},\\tilde{t})\n where we can again identify a dimensionless parameter the capillary number \\mathrm{Ca}=\\frac{\\mu U}{\\sigma}. At this stage, we can choose to either neglect the surface tension terms \\mathrm{Ca}\\,\\varepsilon^{-3} \\ll 1 or keep them alongside the pressure terms \\mathrm{Ca}\\,\\varepsilon^{-3}\\sim1 and the choice will depend on the problem in question. We choose the latter option and redefine a scaled capillary number \\overline{\\mathrm{Ca}} = \\mathrm{Ca}\\,\\varepsilon^{-3} = \\frac{\\mu U L_x^3}{\\sigma L_y^3} so that \n\\tilde{p} - \\tilde{p}_{\\text{atm}} =  -\\overline{\\mathrm{Ca}}^{-1}\\frac{\\partial^2 \\tilde{h}}{\\partial \\tilde{x}^2}\\qquad\\hbox{at}\\qquad \\tilde{y}=\\tilde{h}(\\tilde{x},\\tilde{t}).\n\\tag{5.9}\n\n\nThin Film Equations\nApplying our new boundary conditions are combined with the previous setup of bulk equations Equation 5.1, Equation 5.2 and Equation 5.3 alongside boundary conditions at y=0, where for simplicity we assume a stationary solid \n\\tilde{u}=\\tilde{v}=0\\qquad\\hbox{at}\\qquad \\tilde{y}=0.\n and the procedure will be similar to before, expect now we have a boundary condition for \\tilde{p} and would like to find \\tilde{h} as part of the solution.\nIntegrating the incompressibility equation Equation 5.1 ‘across the channel’ gives \n0 =  \\frac{\\partial}{\\partial \\tilde{x}}\\left(\\int^{\\tilde{h}(\\tilde{x},\\tilde{t})}_0 \\tilde{u} d\\tilde{y}\\right) - \\left.\\tilde{u}\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}\\right|_{\\tilde{y}=\\tilde{h}(\\tilde{x},\\tilde{t})} + \\left[\\tilde{v}\\right]^{\\tilde{y}=\\tilde{h}(\\tilde{x},\\tilde{t})}_{\\tilde{y}=0}.\n Applying the kinematic boundary conditions on \\tilde{v}, that is Equation 5.7, we obtain \n0 =  \\frac{\\partial ( \\tilde{h}\\bar{\\tilde{u}})}{\\partial\\tilde{x}}  - \\left.\\tilde{u}\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}\\right|_{\\tilde{y}=\\tilde{h}(x,t)} + \\frac{\\partial \\tilde{h}}{\\partial \\tilde{t}} +  \\left.\\tilde{u}\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}\\right|_{\\tilde{y}=\\tilde{h}(x,t)} = \\frac{\\partial (\\tilde{h} \\bar{\\tilde{u}})}{\\partial\\tilde{x}}   + \\frac{\\partial \\tilde{h}}{\\partial \\tilde{t}}\n where we have again used the mean velocity Equation 5.5 across the channel.\nNoting from Equation 5.3 that the pressure does not depend on y, at every point in (x,t) it must be equal to its value at the free surface, given by Equation 5.9 so that \n\\tilde{p}(\\tilde{x},\\tilde{t}) =  \\tilde{p}_{\\text{atm}}  -\\overline{\\mathrm{Ca}}^{-1}\\frac{\\partial^2 \\tilde{h}}{\\partial \\tilde{x}^2}\\qquad\\implies\\qquad \\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}} =-\\overline{\\mathrm{Ca}}^{-1}\\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3}\n and hence the x-momentum equation Equation 5.2 becomes \n\\frac{\\partial \\tilde{p}}{\\partial \\tilde{x}} = -\\overline{\\mathrm{Ca}}^{-1}\\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3} = \\frac{\\partial^2 \\tilde{u}}{\\partial \\tilde{y}^2}.\n Integrating this we find \n\\tilde{u} = -\\overline{\\mathrm{Ca}}^{-1}\\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3} \\frac{\\tilde{y}^2}{2} +C(\\tilde{x},\\tilde{t}) y + D(\\tilde{x},\\tilde{t})\n which with \\tilde{u}(0)=0 and \\left.\\frac{\\partial \\tilde{u}}{\\partial \\tilde{y}}\\right|_{\\tilde{y}=\\tilde{h}}=0 gives \n\\tilde{u} =  -\\overline{\\mathrm{Ca}}^{-1}\\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3} \\tilde{y}(\\frac{\\tilde{y}}{2}-\\tilde{h})\n so that from Equation 5.5 we have \n\\bar{\\tilde{u}} = -\\frac{1}{\\tilde{h}}\\overline{\\mathrm{Ca}}^{-1}\\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3} \\left[\\frac{\\tilde{y^3}}{6}-\\tilde{h}\\frac{\\tilde{y^2}}{2}\\right]^{\\tilde{h}}_0 = \\frac{\\tilde{h}^2}{3}\\overline{\\mathrm{Ca}}^{-1}\\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3}\n\\tag{5.10} and finally we obtain the thin film equation \n\\frac{\\partial \\tilde{h}}{\\partial \\tilde{t}} +\\frac{1}{3\\mathrm{Ca}}\\frac{\\partial}{\\partial\\tilde{x}}\\left( \\tilde{h}^3\\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3} \\right) =0.\n\\tag{5.11}\nIn dimensional terms the thin film equation is given by \n\\mu\\frac{\\partial h}{\\partial t} +\\frac{\\sigma}{3}\\frac{\\partial}{\\partial x}\\left( h^3\\frac{\\partial^3 h}{\\partial x^3} \\right) =0.\n showing that the equation represents flow that is governed by a balance of viscous (first term) and surface tension (second term). Remarkably, we have gone from the impenetrable-looking Navier-Stokes equations with complex free surface boundary conditions down to a single partial differential equation for the height of the free surface \\tilde{h}. The only disadvantage is that we have now introduced higher order derivatives that will need care when computed numerically and considerable nonlinearity. Notably, this suggests we will need two boundary conditions on \\tilde{h} and/or its derivatives at each end of the domain.\n\nBoundary Conditions\nOne can consider numerous different possibilities, but one of the simplest occurs if we think of the boundaries of our domain either being a rigid vertical solid which the free surface meets perpendicularly (i.e. \\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}=0) or a symmetry plane meaning again that \\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}}=0. Also, in both cases there will be no mean velocity at the boundary so that \\bar{\\tilde{u}}=0 which from Equation 5.10 means that \\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3} =0 also. Therefore, in these cases our two boundary conditions at each end of the domain are given by \n\\frac{\\partial \\tilde{h}}{\\partial \\tilde{x}} =\\frac{\\partial^3 \\tilde{h}}{\\partial \\tilde{x}^3} =0\\qquad\\hbox{at}\\qquad \\tilde{x}=0,1\n\\tag{5.12}\nOf course, many other possibilities exist, e.g. including periodic boundary conditions or conditions that specify a particular gradient for the free surface.",
    "crumbs": [
      "Fluids",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lubrication and Thin Film Dynamics</span>"
    ]
  },
  {
    "objectID": "2-0-solids.html",
    "href": "2-0-solids.html",
    "title": "Solids",
    "section": "",
    "text": "Introduction\nIn this half of the module our focus switches to solids, and the modelling of shape change and motion of solid materials under the action of applied forces. An important fundamental difference between fluids and solids is that solids do not ‘flow’ in the same way. As a consequence, points in a solid material that are nearby at one time tend to remain very close to one another at later times.\nAs a thought experiment, consider performing an experiment to observe the physical properties of a fluid, pouring it into a beaker, stirring it up and then doing the same experiment again. The fluid has been completely deformed and distorted by this process, but we expect the mechanical properties to remain the same. In contrast, we are not able to do the same to a solid; instead, they tend to want to return to their original shape between experiments. This shows that a solid ‘remembers’ its shape in a way a fluid does not. A common approach is therefore to introduce a reference shape for a solid and measure change relative to this reference. As we will see, this means it is more convenient to use a Lagrangian formulation (rather than an Eulerian formulation, as we used in the fluids part) of the appropriate equations.",
    "crumbs": [
      "Solids"
    ]
  },
  {
    "objectID": "2-0-solids.html#outline",
    "href": "2-0-solids.html#outline",
    "title": "Solids",
    "section": "Outline",
    "text": "Outline\nDuring the lectures in this second part, we will cover the following topics:\n\nLinear Elasticity Theory: more on the Lagrangian formalism, deformations and displacements, strain, stress, Hooke’s law, and the equations of linear elastostatics.\nThe Finite Element Method: weak vs strong forms of partial differential equations and the basics of the finite element method (FEM), including the notion of elements, shape functions and numerical integration. We also discuss boundary conditions and practical implementation.\nBeam Theory: the Bernoulli-Euler beam equation, FEM for the reduced problem, and discussion of other reduced theories.\nElasticity for Crystal Defects: the elastic Green’s function, the connection between atomistic and continuum theory, and how defects are modelled using linear elasticity theory. Point defects as elastic inclusions.\n\nIn the workshops you will develop your own codes to solve real-world problems.\n\nComputational Solid Mechanics: the finite element method (both from scratch and using packages), basis functions, numerical integration, linear algebra, error, meshing and refinement.",
    "crumbs": [
      "Solids"
    ]
  },
  {
    "objectID": "2-1-macro-solids.html",
    "href": "2-1-macro-solids.html",
    "title": "6  Linear Elasticity Theory",
    "section": "",
    "text": "6.1 Motion and deformation\nAs mentioned in the introduction to this part of the module, we typically focus on a Lagrangian description in solid mechanics. Whereas in fluids we solve for the velocity and pressure fields {\\boldsymbol{v}} and p, in solids we solve for either the deformation map or displacement field, which we discuss in detail here. We also formulate the equations of linear elasticity, which describe the simplest equilibrium equations we can use to model a solid.\nConsider a continuum body B at time t=0, which will be the reference configuration. At later times, we describe the new shape of the body B_t and the position of the points within it by introducing a motion or deformation map, {\\boldsymbol{\\varphi}}({\\boldsymbol{X}},t), taking points {\\boldsymbol{X}}\\in B to their positions {\\boldsymbol{x}} at time t. The new shape of the body at time t is denoted B_t, defined to be all points {\\boldsymbol{x}} with \n{\\boldsymbol{x}}= {\\boldsymbol{\\varphi}}({\\boldsymbol{X}},t)\\qquad\\text{for some point }{\\boldsymbol{X}}\\in B.\n In mathematical notation, we can write B_t = {\\boldsymbol{\\varphi}}(B,t), and the set of points B_t is referred to as the deformed configuration. An illustration of the various coordinate systems is given in Figure 6.1.\nAn alternative way to describe the shape change of a solid body is to use a displacement function. Instead of describing the new positions of points in the body in full as the deformation map does, the displacement measures relative motion. The displacement of a reference point {\\boldsymbol{X}} at time t is defined to be \n{\\boldsymbol{u}}({\\boldsymbol{X}},t) = {\\boldsymbol{\\varphi}}({\\boldsymbol{X}},t)-{\\boldsymbol{X}}.\n Whereas the deformation map tells us exactly where in space a reference point has moved to, the displacement map tells us how much the point has moved.",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Linear Elasticity Theory</span>"
    ]
  },
  {
    "objectID": "2-1-macro-solids.html#motion-and-deformation",
    "href": "2-1-macro-solids.html#motion-and-deformation",
    "title": "6  Linear Elasticity Theory",
    "section": "",
    "text": "Figure 6.1: The reference configuration (left) and the deformed configuration (right).\n\n\n\n\n\n\n\n\n\nExample\n\n\n\nSuppose the reference configuration is a cube of material with sides of unit length with 0\\leq X_i \\leq 1. What happens to the cube when it undergoes the motion \n{\\boldsymbol{\\varphi}}({\\boldsymbol{X}},t) = (3Xt+Y+t,Y,Z)?",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Linear Elasticity Theory</span>"
    ]
  },
  {
    "objectID": "2-1-macro-solids.html#strain",
    "href": "2-1-macro-solids.html#strain",
    "title": "6  Linear Elasticity Theory",
    "section": "6.2 Strain",
    "text": "6.2 Strain\nThe term strain is used to refer to a variety of measures of shape change which are important in describing solids, and there are quite a few different choices available for different reasons. Strain measures are usually dimensionless, since they involve first spatial derivatives of some sort of postion variable.\nThe first measure we introduce is the deformation gradient {\\boldsymbol{F}}. This is a tensor field, defined to be \n{\\boldsymbol{F}}= \\nabla{\\boldsymbol{\\varphi}},\\qquad\\text{or in components:}\\quad F_{ij} = \\frac{\\partial\\varphi_i}{\\partial X_j}. To see why this measures strain, consider a small segment of material in the reference configuration connecting the point {\\boldsymbol{X}} to the nearby point {\\boldsymbol{X}}+\\delta {\\boldsymbol{X}}. After the deformation is applied, we can Taylor expand the differences in the ith coordinate to see that \n\\varphi_i({\\boldsymbol{X}}+\\delta {\\boldsymbol{X}})-\\varphi_i({\\boldsymbol{X}}) = \\frac{\\partial \\varphi_i}{\\partial X_j}({\\boldsymbol{X}})\\delta X_j+O\\left(|\\delta{\\boldsymbol{X}}|^2\\right) \\approx F_{ij}({\\boldsymbol{X}})\\delta X_j,\n and we see that {\\boldsymbol{F}} encodes the local transformation of the initial displacement \\delta{\\boldsymbol{X}}. A simple class of deformation we can consider are those where {\\boldsymbol{F}} is constant in the body (but possibly time-dependent). This means that the corresponding motion must take the form \n{\\boldsymbol{\\varphi}}({\\boldsymbol{X}},t) = {\\boldsymbol{F}}(t){\\boldsymbol{X}}+{\\boldsymbol{c}}(t),\n where {\\boldsymbol{c}} is a translation vector. Motions of this type are called homogeneous deformations, and provide us with a simple class to test our theories with.\n\n\n\n\n\n\nExample\n\n\n\nConsider the two-dimensional deformation in which \n\\begin{aligned}\n    x &= \\tfrac14(18+4X+6Y)\\\\\n    y &= \\tfrac14(14+6Y).\n\\end{aligned}\n What is the (2\\times 2) deformation gradient tensor {\\boldsymbol{F}} in this case? Sketch the deformation of a reference square of material centred at (0,0).\n\n\nLet’s consider how lengths change under a deformation. Again consider two nearby points {\\boldsymbol{X}} and {\\boldsymbol{X}}+\\delta{\\boldsymbol{X}}. After deformation, the distance between these points can be approximated using the deformation gradient as follows: \n|{\\boldsymbol{\\varphi}}({\\boldsymbol{X}}+\\delta{\\boldsymbol{X}})-{\\boldsymbol{\\varphi}}({\\boldsymbol{X}})|^2 \\approx |{\\boldsymbol{F}}\\,\\delta{\\boldsymbol{X}}|^2 = ({\\boldsymbol{F}}\\delta{\\boldsymbol{X}})\\cdot({\\boldsymbol{F}}\\delta{\\boldsymbol{X}}) = \\delta{\\boldsymbol{X}}\\cdot\\left(({\\boldsymbol{F}}^T{\\boldsymbol{F}})\\delta{\\boldsymbol{X}}\\right)\n where {\\boldsymbol{F}}^T is the transpose, obtained by swapping components across the diagonal so (F^T)_{ij} = F_{ji}. The tensor {\\boldsymbol{C}}:= {\\boldsymbol{F}}^T{\\boldsymbol{F}} is called the right Cauchy-Green strain, and it provide a way to encode infinitesimal length change. {\\boldsymbol{C}} is not sensitive to rotations, whereas {\\boldsymbol{F}} is, and it is always symmetric.\nThe case where there is no length change (and so no shape change) occurs when {\\boldsymbol{C}} is the identity tensor {\\boldsymbol{I}}. If we shift by removing the identity tensor (and by convention dividing by 2), we get another form of strain, called the Lagrange strain: \n{\\boldsymbol{E}}:= \\tfrac12({\\boldsymbol{C}}-{\\boldsymbol{I}}) = \\tfrac12({\\boldsymbol{F}}^T{\\boldsymbol{F}}-{\\boldsymbol{I}}).\n Another way to measure strain is to use the displacement gradient, denoted \n\\nabla{\\boldsymbol{u}}= {\\boldsymbol{F}}-{\\boldsymbol{I}},\\quad\\text{with components}\\quad (\\nabla {\\boldsymbol{u}})_{ij} = \\frac{\\partial u_i}{\\partial X_j}.\n If we write the Lagrange strain in terms of \\nabla {\\boldsymbol{u}}, we find \n{\\boldsymbol{E}}= \\frac12\\Big(({\\boldsymbol{I}}+\\nabla{\\boldsymbol{u}})^T({\\boldsymbol{I}}+\\nabla{\\boldsymbol{u}})-{\\boldsymbol{I}}\\Big) = \\frac12\\Big(\\nabla{\\boldsymbol{u}}+\\nabla{\\boldsymbol{u}}^T+\\nabla{\\boldsymbol{u}}^T\\nabla{\\boldsymbol{u}}\\Big).\n If \\nabla{\\boldsymbol{u}} is small, then we can linearise this definition by neglecting the \\nabla{\\boldsymbol{u}}^T\\nabla{\\boldsymbol{u}} term, which gives us the definition of the infinitesimal strain, denoted \n{\\boldsymbol{\\varepsilon}}= \\frac12\\Big(\\nabla{\\boldsymbol{u}}+\\nabla{\\boldsymbol{u}}^T\\Big)\\quad\\text{with}\\quad \\varepsilon_{ij} = \\frac12\\left(\\frac{\\partial u_i}{\\partial X_j}+\\frac{\\partial u_j}{\\partial X_i}\\right).\n Notice that {\\boldsymbol{C}}, {\\boldsymbol{E}} and {\\boldsymbol{\\varepsilon}} are symmetric tensors, while the direct derivatives {\\boldsymbol{F}}= \\nabla{\\boldsymbol{\\varphi}} and \\nabla{\\boldsymbol{u}} are not. For much of what we do in this part of the module, our main focus will be on models where we use the linearised strain {\\boldsymbol{\\varepsilon}}, as this is the measure of strain which is used in linear elasticity theory.\n\n\n\n\n\n\nExample\n\n\n\nAgain, consider the two-dimensional deformation in which \n\\begin{aligned}\n    x &= \\tfrac14(18+4X+6Y)\\\\\n    y &= \\tfrac14(14+6Y).  \n\\end{aligned}\n What are the different measures of strain {\\boldsymbol{C}}, {\\boldsymbol{E}}, {\\boldsymbol{\\varepsilon}} in this case?",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Linear Elasticity Theory</span>"
    ]
  },
  {
    "objectID": "2-1-macro-solids.html#stress-in-solids",
    "href": "2-1-macro-solids.html#stress-in-solids",
    "title": "6  Linear Elasticity Theory",
    "section": "6.3 Stress in solids",
    "text": "6.3 Stress in solids\nRecall that in Chapter 2, we showed Newton’s second law implies that \n\\rho\\frac{D{\\boldsymbol{v}}}{Dt} = \\nabla\\cdot{\\boldsymbol{S}}-\\rho g{\\boldsymbol{e}}_3,\n where we now use {\\boldsymbol{v}} to denote the velocity field, and {\\boldsymbol{S}} is the Cauchy stress tensor. Recall that {\\boldsymbol{S}}{\\boldsymbol{n}} expresses the forces per unit area acting across a surface with normal {\\boldsymbol{n}} in the deformed configuration (i.e. in the Eulerian setting). This equation holds for solids too, it’s just that to model these materials, we will need to change the constitutive equation for {\\boldsymbol{S}}.\nIn particular, we are going to focus on the static form of this equation in which there is no motion. If {\\boldsymbol{v}}={\\boldsymbol{0}}, we can rearrange to get the force balance equations: \n\\nabla\\cdot{\\boldsymbol{S}}= \\rho g{\\boldsymbol{e}}_3\\quad\\text{or}\\quad \\frac{\\partial S_{ij}}{\\partial X_j} = \\rho g \\delta_{i3}. This gives us 3 equations for 6 unknowns (the components of the stress tensor), so to close the equations we need a constitutive relation. For solids, we typically assume {\\boldsymbol{S}} depends on some measure of strain. This is in constrast to fluids, where it tends to depend only strain rate.\nBefore introducing the constitutive relation used in linear elasticity theory, we’ll discuss stress in general. Solids tend to exhibit a lot more variability in their response to applied stresses, essentially because they don’t flow. To allow us to discuss this response, we’ll introduce the following definitions, which are illustrated in Figure 6.2:\n\nIf the stress tensor {\\boldsymbol{S}} takes the form \n{\\boldsymbol{S}}= \\left(\n\\begin{array}{ccc}\n    -p &  0 & 0 \\\\\n     0 & -p & 0 \\\\\n     0 &  0 & -p\n\\end{array}\\right),\n where p is a scalar pressure, we say that a spherical state of stress exists at {\\boldsymbol{x}}.\nThe stress is said to be uniaxial is there exists Cartesian coordinate system in which the stress tensor takes the form \n{\\boldsymbol{S}}=\n  \\left(\n  \\begin{array}{ccc}\n  \\sigma & 0 & 0 \\\\\n  0      & 0 & 0 \\\\\n  0      & 0 & 0\n  \\end{array}\\right).\n If \\sigma&gt;0, we call this state a pure tension, and if \\sigma&lt;0, a pure compression.\nIf in some Cartesian coordinate system the stress tensor takes the form \n{\\boldsymbol{S}}=\n  \\left(\n    \\begin{array}{ccc}\n      0 & \\tau & 0 \\\\\n      \\tau & 0 & 0 \\\\\n      0    & 0 & 0\n    \\end{array}\n  \\right)\n then we say that a state of pure shear stress exists.\nMore generally, if in some Cartesian coordinate system {\\boldsymbol{S}} takes the form \n{\\boldsymbol{S}}=\n  \\left(\n    \\begin{array}{ccc}\n      S_{11} & S_{12} & 0 \\\\\n      S_{21} & S_{22} & 0 \\\\\n      0     & 0     & 0\n    \\end{array}\n  \\right),\n we say that a state of plane stress exists.\n\nMost stress states are more general than these particular examples, but these tend to be the easiest to visualise and understand.\n\n\n\n\n\n\n\n\n\n\n\n(a) A spherical state of stress\n\n\n\n\n\n\n\n\n\n\n\n(b) A uniaxial state of stress\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) A pure shear state of stress\n\n\n\n\n\n\n\n\n\n\n\n(d) A plane state of stress\n\n\n\n\n\n\n\nFigure 6.2: An illustration of some simple stress states acting on a 2D slice of a body.\n\n\n\n\nTypes of stress\nConsider a surface with unit normal {\\boldsymbol{n}}. The corresponding stress vector {\\boldsymbol{t}}= {\\boldsymbol{S}}{\\boldsymbol{n}} acting on this surface can be decomposed into two parts: \n\\begin{aligned}\n    \\text{a \\emph{normal stress}:}&\\qquad&{\\boldsymbol{t}}_n &= ({\\boldsymbol{t}}\\cdot{\\boldsymbol{n}}){\\boldsymbol{n}},\\\\\n    \\text{and a \\emph{shear stress}:}&\\qquad&{\\boldsymbol{t}}_s&= {\\boldsymbol{t}}-({\\boldsymbol{t}}\\cdot{\\boldsymbol{n}}){\\boldsymbol{n}},\n\\end{aligned}\n In particular, we have {\\boldsymbol{t}}={\\boldsymbol{t}}_n+{\\boldsymbol{t}}_s, and we call \\sigma_n=|{\\boldsymbol{t}}_n| the normal stress and \\sigma_s=|{\\boldsymbol{t}}_s| the shear stress on the surface with normal {\\boldsymbol{n}} at {\\boldsymbol{x}}.\nIt is often of interest to understand what sorts of surfaces experience the largest stresses of various types, because we want to be sure that the material does not fail. For example, both high levels of tension (a normal stress state) and high levels of shear stress can induce cracking. The threshold for these two different modes of failure is often different, and so the places which may be prone to issues can vary depending on the material and the shape of a design.",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Linear Elasticity Theory</span>"
    ]
  },
  {
    "objectID": "2-1-macro-solids.html#hookes-law-revisited",
    "href": "2-1-macro-solids.html#hookes-law-revisited",
    "title": "6  Linear Elasticity Theory",
    "section": "6.4 Hooke’s law revisited",
    "text": "6.4 Hooke’s law revisited\nHooke’s law is a simple rule about the behaviour of springs which you probably first learned about in school. It states that the tensile force \\tau needed to increase the length of a spring is directly proportional to its extension. We can write this law as \n\\tau = ke\\quad\\text{with}\\quad e = \\ell-\\ell_0,\n where:\n\n\\tau is the tension;\nk is the constant of proportionality, known as the spring constant;\ne is the extension of the spring;\n\\ell is the current length; and\n\\ell_0 is the equilibrium or reference length of the spring.\n\nClearly, the spring constant k will depend on the exact spring being stretched. In fact, a simple model is that the spring constant of a spring made of a given material is approximately inversely proportional to its equilibrium length. This means that k = \\mathbb{C}/\\ell_0 for some material constant \\mathbb{C} which is independent of the length, and hence \n  \\tau = \\mathbb{C}\\frac{\\ell-\\ell_0}{\\ell_0}.\n\\tag{6.1} Note that this hopefully makes intuitive sense to you: a spring which is twice as long stretches twice as far under the same force; see Figure 6.3.\n\n\n\n\n\n\nFigure 6.3: Two springs of different equilibrium lengths, expanding under the same force. The extension in the spring twice as long is twice as large under the same force.\n\n\n\nThe ratio of extension over length that appears in Equation 6.1 is a first example of a measure of strain, describing the change in length relative to some reference length. In fact, it can be thought of as a component of the infinitesimal strain {\\boldsymbol{\\varepsilon}}. To see the connection with our definitions in the previous chapter, if we introduce a reference domain [0,\\ell_0], then we can define a deformation \n\\varphi(X) = \\frac{\\ell}{\\ell_0}X\\quad\\text{for }0\\leq X\\leq \\ell_0.\n The deformation gradient in this one-dimensional example is \nF = \\varphi'(X) = \\frac{\\ell}{\\ell_0},\n and the displacement is \nu(X) = \\varphi(X)-X = \\frac{\\ell}{\\ell_0}X-X = \\frac{\\ell-\\ell_0}{\\ell_0}X\n so the displacement gradient is \nu'(X) = \\frac{\\ell-\\ell_0}{\\ell_0}.\n Since there is nothing to symmetrise in this case, the infinitesimal strain is \\varepsilon = \\frac{\\ell-\\ell_0}{\\ell_0}, and so we see that \n\\tau = \\mathbb{C}\\varepsilon.\n Linear elasticity amounts to a generalisation of this relationship to the full three-dimensional setting.",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Linear Elasticity Theory</span>"
    ]
  },
  {
    "objectID": "2-1-macro-solids.html#linear-elasticity",
    "href": "2-1-macro-solids.html#linear-elasticity",
    "title": "6  Linear Elasticity Theory",
    "section": "6.5 Linear elasticity",
    "text": "6.5 Linear elasticity\nAs we saw in the first part of the course, forces acting across surfaces inside and on the boundary of a continuum body can be encoded using the stress tensor. In linear elasticity theory, we generalise Hooke’s law by assuming that the stress tensor {\\boldsymbol{S}} can be expressed as a linear function of the infinitesimal strain tensor {\\boldsymbol{\\varepsilon}}. In this case, the single coefficient \\mathbb{C} discussed above for a spring becomes a fourth-order elasticity tensor \\mathbb{C}, with \n{\\boldsymbol{S}}= \\mathbb{C}{\\boldsymbol{\\varepsilon}}\\qquad\\text{with components}\\qquad S_{ij} = \\mathbb{C}_{ijkl}\\varepsilon_{kl}.\n In principle, \\mathbb{C} could contain 81 independent parameters (also sometimes called moduli) as it has this many different indices. However, since {\\boldsymbol{S}} and {\\boldsymbol{\\varepsilon}} are both symmetric and the elasticity tensor satisfies major symmetry, meaning that \\mathbb{C}_{ijkl} =\\mathbb{C}_{klij}, there are in fact only 21 possible unique parameters in general. In fact, one way to see this is to use Voigt notation, where we relate the vectors \n\\begin{aligned}\n  \\widetilde{{\\boldsymbol{S}}} &= (S_{11},S_{22},S_{33},S_{23},S_{31},S_{12}) \\\\\n  \\text{and}\\quad\\widetilde{{\\boldsymbol{\\varepsilon}}}&= (\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33},2\\varepsilon_{23},2\\varepsilon_{31},2\\varepsilon_{12})\n\\end{aligned}\n via a matrix multiplication. It is common to make the change of index notation \n11\\leftrightarrow 1,\\,\n22\\leftrightarrow 2,\\,\n33\\leftrightarrow 3,\\,\n23=32\\leftrightarrow 4,\\,\n31=13\\leftrightarrow 5,\\,\n12=21\\leftrightarrow 6,\n and then we have \n\\left(\n\\begin{array}{c}\n    S_1 \\\\ S_2 \\\\ S_3 \\\\ S_4 \\\\ S_5 \\\\ S_6\n\\end{array}\n\\right)\n=\n\\left(\n\\begin{array}{cccccc}\n    C_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \\\\\n            & C_{22} & C_{23} & C_{24} & C_{25} & C_{26} \\\\\n            &        & C_{33} & C_{34} & C_{35} & C_{36} \\\\\n            &        &        & C_{44} & C_{45} & C_{46} \\\\\n            &        &        &       & C_{55} & C_{56} \\\\\n            &        &        &       &       & C_{66}\n\\end{array}\n\\right)\n\\left(\n\\begin{array}{c}\n    \\varepsilon_1 \\\\ \\varepsilon_2 \\\\ \\varepsilon_3 \\\\ 2\\varepsilon_4 \\\\ 2\\varepsilon_5 \\\\ 2\\varepsilon_6\n\\end{array}\n\\right),\n where the part of the matrix below the diagonal is the reflection of that above the diagonal, i.e. C_{ij} = C_{ji}. The mysterious factor of 2 appearing is there to ensure that \n\\tfrac12\\widetilde{{\\boldsymbol{S}}}\\cdot\\widetilde{{\\boldsymbol{\\varepsilon}}} = \\tfrac12S_{ij}\\varepsilon_{ij} = \\tfrac12\\mathbb{C}_{ijkl}\\varepsilon_{ij}\\varepsilon_{kl},\n which encodes the elastic energy density in the material.\nUnder more specific assumptions about the symmetries of the underlying material, the number of independent components reduces much further. A common simplifying assumption to assume that a material is isotropic: this entails that there are just two independent elasticity parameters, and the matrix above becomes \n\\left(\n\\begin{array}{cccccc}\n    C_{11} & C_{12} & C_{12} & 0 & 0 & 0 \\\\\n    C_{12} & C_{11} & C_{12} & 0 & 0 & 0 \\\\\n    C_{12} & C_{12} & C_{11} & 0 & 0 & 0 \\\\\n    0 & 0 & 0 & C_{44} & 0     & 0 \\\\\n    0 & 0 & 0 & 0     & C_{44} & 0 \\\\\n    0 & 0 & 0 & 0     & 0     & C_{44}\n\\end{array}\n\\right),\n with the additional restriction that C_{12} = C_{11}-2C_{44}. Even in this simplest case, there are still twice as many parameters as are needed to describe a Newtonian fluid, where we have only one viscosity parameter! This is because common elastic materials are not incompressible (even approximately). Another common case is crystalline materials with cubic symmetry, where C_{11}, C_{12} and C_{44} are independent parameters. We will focus in particular on the isotropic case, since this makes various aspects easier, but the theory can obviously be developed in general.\nIn an isotropic linear elastic material, the elasticity tensor can be represented neatly as \n\\mathbb{C}_{ijkl} = \\kappa\\, \\delta_{ij}\\delta_{kl} + G\\left(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}-\\tfrac23\\delta_{ij}\\delta_{kl}\\right),\n or in Voigt notation, the matrix representation is \n\\left(\n    \\begin{array}{cccccc}\n      \\kappa+\\frac43G & \\kappa-\\frac23G & \\kappa-\\frac23G & 0 & 0 & 0 \\\\\n      \\kappa-\\frac23G & \\kappa+\\frac43G & \\kappa-\\frac23G & 0 & 0 & 0 \\\\\n      \\kappa-\\frac23G & \\kappa-\\frac23G & \\kappa+\\frac43G & 0 & 0 & 0 \\\\\n      0 & 0 & 0 & G & 0 & 0 \\\\\n      0 & 0 & 0 & 0 & G & 0 \\\\\n      0 & 0 & 0 & 0 & 0 & G\n    \\end{array}\n  \\right),\n The parameters involved here are \\kappa, the bulk modulus; and G, the shear modulus. To illustrate why these parameters have these names, we now consider a couple of simple thought experiments.\n\nThe bulk modulus\n\n\n\n\n\n\nFigure 6.4: An illustration of the uniform expansion considered in discussion of bulk modulus.\n\n\n\nConsider an isotropic linear elastic material undergoing a uniform compression or expansion, i.e. experiencing the deformation {\\boldsymbol{\\varphi}}({\\boldsymbol{X}}) = (1+\\tfrac13\\alpha){\\boldsymbol{X}}. The volume of unit cube after this deformation can be expressed using the determinant of the deformation gradient, \nJ = \\det{\\boldsymbol{F}}= (1+\\tfrac13\\alpha)^3 = 1+\\alpha+\\tfrac13\\alpha^2+\\tfrac{1}{27}\\alpha^3.\n When \\alpha is small, we can neglect the quadratic and cubic terms to approximate the new volume as J \\approx 1+\\alpha, so \\alpha tells us the approximate change in volume in this case.\nLet’s now see what the stress in the material, assuming it is an isotropic linear elastic solid. First, we translate from deformation into displacement, where \nu_i = \\tfrac13\\alpha X_i\\quad\\text{so}\\quad \\frac{\\partial u_i}{\\partial X_j} = \\tfrac13\\alpha\\delta_{ij}\\quad\\text{and}\\quad \\varepsilon_{ij} = \\tfrac13\\alpha\\delta_{ij}.\n Plugging in, we find \n\\varepsilon_{kk} = \\tfrac13\\alpha\\delta_{kk} = \\alpha,\n so \n\\varepsilon_{ij} - \\tfrac13\\delta_{ij}\\varepsilon_{kk} = \\tfrac13\\alpha\\delta_{ij}-\\tfrac13\\alpha\\delta_{ij} = 0.\n The stress tensor is therefore \nS_{ij} = \\kappa\\alpha\\delta_{ij}\\quad\\text{or in tensor notation}\\quad{\\boldsymbol{S}}= \\kappa\\alpha{\\boldsymbol{I}}.\n Recalling our definition from above, this is a spherical state of stress, with pressure p = -\\kappa\\alpha, and we see that \\kappa is the constant of proportionality between the approximate volume change \\alpha and the resulting pressure induced in the material.\n\n\nThe shear modulus\n\n\n\n\n\n\nFigure 6.5: A simple shear.\n\n\n\nConsider an isotropic linear elastic material undergoing a simple shear in which \n{\\boldsymbol{\\varphi}}({\\boldsymbol{X}}) = (X+\\alpha Y,Y,Z).\n We have \n{\\boldsymbol{u}}= (\\alpha Y,0,0)\\quad\\text{so}\\quad\n  \\nabla{\\boldsymbol{u}}= \\left(\n    \\begin{array}{ccc}\n      0 & \\alpha & 0 \\\\\n      0 & 0 & 0 \\\\\n      0 & 0 & 0\n    \\end{array}\n  \\right)\\quad\\text{and}\\quad\n  {\\boldsymbol{\\varepsilon}}= \\left(\n    \\begin{array}{ccc}\n      0 & \\tfrac12\\alpha & 0 \\\\\n      \\tfrac12\\alpha & 0 & 0 \\\\\n      0 & 0 & 0\n    \\end{array}\n  \\right).\n It is easy to check that \\varepsilon_{kk} = 0, and so plugging in, \n{\\boldsymbol{S}}=\n\\left(\n    \\begin{array}{ccc}\n        0 & G\\alpha & 0 \\\\\n        G\\alpha & 0 & 0 \\\\\n        0 & 0 & 0\n    \\end{array}\n\\right).\n This is a state of pure shear stress, and we see that G is the constant of proportionality relating the shear strain to the shear stress induced in the material.\n\n\nYoung’s modulus and the Poisson ratio\n\n\n\n\n\n\nFigure 6.6: A uniaxial stretch.\n\n\n\nAlong with the bulk and shear moduli, there are other possible elastic coefficients we can use; another convenient pair are the Young’s modulus, E and Poisson ratio, \\nu.\nTo illustrate what these coefficents are, let’s consider stretching the material in one direction. In general, you may already be aware that material tends to thin in directions orthogonal to that in which it is stretched (think of an elastic band). This means it will be useful for us to consider the material simultaneously contracting in the other directions, so we consider the deformation \n{\\boldsymbol{\\varphi}}({\\boldsymbol{X}}) = \\big((1+\\alpha)X,(1-\\beta)Y,(1-\\beta)Z\\big).\n We have \n{\\boldsymbol{u}}= (\\alpha X,-\\beta Y,-\\beta Z)\\quad\\text{so}\\quad\n\\nabla{\\boldsymbol{u}}= \\left(\n    \\begin{array}{ccc}\n        \\alpha & 0 & 0 \\\\\n        0 & -\\beta & 0 \\\\\n        0 & 0 & -\\beta\n    \\end{array}\n\\right)={\\boldsymbol{\\varepsilon}},\n where the latter equality holds because \\nabla{\\boldsymbol{u}} is symmetric. Plugging in, we find \n{\\boldsymbol{S}}=\n\\left(\n    \\begin{array}{ccc}\n        (\\kappa-\\tfrac23G)(\\alpha-2\\beta)+2G\\alpha & 0 & 0 \\\\\n        0 & (\\kappa-\\tfrac23G)(\\alpha-2\\beta)-2G\\beta & 0 \\\\\n        0 & 0 & (\\kappa-\\tfrac23G)(\\alpha-2\\beta)-2G\\beta\n    \\end{array}\n    \\right).\n Let us set \\nu = \\beta/\\alpha, and pull out a factor of \\alpha. Then, working through the algebra, we can write \n{\\boldsymbol{S}}= \\alpha\\left(\n    \\begin{array}{ccc}\n        (\\kappa+\\tfrac43G)-2\\nu(\\kappa-\\tfrac23G) & 0 & 0 \\\\\n        0 & (\\kappa-\\tfrac23G)-2\\nu(\\kappa+\\tfrac13G) & 0 \\\\\n          0 & 0 & (\\kappa-\\tfrac23G)-2\\nu(\\kappa+\\tfrac13G)\n    \\end{array}\n\\right).\n Now recall that we are free to choose \\beta, or equivalently \\nu. If we choose the special value \n\\nu = \\frac{\\kappa-\\tfrac23G}{2\\kappa+\\tfrac23G} = \\frac{3\\kappa-2G}{2(3\\kappa+G)},\n then S_{22}=S_{33}=0, and so the stresses on the sides orthogonal to the direction of of our box vanish. This is exactly what we would expect to happen when we perform a simple stretching experiment, and the value of \\nu is known as the Poisson ratio of the material, since it describes the ratio by which the material thins in directions perpendicular to that which it is stretched.\nIf we simply further in the case where we choose \\nu as above, we have \n{\\boldsymbol{S}}= \\alpha\\left(\n    \\begin{array}{ccc}\n        \\frac{9\\kappa G}{3\\kappa+G} & 0 & 0 \\\\\n        0 & 0 & 0 \\\\\n        0 & 0 & 0\n    \\end{array}\n\\right).\n We can therefore express the only non-zero stress component as S_{11} = E\\alpha, where E = \\frac{9\\kappa G}{3\\kappa+G} is the Young’s modulus of the material. Note that the Young’s modulus is the equivalent of the coefficient \\mathbb{C} which was discussed in the motivation section on springs above.\n\n\nSummary\nThe 4 parameters \\kappa, G, \\nu and E can be used to describe material behaviour, and we have seen how they are defined based on some simple thought experiments. In practice, these are the basic experiments that are used to identify the appropriate parameters in standard tests, and if the material is truly isotropic, then we can convert between any pair of the coefficients. You can find a table to do so on Wikipedia; see the bottom of this page for example. In particular, the inverse of the formulae we derived above for E and \\nu are: \n\\kappa = \\frac{E}{3(1-2\\nu)}\\quad \\text{and}\\quad G = \\frac{E}{2(1+\\nu)}.\n Note that the cases where \\nu=\\tfrac12 and \\nu=-1 are problematic, but most materials have \\nu in this range (and most have \\nu\\approx 0.3).\nSome indicative values of the moduli are shown in Table 2.1. As the infinitesimal strain is dimensionless, we find that \\kappa, G and E all have the same units as stress. Since the Poisson ratio is really a special strain value, it is dimensionless. The SI unit of stress is the pascal, written 1\\text{Pa}, which is equivalent to 1Nm^{-2}. Given the typical values observed from materials, it is more common to express the stresses experienced in solids using megapascals (1MPa = 10^6Pa) or gigapascals (1GPa = 10^9Pa).\n\n\nApproximate elastic moduli for some materials at room temperature. The closer that \\nu is to the value of 0.5, the closer the material is to being incompressible; most materials have a Poisson ratio in the range 0.2–0.4, so lead and rubber are outliers.\n\n\nMaterial\n\\kappa (GPa)\nG (GPa)\n\\nu\nE (GPa)\n\n\n\n\nAluminium\n75\n25\n0.36\n70\n\n\nCopper\n140\n47\n0.35\n125\n\n\nDiamond\n540\n460\n0.2\n1100\n\n\nLead\n41\n5\n0.44\n14\n\n\nSilicone Rubber\n2\n0.01\n0.48\n0.05\n\n\nStainless Steel\n140\n78\n0.27\n195",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Linear Elasticity Theory</span>"
    ]
  },
  {
    "objectID": "2-1-macro-solids.html#the-equations-of-linear-elastostatics",
    "href": "2-1-macro-solids.html#the-equations-of-linear-elastostatics",
    "title": "6  Linear Elasticity Theory",
    "section": "6.6 The equations of linear elastostatics",
    "text": "6.6 The equations of linear elastostatics\nNow we have developed some physical understanding of the elastic moduli, we focus on the equations of isotropic elasticity. If we use the constitutive assumption that {\\boldsymbol{S}}= \\mathbb{C}{\\boldsymbol{\\varepsilon}}, the relationship that {\\boldsymbol{\\varepsilon}}= \\frac12(\\nabla{\\boldsymbol{u}}+\\nabla{\\boldsymbol{u}}^T) and substitute into the force balance equation, we get the system of equations \n\\frac{E}{(1+\\nu)(1-2\\nu)}\\nabla(\\nabla\\cdot{\\boldsymbol{u}}) + \\frac{E}{2(1+\\nu)}\\nabla^2{\\boldsymbol{u}}+ \\rho g{\\boldsymbol{e}}_3 = {\\boldsymbol{0}}.\n We have chosen to write the equations in terms of the Young’s modulus E and Poisson ratio \\nu, but note that we could have written them in terms of any two of the elastic moduli described above. In component form, these equations are \n\\frac{E}{(1+\\nu)(1-2\\nu)}\\frac{\\partial^2 u_j}{\\partial X_i\\partial X_j}+\\frac{E}{2(1+\\nu)}\\frac{\\partial^2u_i}{\\partial X_j\\partial X_j}+\\rho g\\delta_{i3} = 0.\n\n\nBoundary conditions\nThese equations must be accompanied by appropriate boundary conditions. In simple problems, these are often displacement boundary conditions where {\\boldsymbol{u}} is prescribed on part of the boundary, or traction boundary conditions where {\\boldsymbol{S}}{\\boldsymbol{n}} is prescribed on part of the boundary. In general, a mixture of these condition will be used; see for example Figure 6.7.\n\n\n\n\n\n\nFigure 6.7: Displacement and traction boundary conditions used to simulate a tensile test. Regions where traction boundary conditions are applied are shown in blue, while displacement boundary conditions apply on the surfaces shown in red.\n\n\n\nPhysically, we can think of displacement boundary conditions as being hard constraints, so the body is clamped, welded or glued at a chosen position. Free boundaries can be represented using ‘traction-free’ boundary conditions {\\boldsymbol{S}}{\\boldsymbol{n}}= {\\boldsymbol{0}}; this condition states that there is no stress on this part of the boundary, and so the boundary will tend to take a shape that is ‘convenient’ for it. If we wish to impose a force on the boundary, so that we require {\\boldsymbol{S}}{\\boldsymbol{n}}={\\boldsymbol{t}} on the boundary, we often think of this as having normal and shear components, as discussed above. Recall that the normal component is {\\boldsymbol{t}}_n = ({\\boldsymbol{t}}\\cdot{\\boldsymbol{n}}){\\boldsymbol{n}} and the shear component {\\boldsymbol{t}}_s ={\\boldsymbol{t}}-{\\boldsymbol{t}}_n. These different components are represented in Figure 6.8. Shear components in the applied stress can for example model frictional contact with another solid body, while normal components can model something pressing against the body, e.g. a fluid or other solid object.\n\n\n\n\n\n\nFigure 6.8: An illustration of a boundary traction {\\boldsymbol{t}} acting on a surface with normal {\\boldsymbol{n}}. The traction can be split into normal and shear components, {\\boldsymbol{t}}_n = ({\\boldsymbol{t}}\\cdot{\\boldsymbol{n}}){\\boldsymbol{n}} and {\\boldsymbol{t}}_s = {\\boldsymbol{t}}-{\\boldsymbol{t}}_n.\n\n\n\n\n\nFull problem\nThe full linear elastic problem requires us to solve the system of partial differential equations: \n\\begin{aligned}\n    \\frac{E}{(1+\\nu)(1-2\\nu)}\\nabla(\\nabla\\cdot{\\boldsymbol{u}}) + \\frac{E}{2(1+\\nu)}\\nabla^2{\\boldsymbol{u}}+ \\rho g{\\boldsymbol{e}}_3 &= {\\boldsymbol{0}}&& \\text{in }B,\\\\\n    {\\boldsymbol{S}}{\\boldsymbol{n}}&= {\\boldsymbol{t}}&& \\text{on }\\Gamma_N,\\\\\n    {\\boldsymbol{u}}&= {\\boldsymbol{u}}_0 && \\text{on }\\Gamma_D.\n\\end{aligned}\n\\tag{6.2} Note there are in general 3 partial differential equations for 3 components of the displacement at points inside the domain, and 3 conditions at each boundary point. This is therefore a closed set of equations, and in general it has smooth solutions (away from corners and other nasty boundary points). Unlike the Navier-Stokes equations, these equations are linear so are somewhat simpler. Even so, this is still a system of 3 coupled partial differential equations, so exact solutions are still challenging to write down in general, and numerical methods are therefore used, as we will explore.\n\n\nSpecial cases\nIt is sometimes convenient to make modelling approximations to reduce the three-dimensional system of equations. Three important cases of this are:\n\nPlane strain, in which we assume that displacements take place only in X,Y plane, and hence {\\boldsymbol{u}}= (u(X,Y),v(X,Y),0). This is used to model the interior of a specimen which is very thick in the Z direction, so that the u_3=w component doesn’t change very much in any slice of the body. In this case, we just need to consider the reduced matrix \n\\left(\n    \\begin{array}{c}\n        S_{11} \\\\ S_{22} \\\\ S_{12}\n    \\end{array}\n\\right)\n=\n\\frac{E}{(1+\\nu)(1-2\\nu)}\n\\left(\n    \\begin{array}{ccc}\n        1-\\nu & \\nu & 0 \\\\\n        \\nu & 1-\\nu & 0 \\\\\n        0 & 0 & \\frac{1-2\\nu}{2}\n    \\end{array}\n\\right)\n\\left(\n    \\begin{array}{c}\n        \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ 2\\varepsilon_{12}\n    \\end{array}\n\\right)\n\nPlane stress, in which we assume that S_{13}, S_{23} and S_{33} are zero. This is usually used to model a specimen that is very thin in the Z direction. In this case, if the top and bottom of a sheet are free, then zero traction boundary conditions mean that these components are likely to be very small. In this case, we just need to consider the reduced matrix \n\\left(\n    \\begin{array}{c}\n        S_{11} \\\\ S_{22} \\\\ S_{12}\n    \\end{array}\n\\right)\n=\n\\frac{E}{1-\\nu^2}\n\\left(\n    \\begin{array}{ccc}\n        1 & \\nu & 0 \\\\\n        \\nu & 1 & 0 \\\\\n        0 & 0 & \\frac{1-\\nu}{2}\n    \\end{array}\n\\right)\n\\left(\n    \\begin{array}{c}\n        \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ 2\\varepsilon_{12}\n    \\end{array}\n\\right).\n\nAnti-plane stress, in which we assume that the displacement only occurs in the x_3 direction, so that {\\boldsymbol{u}}=(0,0,w(X,Y)). This is typically used to model the cross-section of a long thin component, where loads are applied along the axis, such as a tube or bar. In this case, we get In this case, we just need to consider the reduced matrix \n\\left(\n    \\begin{array}{c}\n        S_{12} \\\\ S_{13}\n    \\end{array}\n\\right)\n=\nG\n\\left(\n    \\begin{array}{cc}\n        1 & 0 \\\\\n        0 & 1\n    \\end{array}\n\\right)\n\\left(\n    \\begin{array}{c}\n        2\\varepsilon_{12} \\\\ 2\\varepsilon_{13}\n    \\end{array}\n\\right).\n\n\nThere are also further ways to reduce the equations of elasticity based on the fact that we may be considering an elastic body which is thin in some dimensions; this is something we will explore further later in the module.",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Linear Elasticity Theory</span>"
    ]
  },
  {
    "objectID": "2-2-finite-elements.html",
    "href": "2-2-finite-elements.html",
    "title": "7  The Finite Element Method",
    "section": "",
    "text": "7.1 A first problem: a thin column\nAnalytical solutions for mechanics problems tend to exist only in relatively simple problems, with simple constitutive relations. To get more accurate models of real-world situations, we need to resort to numerical methods, just as we must do with fluid modelling.\nA highly successful methodology for solving the equations of solid mechanics is known as the Finite Element Method (FEM). In this chapter, we will begin introducing this framework for dealing with partial differential equations. A core part of the idea of FEM is to relax the requirement that the functions involved need to be differentiable, and work with a weak form of the equations. This is unlikely to be intuitive to you at first, but hopefully you will see the utility as we go on!\nThe general steps to derive a finite element approximation of the solution of a PDE are as follows:\nIn practice, the steps to do this are typically handled by dedicated software, but here we will focus on building understanding of the methodology by working through the derivation ourselves. This will clarify much of the terminology around finite elements, and allow us to discuss some subtleties.\nIn order to give a concrete illustration of how this method works, we will consider a simple test problem in 1D. This is simple enough that we can work out the solution analytically as a way to validate a numerical implementation.\nConsider a thin column which we think of as undergoing only small displacements in the X and Y directions, as illustrated in Figure 7.1. If the cross-section of the column is much smaller than the overall length, and displacements in the X and Y directions are small, we expect to be able to look for solutions that take the form {\\boldsymbol u}= (0,0,w(Z)). Substituting this into the elasticity equations (and do some asymptotic analysis that we skip over here), we find that w should satisfy the problem \n\\frac{\\partial}{\\partial Z}\\left(E\\frac{\\partial w}{\\partial Z}\\right)=\\rho g,\n where E is the Young’s modulus of the material, \\rho is its density and g is the acceleration due to gravity.\nTo model the set up further, we must prescribe boundary conditions. We will assume the column sits on a rigid base at Z=0, so w(0) = 0, and that the top end of the column is subject to a normal compressive stress {\\boldsymbol S}{\\boldsymbol e}_3 = -\\sigma{\\boldsymbol e}_3 with \\sigma\\geq 0. Dropping the subscripts for short, our problem is \n\\frac{d}{dZ}\\left(E\\frac{dw}{dZ}\\right)=\\rho g,\\quad w(0) = 0\\quad\\text{and}\\quad E\\frac{dw}{dZ}(L) = -\\sigma.\n\\tag{7.1} This is the full strong form of the problem; a conventional solution requires w to have 2 derivatives, and satisfying the boundary conditions at the ends.\nIn this case, we can find the solution directly. Solving analytically by integrating twice and applying the boundary conditions, we find the solution is \nw(Z)=\\frac{\\rho g}{2E}Z^2- \\frac{\\rho gL}{E}Z-\\frac{\\sigma}{E}Z.\n We can use our solution to make some meaningful predictions: the new length of the column under these conditions is given by the original length plus the displacement of the endpoint, i.e. \n\\text{New length} = L+w(L) = L \\left(1-\\frac{\\rho gL}{2E}-\\frac{\\sigma}{E}\\right).\n We see that the denser the column and the greater the load applied, the shorter the column gets, which makes intuitive sense. We can also use our solution to find the stress acting at the base, which is \n\\text{Stress acting on base} = E\\frac{dw}{dZ}(0) = -\\rho g L-\\sigma.\n The first of these terms reflects the weight of the column (mass density times gravitational field strength times volume), while the latter is the load acting on the top of the column being transmitted to the base.",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>The Finite Element Method</span>"
    ]
  },
  {
    "objectID": "2-2-finite-elements.html#a-first-problem-a-thin-column",
    "href": "2-2-finite-elements.html#a-first-problem-a-thin-column",
    "title": "7  The Finite Element Method",
    "section": "",
    "text": "Figure 7.1: A thin column loaded from above, subject to a gravitational body force.",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>The Finite Element Method</span>"
    ]
  },
  {
    "objectID": "2-2-finite-elements.html#the-weak-form",
    "href": "2-2-finite-elements.html#the-weak-form",
    "title": "7  The Finite Element Method",
    "section": "7.2 The weak form",
    "text": "7.2 The weak form\nTo proceed in our journey towards a finite element approximate solution of the mechanical problem, we next generate a weak form for Equation 7.2. The general procedure for this is to:\n\nMultiply the equation by a test function defined on the problem domain;\nIntegrate the result over the domain; and then\nUse integration by parts to move one or more derivatives from the function we are solving for onto the test function.\n\nIn the problem we are considering, we denote the test function \\phi (also called a weight function in the Engineering literature). Integrating over the domain gives \n\\int_0^L\\frac{d}{dZ}\\left(E\\frac{dw}{dZ}\\right)\\phi\\,dZ=\\int_0^L\\rho g\\phi \\,dZ.\n If we integrate by parts in the first term, on the left-hand side we obtain \n\\int_0^L\\frac{d}{dZ}\\left(E\\frac{dw}{dZ}\\right)\\phi\\,dZ = \\left[E\\frac{dw}{dZ}\\phi\\right]_{Z=0}^{Z=L}-\\int_0^LE\\frac{dw}{dZ}\\frac{d\\phi}{dZ}\\,dZ\n Substituting in the boundary condition at Z=L, and assuming that the test function satisfies \\phi(0)=0, our integral form can be rearranged to give \n\\int_0^LE\\frac{dw}{dZ}\\frac{d\\phi}{dZ}\\,dZ+\\sigma \\phi(L)+\\int_0^L\\rho g\\phi \\,dZ=0.\n\\tag{7.2} We now argue as follows: if w were a solution of the strong form Equation 7.1, then the equality we have derived must hold for any choice of test function \\phi. We can see the test function as a sort of ‘measurement’ of how well the equation is satisfied; if there was a region where the equation wasn’t satisfied, we could find \\phi to make the left-hand side of Equation 7.2 would give a non-zero result.\nThis leads us to define the concept of a weak solution for our problem. A weak solution is a function w which satisfies the integral equality Equation 7.2 for any test function \\phi satisfying \\phi(0)=0. The reason that we call this a weak solution is that we only need w to have one derivative to make sense of the integral on the left-hand side, whereas the strong form requires us to make sense of two derivatives. In fact, we assume even less: w only needs to have a derivative piecewise, so can have a finite number of points where it jumps. The way we have derived the weak form ensures that any solution to the strong form must satisfy the weak form, but the reverse need not necessarily be true.\nYou may be wondering at this stage why we required that the test function satisfies \\phi(0)=0. It turns out that this is always the right choice when we prescribe the values of the solution itself at the boundary, i.e. any Dirichlet boundary condition, but to really see why requires more context that we can currently give; ask me during a workshop if you’d like to know more.",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>The Finite Element Method</span>"
    ]
  },
  {
    "objectID": "2-2-finite-elements.html#discretisation",
    "href": "2-2-finite-elements.html#discretisation",
    "title": "7  The Finite Element Method",
    "section": "7.3 Discretisation",
    "text": "7.3 Discretisation\nSo far, it doesn’t seem that we’ve gained anything; we’ve replaced the strong form with the apparently harder to handle weak form. However, what we have gained is the ability to handle solutions that don’t have 2 derivatives. This gives us much more flexibility to discretise our solution (and to do mathematical analysis, but that’s a story for elsewhere!).\nWe now need to decide how to approximate solutions to our problem, and we’ll see that we need to approximate test functions too. There are many possible choices available to do this, including polynomials, trigonometric functions, and many more. All can be used to construct approximate solutions in the way we do so below, however the term ‘finite elements’ typically refers to the case where we approximate solutions piecewise polynomial functions.\nLet’s consider writing an approximate solution (which we call w^h) as a linear combination of functions, so \nw^h(Z) = \\sum_{i=1}^M d_i N_i(Z).\n The functions N_i(Z) are going to be (piecewise) polynomials called shape functions. The coefficients d_i are unknown constants we call the degrees of freedom (DoFs). We can use matrix notation to express this relationship: \nw^h(Z) = {\\boldsymbol N}(Z){\\boldsymbol d}\\quad\\text{where}\\quad\n  {\\boldsymbol N}(Z)=\n  \\left(\n    \\begin{array}{ccc}\n      N_1(Z) & \\cdots & N_M(Z)\n    \\end{array}\n  \\right)\n  \\quad\\text{and}\\quad\n  {\\boldsymbol d}=\\left(\n    \\begin{array}{c}\n      d_1 \\\\ \\vdots \\\\ d_M\n    \\end{array}\n  \\right).\n We can find the derivative of w^h by evaluating \n\\frac{dw^h}{dZ}(Z) = {\\boldsymbol B}(Z){\\boldsymbol d},\\quad\\text{where}\\quad\n{\\boldsymbol B}(Z):=\\frac{d{\\boldsymbol N}}{dZ}(Z)=\n\\left(\n    \\begin{array}{ccc}\n        \\frac{dN_1}{dZ} & \\cdots & \\frac{dN_M}{dZ}\n    \\end{array}\n\\right).\n This formula is valid as the vector of coefficients {\\boldsymbol d} doesn’t depend on Z.\nIf test functions \\phi are approximated in the same ways as w (this is known as a Galerkin approximation), then we define \n\\phi^h(Z) =\n{\\boldsymbol N}(Z){\\boldsymbol \\phi}\n\\quad\\text{where}\\quad\n{\\boldsymbol \\phi}=\n\\left(\n    \\begin{array}{c}\n          \\phi_1 \\\\ \\vdots \\\\ \\phi_M\n    \\end{array}\n\\right).\n Going back to the weak form Equation 7.2, let’s replace w and \\phi by the approximations w^h and \\phi^h, giving \n\\int_0^LE\n\\underbrace{\\frac{d{\\boldsymbol N}}{dZ}{\\boldsymbol d}}_{\\displaystyle\\frac{dw^h}{dZ}}\\,\n\\underbrace{\\frac{d{\\boldsymbol N}}{dZ}{\\boldsymbol \\phi}}_{\\displaystyle\\frac{d\\phi^h}{dZ}}\\,dZ\n+\\sigma \\underbrace{\\vphantom{\\frac{d{\\boldsymbol N}}{dZ}{\\boldsymbol d}}{\\boldsymbol N}(L){\\boldsymbol \\phi}}_{\\displaystyle \\phi^h(L)}+\\int_0^L\\rho g\\underbrace{\\vphantom{\\frac{d{\\boldsymbol N}}{dZ}{\\boldsymbol d}}{\\boldsymbol N}{\\boldsymbol \\phi}}_{\\displaystyle \\phi^h} \\,dZ=0.\n Since {\\boldsymbol N}{\\boldsymbol \\phi} and {\\boldsymbol B}{\\boldsymbol \\phi} are scalars, we have {\\boldsymbol N}{\\boldsymbol \\phi}= {\\boldsymbol \\phi}^T{\\boldsymbol N}^T and {\\boldsymbol B}{\\boldsymbol \\phi}= {\\boldsymbol \\phi}^T{\\boldsymbol B}^T. We can use the latter result to write the integral on the right hand side as: \n\\int_0^LE{\\boldsymbol B}{\\boldsymbol d}{\\boldsymbol B}{\\boldsymbol \\phi}\\,dZ = {\\boldsymbol \\phi}^T\\left(\\int_0^LE{\\boldsymbol B}^T{\\boldsymbol B}\\,dZ\\right){\\boldsymbol d}.\n The bracketed term on the right is a matrix, called the stiffness matrix, often denoted {\\boldsymbol K}. It has entries: \nK_{ij} = \\int_0^LE\\frac{dN_i}{dZ}\\frac{dN_j}{dZ}\\,dZ.\n Note that {\\boldsymbol K} is symmetric, so {\\boldsymbol K}= {\\boldsymbol K}^T. Introducing the column vector \n{\\boldsymbol f}:= \\sigma {\\boldsymbol N}(L)^T + \\int_0^L \\rho g {\\boldsymbol N}^T\\,dZ,\n we can write the approximate weak form as \n{\\boldsymbol \\phi}^T{\\boldsymbol K}{\\boldsymbol d}+ {\\boldsymbol \\phi}^T{\\boldsymbol f}={\\boldsymbol \\phi}^T({\\boldsymbol K}{\\boldsymbol d}+{\\boldsymbol f})=0.\n\\tag{7.3} If we want the approximate weak form to hold for all approximate solutions, then Equation 7.3 has to hold for all vectors {\\boldsymbol \\phi}, and that means that {\\boldsymbol d} is the vector which solves the equation {\\boldsymbol K}{\\boldsymbol d}+{\\boldsymbol f}=\\boldsymbol{0}, which we can solve (if we know {\\boldsymbol K} and {\\boldsymbol f}!) using a linear solve.\nNote that just as for the finite difference methods we thought about in the Fluids part of the module, we end up needing to solve a linear system of equations where {\\boldsymbol f} encodes both the forces acting in the domain and aspects of the boundary conditions!\n\nChoosing shape functions\nThe abstract work we did above didn’t need us to make any particular choice of shape function, but now we need to make a choice to put the methodology into practice. The usual choice for FEM in particular is to split the domain into elements which are subvolumes of the domain. For example, we could split the domain [0,L] into 3 equal pieces, the intervals (0,\\frac13L), (\\frac13L,\\frac23L), and (\\frac23L,L), as shown in Figure 7.2. Then, we choose a polynomial order on each interval. If we choose first-order or piecewise linear elements, then we have that each shape function is \nN_i(Z) = a_0+a_1Z,\n where the constants a_0 and a_1 will depend on which element we are on. To specify the shape functions further, we make two requirements:\n\nAt the end-points of the elements, Z_k = \\frac{k}{3}L, the shape functions are continuous.\nThe shape functions have the interpolation or Kronecker delta property, which is the requirement that \n  N_i(Z_k)\n  = \\delta_{ik}\n  =\n  \\begin{cases}\n1 & i=k\\\\\n0 & i\\neq k.\n  \\end{cases}\n  \n\nThese choices lead us to define 4 shape functions (for convenience, we define h = L/3): \n\\begin{aligned}\n    N_0(Z) &=\n    \\begin{cases}\n        1-\\frac{Z}{h} & 0\\leq Z\\leq h\\\\\n        0 & \\text{otherwise},\n    \\end{cases}\n    &\n    N_1(Z) &=\n    \\begin{cases}\n        \\frac{Z}{h} & 0 \\leq Z\\leq h\\\\\n        2-\\frac{Z}{h} & h \\leq Z\\leq 2h\\\\\n        0 & \\text{otherwise},\n    \\end{cases}\\\\\n    N_2(Z) &=\n    \\begin{cases}\n        \\frac{Z}{h}-1 & h \\leq Z\\leq 2h\\\\\n        3-\\frac{Z}{h} & 2h \\leq Z\\leq 3h\\\\\n        0 & \\text{otherwise},\n    \\end{cases}&\n    N_3(Z) &=\n    \\begin{cases}\n        \\frac{Z}{h}-2 & 2h \\leq Z \\leq 3h\\\\\n        0 & \\text{otherwise}.\n    \\end{cases}\n\\end{aligned}\n These functions are illustrated in Figure 7.2.\n\n\n\n\n\n\nFigure 7.2: The spatial grid with the 3 piecewise linear shape functions. Note the overlapping regions where adjacent basis functions are non-zero.\n\n\n\nIn this case, the derivatives are: \n\\begin{aligned}\n    \\frac{dN_0}{dZ}(Z) &=\n    \\begin{cases}\n        -\\frac{1}{h} & 0\\leq Z\\leq h\\\\\n        0 & \\text{otherwise},\n    \\end{cases}\n    &\\frac{dN_1}{dZ}(Z) &=\n    \\begin{cases}\n        \\frac{1}{h} & 0 \\leq Z\\leq h\\\\\n        -\\frac{1}{h} & h \\leq Z\\leq 2h\\\\\n        0 & \\text{otherwise},\n    \\end{cases}\\\\\n    \\frac{dN_2}{dZ}(Z) &=\n    \\begin{cases}\n        \\frac{1}{h} & h \\leq Z\\leq 2h\\\\\n        -\\frac{1}{h} & 2h \\leq Z\\leq 3h\\\\\n        0 & \\text{otherwise},\n    \\end{cases}&\n    \\frac{dN_3}{dZ}(Z) &= \\begin{cases}\n        \\frac{1}{h} & 2h \\leq Z \\leq 3h\\\\\n        0 & \\text{otherwise}.\n    \\end{cases}\n\\end{aligned}\n\nBefore proceeding, we note that there is one shape function we won’t need. Recall that we want w(0)=0 and \\phi(0)=0. In order to enforce this conditions, we can simply discard any entries involving N_0 (setting d_0=0 and \\phi_0=0), as this is the only shape function that is non-zero at the end.\nTo assemble the stiffness matrix, {\\boldsymbol K}, we now need to compute \nK_{ij} = \\int_0^L E\\frac{dN_i}{dZ}\\frac{dN_j}{dZ}\\,dZ.\n Let’s do an example for the case where i=j=2, so we compute entry K_{22}. In this case, we need to compute \n\\begin{aligned}\n    K_{22} = \\int_0^L E\\left(\\frac{dN_2}{dZ}\\right)^2\\,dZ\n    &= \\int_h^{2h}E\\frac{1}{h^2}\\,dZ+\\int_{2h}^{3h} E\\left(-\\frac{1}{h}\\right)^2\\,dZ\\\\\n    &=\\frac{E}{h}+\\frac{E}{h} = \\frac{2E}{h}.\n\\end{aligned}\n On the first line, we note that the integral over the interval (0,h) is zero, so we discard it. In general, we only need to compute the integrals on the elements where the regions where the shape functions have non-zero derivative (the fancy maths word for this is the support of the shape function).\nBy carefully splitting up the domain and working through the cases, you can check that \n{\\boldsymbol K}=\n\\frac{E}{h}\\left(\n\\begin{array}{rrr}\n    2 & -1 & 0 \\\\\n    -1 &  2 & -1 \\\\\n    0 & -1  & 1\n\\end{array}\n\\right).\n The K_{22} entry is the central one in the matrix (K_{ij} is the entry in the ith row and jth column). To find the vector {\\boldsymbol f}, we need to evaluate the shape functions and calculate more integrals. In this case, \n\\sigma {\\boldsymbol N}^T(L) = \\sigma\n  \\left(\n    \\begin{array}{c}\n      0 \\\\ 0 \\\\ 1\n    \\end{array}\n  \\right),\\qquad\\text{and}\\qquad \\rho g\\int_0^L{\\boldsymbol N}^TdZ = \\rho g h\n  \\left(\n    \\begin{array}{c}\n      1 \\\\ 1 \\\\ \\frac12\n    \\end{array}\n  \\right).\n Putting everything together and rearranging, we find we must solve \n\\frac{E}{h}\\left(\n    \\begin{array}{rrr}\n      2 & -1 & 0 \\\\\n     -1 &  2 & -1 \\\\\n      0 & -1  & 1\n    \\end{array}\n  \\right)\\left(\n    \\begin{array}{c}\n      d_1 \\\\ d_2 \\\\ d_3\n    \\end{array}\n  \\right)\n  =-\\left(\n    \\begin{array}{c}\n      \\rho g h \\\\ \\rho g h \\\\ \\frac12\\rho g h + \\sigma\n    \\end{array}\n  \\right).\n\\tag{7.4} If we solve and append the d_0=0 degree of freedom which we discarded, we see we get incredibly close agreement with the analytic solution; see Figure 7.3.\n\n\n\n\n\n\nFigure 7.3: Comparison of the analytic solution (dashed) and the finite element solution (solid) for the column problem with 3 elements. The values of the approximate solution at the nodes are shown with plus signs. Parameters for stainless steel were used, with an applied load of \\sigma=50kPa. Given how stiff steel is, the displacement is very small, fractions of a micrometre!",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>The Finite Element Method</span>"
    ]
  },
  {
    "objectID": "2-2-finite-elements.html#improving-our-approximation",
    "href": "2-2-finite-elements.html#improving-our-approximation",
    "title": "7  The Finite Element Method",
    "section": "7.4 Improving our approximation",
    "text": "7.4 Improving our approximation\nOur derivation here is obviously not limited to dividing the domain into 3 elements: in 1D, if we choose to divide the domain into M elements, we get M+1 piecewise linear shape functions. If we make the elements smaller, we expect to get a better approximation to the true solution: indeed, this is something we will discuss later on in the module. We will see that when things are working correctly, the error in our solution is controlled by h, the size of the largest element used. An important thing to note is that in general, the elements do not all have to be the same size; indeed, this will be an important consideration in the chapters to come! Even in the case we have considered here, we could freely split the domain into other sets of three parts; for example we could set Z_1=\\tfrac12 and Z_2=\\tfrac34, which would result in different shape functions.\nInstead of dividing the domain into more elements, another option to get better agreement with the solution is to increase the polynomial order of the shape functions, for example by setting \nN_i(Z) = a_0+a_1Z+a_2Z^2\n on each element. In this case, continuity and the Kronecker delta property for the endpoints of the elements are not enough on their own to define the shape functions uniquely. Instead, we need to add extra nodes to each element. The usual choice for quadratic functions is to add an extra node in the middle of each element. A plot of the resulting shape functions is shown in Figure 7.4; you will be asked to find the form of these (on a single element) in this week’s workshop. You could go even further, using cubics, quartics or even higher order polynomials, but you would need to add more nodes.\n\n\n\n\n\n\nFigure 7.4: A plots of the quadratic shape functions on domain made up of two elements. One element covers the interval (Z_0,Z_2), the other covers the interval (Z_2,Z_4). Note that Z_1 and Z_3 are extra nodes added to the centre of the element.\n\n\n\nNote that the problem we end up with to solve, Equation 7.4, looks very similar to the way we discretised a second-order problem with finite differences, even if the philosophy that we used to get to it is rather different. Indeed, you might ask what we have gained by doing all of the work here, and for this particular problem, we have gained very little! However, we will see in later chapters is that the finite element approach is more flexible, particularly when it comes to problems in higher dimensions. Moreover, the philosophy introduced here, while seeming cumbersome at the moment, can be very effectively generalised and automated in software.",
    "crumbs": [
      "Solids",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>The Finite Element Method</span>"
    ]
  }
]