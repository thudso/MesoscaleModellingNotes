<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Lubrication and Thin Film Dynamics – PX912 Continuum and Mesoscale Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./1-4-free-surfaces.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b7c2d8834e08b04a63bb76a724ffbcac.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-c1966a8c70583a3816b1e3a216c1caf1.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1-0-fluids.html">Fluids</a></li><li class="breadcrumb-item"><a href="./1-5-thin-films.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lubrication and Thin Film Dynamics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PX912 Continuum and Mesoscale Modelling</a> 
        <div class="sidebar-tools-main">
    <a href="./PX912-Continuum-and-Mesoscale-Modelling.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./1-0-fluids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fluids</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-1-macro-fluids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Macroscopic Modelling of Fluids</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-2-equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Governing Equations of Fluid Dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-3-canonical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Canonical Flows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-4-free-surfaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Free Surface Flows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-5-thin-films.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lubrication and Thin Film Dynamics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-lubrication-equation" id="toc-the-lubrication-equation" class="nav-link active" data-scroll-target="#the-lubrication-equation"><span class="header-section-number">5.1</span> The Lubrication Equation</a>
  <ul class="collapse">
  <li><a href="#non-dimensionalisation" id="toc-non-dimensionalisation" class="nav-link" data-scroll-target="#non-dimensionalisation">Non-Dimensionalisation</a></li>
  <li><a href="#lubrication-approximation" id="toc-lubrication-approximation" class="nav-link" data-scroll-target="#lubrication-approximation">Lubrication Approximation</a></li>
  <li><a href="#reynolds-lubrication-equation" id="toc-reynolds-lubrication-equation" class="nav-link" data-scroll-target="#reynolds-lubrication-equation">Reynolds’ Lubrication Equation</a></li>
  <li><a href="#example-slider-bearing" id="toc-example-slider-bearing" class="nav-link" data-scroll-target="#example-slider-bearing">Example: Slider Bearing</a></li>
  </ul></li>
  <li><a href="#thin-film-equations" id="toc-thin-film-equations" class="nav-link" data-scroll-target="#thin-film-equations"><span class="header-section-number">5.2</span> Thin Film Equations</a>
  <ul class="collapse">
  <li><a href="#free-surface-boundary-conditions-under-lubrication-approximation" id="toc-free-surface-boundary-conditions-under-lubrication-approximation" class="nav-link" data-scroll-target="#free-surface-boundary-conditions-under-lubrication-approximation">Free Surface Boundary Conditions Under Lubrication Approximation</a></li>
  <li><a href="#thin-film-equations-1" id="toc-thin-film-equations-1" class="nav-link" data-scroll-target="#thin-film-equations-1">Thin Film Equations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1-0-fluids.html">Fluids</a></li><li class="breadcrumb-item"><a href="./1-5-thin-films.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lubrication and Thin Film Dynamics</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-flu-thin-films" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lubrication and Thin Film Dynamics</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">

</div>
<p>In this chapter we consider situations in which the flow domain is long and thin, leading to so–called ‘lubrication flows’. These are routinely observed in industry (e.g.&nbsp;via coatings applied to almost all products we own, such as mobile phones), nature (e.g.&nbsp;avalanches or ice sheet dynamics), agriculture (e.g.&nbsp;in crop spraying), DIY (when we apply paints to a wall) and biology (e.g.&nbsp;tear film on the eye or coatings within the body). Such flows can produce remarkably complex behaviour.</p>
<p>From a mathematical modelling perspective, the geometry of the flow will allow us to make significant simplifications to the full system of Navier-Stokes equations, firstly for the case of a fluid trapped between two solid surfaces, and secondly for the case of a liquid film on a solid surface, where the free surface boundary conditions add even further complexity. This chapter will bring together many of the aspects from the earlier ones and also introduce further techniques of applied mathematics, namely non-dimensionalisation (done in full detail now!) and a brief look at asymptotic techniques.</p>
<section id="the-lubrication-equation" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="the-lubrication-equation"><span class="header-section-number">5.1</span> The Lubrication Equation</h2>
<p>We begin by considerind the two-dimensional incompressible Navier-Stokes equations in Cartesian coordinates, with gravitational acceleration pointing in the negative <span class="math inline">y</span>-direction: <span class="math display">
\begin{aligned}
\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y} &amp;= 0, \\
\rho\left(\frac{\partial u}{\partial t} + u\frac{\partial u}{\partial x} + v\frac{\partial u}{\partial y} \right)&amp;= -\frac{\partial p}{\partial x} + \mu\left(\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}\right), \\
\rho\left(\frac{\partial v}{\partial t} + u\frac{\partial v}{\partial x} + v\frac{\partial v}{\partial y}\right) &amp;= -\frac{\partial p}{\partial y} + \mu\left(\frac{\partial^2 v}{\partial x^2} + \frac{\partial^2 v}{\partial y^2}\right) - \rho g.
\end{aligned}
</span></p>
<section id="non-dimensionalisation" class="level3">
<h3 class="anchored" data-anchor-id="non-dimensionalisation">Non-Dimensionalisation</h3>
<p>Now, we consider characteristic scales for all the quantities involved in the equations above: velocity components <span class="math inline">U</span>, pressure <span class="math inline">P</span>, length <span class="math inline">L</span> and time <span class="math inline">T=L/U</span>. It is possible that the characteristic time scale may be set by something else, e.g.&nbsp;the frequency of an oscillating body, but here we will consider the simplest case where it is related to the length and velocity scales. Furthermore, let us consider different scales for lengths and velocities in the <span class="math inline">x</span>-direction and <span class="math inline">y</span>-direction which will be important for allowing us to simplify our equations based on the geometry of the flow domain. Because we are looking at thin films, we expect the domain to be long and thin, so we let the characteristic length in the <span class="math inline">x</span>-direction be <span class="math inline">L_x=L</span> and the characteristic one in the <span class="math inline">y</span>-direction be <span class="math inline">L_y=\varepsilon L</span>, where <span class="math inline">\varepsilon</span> is a (dimensionless) number which gives the aspect ratio <span class="math inline">L_x/L_y</span> of our geometry. We will later exploit the fact that <span class="math inline">\varepsilon\ll 1</span> to simplify our problem. Similarly, we expect a scale separation in the velocities, and the corresponding choices are <span class="math inline">U_x=U</span> and <span class="math inline">U_y=\varepsilon U</span>. See <a href="#fig-thin-film-geometry" class="quarto-xref">Figure&nbsp;<span>5.1</span></a> for an example.</p>
<div id="fig-thin-film-geometry" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-thin-film-geometry-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tikz/ThinFilm.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-thin-film-geometry-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Characteristic geometry for a lubrication flow.
</figcaption>
</figure>
</div>
<p>We use these scales to represent all variables in terms of their characteristic size multiplied by a dimensionless variable. By definition, the dimensionless variables must have characteristic ‘size’ <span class="math inline">\sim 1</span>. In doing so, we are able to establish the size of different terms and thus work out which are negligible. We consider <span class="math display">
x=L\tilde{x},\qquad y=\varepsilon L\tilde{y},\qquad  u=U\tilde{u},\qquad v=\varepsilon U\tilde{v},\qquad p=P\tilde{p}
</span> and substituting these into the Navier-Stokes equations gives <span class="math display">
\begin{aligned}
\frac{U}{L}\frac{\partial \tilde{u}}{\partial \tilde{x}}+\frac{U}{L}\frac{\partial \tilde{v}}{\partial \tilde{y}} &amp;= 0, \\
\frac{\rho U^2}{L}\left(\frac{\partial\tilde{u}}{\partial \tilde{t}} + \tilde{u}\frac{\partial \tilde{u}}{\partial \tilde{x}} + \tilde{v}\frac{\partial \tilde{u}}{\partial \tilde{y}}\right) &amp;= -\frac{P}{L}\frac{\partial \tilde{p}}{\partial \tilde{x}} + \frac{\mu U}{L^2}\left(\frac{\partial^2 \tilde{u}}{\partial \tilde{x}^2} + \frac{1}{\varepsilon^2} \frac{\partial^2 \tilde{u}}{\partial \tilde{y}^2}\right), \\
\frac{\varepsilon \rho U^2}{L}\left(\frac{\partial \tilde{v}}{\partial \tilde{t}} + \tilde{u}\frac{\partial \tilde{v}}{\partial \tilde{x}} + \tilde{v}\frac{\partial \tilde{v}}{\partial \tilde{y}}\right) &amp;= -\frac{P}{\varepsilon L}\frac{\partial \tilde{p}}{\partial \tilde{y}} + \frac{\varepsilon \mu U}{L^2}\left(\frac{\partial^2 \tilde{v}}{\partial \tilde{x}^2} + \frac{1}{\varepsilon}\frac{\partial^2 \tilde{v}}{\partial \tilde{y}^2}\right) - \rho g.
\end{aligned}
</span> from which we can see that a good scale for the pressure would be <span class="math inline">\frac{P}{L} =  \frac{\mu U}{\varepsilon^2 L^2}</span> which would ensure that pressure term <span class="math inline">\frac{P}{L}\frac{\partial \tilde{p}}{\partial \tilde{x}}</span> is comparable with the (dominant as <span class="math inline">\varepsilon \to 0</span>) viscous term <span class="math inline">\frac{\mu U}{L^2 \varepsilon^2}\frac{\partial^2 \tilde{u}}{\partial \tilde{y}^2}</span> which we have already seen drives Poiseuille flow. Making this choice and rearranging gives <span class="math display">
\begin{aligned}
\frac{\partial \tilde{u}}{\partial \tilde{x}}+\frac{\partial \tilde{v}}{\partial \tilde{y}} &amp;= 0, \\
\varepsilon^2 \mathrm{Re}\left(\frac{\partial\tilde{u}}{\partial \tilde{t}} + \tilde{u}\frac{\partial \tilde{u}}{\partial \tilde{x}} + \tilde{v}\frac{\partial \tilde{u}}{\partial \tilde{y}}\right) &amp;= -\frac{\partial \tilde{p}}{\partial \tilde{x}} + \varepsilon^2\frac{\partial^2 \tilde{u}}{\partial \tilde{x}^2} +\frac{\partial^2 \tilde{u}}{\partial \tilde{y}^2}, \\
\varepsilon^4 \mathrm{Re}\left(\frac{\partial \tilde{v}}{\partial \tilde{t}} + \tilde{u}\frac{\partial \tilde{v}}{\partial \tilde{x}} + \tilde{v}\frac{\partial \tilde{v}}{\partial \tilde{y}}\right) &amp;= -\frac{\partial \tilde{p}}{\partial \tilde{y}} + \varepsilon^4\frac{\partial^2 \tilde{v}}{\partial \tilde{x}^2} + \varepsilon^2\frac{\partial^2 \tilde{v}}{\partial \tilde{y}^2} - \varepsilon^3 \mathrm{St},
\end{aligned}
</span> where we have recognised the Reynolds number <span class="math inline">\mathrm{Re}=\frac{\rho U L}{\mu}</span> and we introduce a new dimensionless number, the Stokes number <span class="math inline">\mathrm{St}=\frac{\rho gL^2}{\mu U}</span>. The latter number describes the ratio between gravitational and viscous forces.</p>
</section>
<section id="lubrication-approximation" class="level3">
<h3 class="anchored" data-anchor-id="lubrication-approximation">Lubrication Approximation</h3>
<p>Setting <span class="math inline">\varepsilon=1</span> at this stage would give us the dimensionless Navier-Stokes equations for the case in which the characteristic dimensions are roughly the same in all directions. We could then decide whether or not the inertial terms are negligible or not by calculating <span class="math inline">\mathrm{Re}</span>, as we did before. However, this time we want to use the fact that <span class="math inline">\varepsilon \ll 1</span> to simplify our equations. Assume further that <span class="math inline">\varepsilon^2 \mathrm{Re}\ll 1</span> and <span class="math inline">\varepsilon^3 \mathrm{St}\ll1</span>. This does not meean that <span class="math inline">\mathrm{Re}</span> or <span class="math inline">\mathrm{St}</span> are small themselves, just that they are not too big when compared to the aspect ratio of the domain. We then simply ignore all terms multiplied by <span class="math inline">\varepsilon</span> (and higher powers, which are even smaller) to obtain: <span id="eq-incom"><span class="math display">
\frac{\partial \tilde{u}}{\partial \tilde{x}}+\frac{\partial \tilde{v}}{\partial \tilde{y}}= 0,
\tag{5.1}</span></span> <span id="eq-xmom"><span class="math display">
0 = -\frac{\partial \tilde{p}}{\partial \tilde{x}} +\frac{\partial^2 \tilde{u}}{\partial \tilde{y}^2},
\tag{5.2}</span></span> <span id="eq-ymom"><span class="math display">
0 = -\frac{\partial \tilde{p}}{\partial \tilde{y}},
\tag{5.3}</span></span> which is a huge simplification on the full system above. Strictly speaking, we could use regular asymptotics and take the leading order terms, but for this situation the result would be the same. Asymptotic expansions work by writing the dependent variables as a power series (usually) in the small variable, e.g. <span class="math inline">\tilde{u}=\tilde{u}_0 + \varepsilon\tilde{u}_1+\varepsilon^2\tilde{u}_2+...</span>, which allows one to keep track of the size of each term in the equations. However, this is only necessary here if we take a second term in the expansion, e.g.&nbsp;consider the equations for <span class="math inline">\tilde{u}_1</span>, which we will not be doing. Notice that all the inertial terms are gone (the time derivatives and convective terms on the left-hand side of second and third equations), as is the gravitational force. What remains is the equation of incompressibility, the pressure gradients and a viscous terms associated with gradients of <span class="math inline">u</span> with respect to <span class="math inline">y</span>, as we also saw for plane-parallel shear flows (i.e.&nbsp;Couette and Poiseuille flow). The assumption <span class="math inline">\varepsilon \ll 1</span> is known as the lubrication approximation, for reasons that will become apparent.</p>
</section>
<section id="reynolds-lubrication-equation" class="level3">
<h3 class="anchored" data-anchor-id="reynolds-lubrication-equation">Reynolds’ Lubrication Equation</h3>
<p>Consider now a particular situation, in which a fluid is trapped between rigid solid boundaries: one at <span class="math inline">\tilde{y}=0</span>, which moves parallel to itself with speed <span class="math inline">\tilde{u}=\tilde{U}_b</span>, and the other one at <span class="math inline">\tilde{y}=\tilde{h}(\tilde{x},\tilde{t})</span> (i.e.&nbsp;the solid top is not necessarily flat and can move in time). Clearly it is natural to scale <span class="math inline">h</span> with <span class="math inline">L_y</span> so that <span class="math inline">h = \varepsilon L \tilde{h}</span>. This is the typical setup for lubrication problems - e.g.&nbsp;for a slider bearing where solid parts ‘slip’ past each other due to a thin lubricating layer of liquid (see example below). In this case, our boundary conditions become no-slip <span class="math display">
\begin{aligned}
\tilde{u}&amp;=\tilde{U}_b,&amp;\tilde{v}&amp;=0 &amp;\qquad&amp;\text{at} &amp;\tilde{y}&amp;=0 \\
\tilde{u}&amp;=0,&amp; \tilde{v}&amp;=\frac{\partial \tilde{h}}{\partial \tilde{t}} &amp;\qquad&amp;\text{at} &amp;\tilde{y}&amp;=\tilde{h}(\tilde{x},\tilde{t})
\end{aligned}
</span> where, for simplicity, we have assumed that the solid at <span class="math inline">\tilde{y}=\tilde{h}</span> only moves vertically.</p>
<p>We start by integrating the incompressibility equation <a href="#eq-incom" class="quarto-xref">Equation&nbsp;<span>5.1</span></a> ‘across the channel’, i.e.&nbsp;in the <span class="math inline">y</span>-direction, to give <span class="math display">
0 = \int^{\tilde{h}(\tilde{x},\tilde{t})}_{0}  \left(\frac{\partial \tilde{u}}{\partial \tilde{x}}+\frac{\partial \tilde{v}}{\partial \tilde{y}}\right) d\tilde{y} = \frac{\partial}{\partial \tilde{x}}\left(\int^{\tilde{h}(\tilde{x},\tilde{t})}_0 \tilde{u} d\tilde{y}\right) - \left.\tilde{u}\frac{\partial \tilde{h}}{\partial \tilde{x}}\right|_{\tilde{y}=\tilde{h}(\tilde{x},\tilde{t})} + \left[\tilde{v}\right]^{\tilde{y}=\tilde{h}(\tilde{x},\tilde{t})}_{\tilde{y}=0}
</span> where to bring the derivative out of the integral we have used Leibniz’s rule (see the corresponding <a href="https://en.wikipedia.org/wiki/Leibniz_integral_rule">Wikipedia article</a>), where care must be taken when the limits of integration are themselves functions. Applying our boundary conditions for <span class="math inline">\tilde{u}</span> and <span class="math inline">\tilde{v}</span> we obtain <span id="eq-evo"><span class="math display">
\frac{\partial \tilde{h}}{\partial \tilde{t}} + \frac{\partial (\tilde{h}\bar{\tilde{u}}) }{\partial \tilde{x}}=0
\tag{5.4}</span></span> where we have introduced the mean velocity across the channel (i.e. ‘depth-wise averaged velocity’) <span id="eq-uav"><span class="math display">
\bar{\tilde{u}} = \frac{1}{\tilde{h}} \int^{\tilde{h}(\tilde{x},\tilde{t})}_0 \tilde{u} d\tilde{y}.
\tag{5.5}</span></span></p>
<p>Next, to obtain an expression for <span class="math inline">\bar{\tilde{u}}</span> we must integrate the momentum equations. From the <span class="math inline">y</span>-momentum equation <a href="#eq-ymom" class="quarto-xref">Equation&nbsp;<span>5.3</span></a> we find that <span class="math inline">\tilde{p} = \tilde{p}(\tilde{x},\tilde{t})</span>, i.e.&nbsp;the pressure does not change across the channel at a given <span class="math inline">\tilde{x}</span>, so we can integrate the <span class="math inline">x</span>-momentum equation <a href="#eq-xmom" class="quarto-xref">Equation&nbsp;<span>5.2</span></a> across the channel in <span class="math inline">\tilde{y}</span> to obtain <span class="math display">
\tilde{u}(\tilde{x},\tilde{t}) = \frac{\tilde{y}^2}{2}\frac{\partial \tilde{p}}{\partial \tilde{x}}  + A(\tilde{x},\tilde{t}) \tilde{y} + B(\tilde{x},\tilde{t})
</span> where <span class="math inline">A</span> and <span class="math inline">B</span> are arbitrary functions appearing after partial integration in <span class="math inline">\tilde{y}</span>. Applying the no-slip boundary conditions gives <span class="math display">
\tilde{u}(\tilde{x},\tilde{t}) = -\frac{1}{2}\frac{\partial \tilde{p}}{\partial \tilde{x}} \tilde{y}(\tilde{h}-\tilde{y}) + \tilde{U}_b\left(1-\frac{\tilde{y}}{\tilde{h}}\right)
</span> from which we can clearly identify a Poiseuille component driven by the pressure gradient (first term on the right-hand side) and a Couette flow component (second term) driven by the motion of the bottom boundary. Integrating this expression in <span class="math inline">y</span> across the channel gives <span class="math display">
\bar{\tilde{u}} = -\frac{\tilde{h}^2}{12}\frac{\partial \tilde{p}}{\partial \tilde{x}} + \frac{\tilde{U}_b}{2}.
</span> Substituting the resulting expressions back into <a href="#eq-evo" class="quarto-xref">Equation&nbsp;<span>5.4</span></a> gives Reynolds’ equation <span id="eq-reynolds"><span class="math display">
\frac{\partial \tilde{h}}{\partial \tilde{t}} +\frac{\tilde{U}_b}{2} \frac{\partial \tilde{h}}{\partial \tilde{x}}= \frac{\partial}{\partial \tilde{x}}\left( \frac{\tilde{h}^3}{12}\frac{\partial \tilde{p}}{\partial \tilde{x}}\right),
\tag{5.6}</span></span> which in dimensional variables would give us <span class="math display">
\mu\frac{\partial h}{\partial t} +\frac{\mu U_b}{2} \frac{\partial h}{\partial x}= \frac{\partial}{\partial x}\left( \frac{h^3}{12}\frac{\partial p}{\partial x}\right).
</span> Note that this is an equation for the unknown pressure <span class="math inline">p=p(x,t)</span>, as the film thickness <span class="math inline">h</span> is assumed to be prescribed in this case.</p>
</section>
<section id="example-slider-bearing" class="level3">
<h3 class="anchored" data-anchor-id="example-slider-bearing">Example: Slider Bearing</h3>
<p>A classical case for demonstrating the power of lubrication is to consider the slider bearing <a href="#fig-slider" class="quarto-xref">Figure&nbsp;<span>5.2</span></a> which works by forcing liquid (of viscosity <span class="math inline">\mu</span>) into a converging channel in order to support loads and reduce wear associated with solid-on-solid contacts.</p>
<p>Consider a solid boundary at <span class="math inline">y=h(x)</span> and sit in a frame of reference in which the top boundary is stationary and the bottom boundary moves with speed <span class="math inline">U_b</span>. To make things a little more specific, we consider the region <span class="math inline">0\le x\le L_x</span> the top boundary at <span class="math inline">h(x) = L_y - \varepsilon^2 m x</span>, where we have chosen the gradient of the slope to scale with <span class="math inline">\varepsilon^2</span> to represent a small change in height across the domain which also ensures the top boundary never touches the bottom one. Outside the lubrication region we assume the pressure takes its atmospheric value <span class="math inline">p_{\text{atm}}</span> and to simplify matters we shift the pressure <span class="math inline">p\to p+p_{\text{atm}}</span>, taking it relative to the value <span class="math inline">p_{\text{atm}}</span> so that <span class="math inline">p(0)=p(L_x)=0</span>.</p>
<div id="fig-slider" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slider-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tikz/SliderBearing.svg" style="height:5cm" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slider-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Geometry for a slider bearing.
</figcaption>
</figure>
</div>
<p>Sensible characteristic scales for our problem are then <span class="math inline">U_b</span> (so that <span class="math inline">\tilde{U}_b=1</span>), <span class="math inline">L_x</span> and <span class="math inline">L_y</span> so our dimensionless problem, which is steady, is <span class="math display">
\frac{1}{2} \frac{d \tilde{h}}{d\tilde{x}}= \frac{d}{d\tilde{x}}\left( \frac{\tilde{h}^3}{12}\frac{d\tilde{p}}{d\tilde{x}}\right)
</span> subject to <span class="math inline">\tilde{p}(0)=\tilde{p}(1)=0</span> and with <span class="math inline">\tilde{h}(\tilde{x}) = 1- \varepsilon m \tilde{x}</span>. Full derivatives our now used as <span class="math inline">\tilde{p}</span> is a function of <span class="math inline">\tilde{x}</span> only. Integrating, we obtain <span class="math display">
\frac{d \tilde{p}}{d\tilde{x}}=\frac{6(\tilde{h}-\tilde{h}_0)}{\tilde{h}^3}\qquad\hbox{where } \tilde{h}_0 \hbox{ is a constant},
</span> and integrating again we find <span class="math display">
\tilde{p}(\tilde{x})=\int_0^{\tilde{x}} \frac{6(\tilde{h}(\tilde{s})-\tilde{h}_0)}{\tilde{h}(s)^3} d\tilde{s}
</span> where <span class="math inline">\tilde{s}</span> is a dummy integration variable. The result (check this yourself) for our particular geometry is <span class="math display">
\tilde{p}(\tilde{x}) = 6\left[\left(\frac{1}{\varepsilon m(1-\varepsilon m\tilde{x})}-\frac{h_0}{2\varepsilon m(1-\varepsilon m\tilde{x})^2}\right)-\left(\frac{1}{\varepsilon m} - \frac{h_0}{2\varepsilon m}\right)\right]
</span> and we can fix the constant of integration by applying <span class="math inline">\tilde{p}(1)=0</span> to find <span class="math inline">h_0 = \frac{2(\varepsilon m-1)}{\varepsilon m-2}</span>, so that finally <span class="math display">
\tilde{p}(\tilde{x}) = \frac{6\varepsilon m \tilde{x}(\tilde{x}-1)}{(\varepsilon m-2)(1-\varepsilon m \tilde{x})^2}.
</span> Recalling that pressure was scaled with <span class="math inline">p = \tilde{p}\frac{\mu U_b}{\varepsilon^2 L_x}</span> we find that <span class="math display">
p(x)= \frac{6\mu U_b}{\varepsilon L_x} \,\frac{m  (x/L_x)(x/L_x-1)}{(\varepsilon m-2)(1-\varepsilon m x/L_x)^2}.
</span> Notably, we find <span class="math inline">p\sim 1/\varepsilon</span> (the <span class="math inline">\sim</span> indicates the ‘order of’ a term, i.e.&nbsp;the most important term, as a limit is taken) as <span class="math inline">\varepsilon \to 0</span>, which shows that the pressure diverges (i.e.&nbsp;goes to infinity) as the channel becomes thinner <span class="math inline">\varepsilon\to0</span>.</p>
<p>To see how the lubricant can support a load, we must calculate the upward force (per unit length, as we are in 2D) on the body. In the lubrication formulation, the leading order terms for the stress (see below) are the pressure normal to the solid and the viscous shear stress (the <span class="math inline">\mu\left(\frac{\partial u}{\partial y}+\frac{\partial v}{\partial x}\right)</span> term) tangential to it. Notably, one can show that the tangential force scales as <span class="math inline">F_x\sim 1</span> (try to do this, if you like). This is why lubrication films support massive normal forces, as <span class="math inline">F_y\sim 1/\varepsilon</span> whilst allowing tangential slippage as <span class="math inline">F_x \sim 1 \ll F_y</span> when the channel is sufficiently thin (<span class="math inline">\varepsilon \ll1</span>).</p>
</section>
</section>
<section id="thin-film-equations" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="thin-film-equations"><span class="header-section-number">5.2</span> Thin Film Equations</h2>
<p>Let us now consider a different application of the lubrication approximation, where we would like to consider the dynamics of thin liquid films with free surfaces. In other words, we are now primarily interested in liquid films, whose free surface is at <span class="math inline">y=h(x,t)</span>, supported on solid surfaces. So the problem changes in character, rather than knowing the height of the upper boundary and finding the pressure (and hence the force) acting on it using the Reynolds equation <a href="#eq-reynolds" class="quarto-xref">Equation&nbsp;<span>5.6</span></a>, we now have an equation for the pressure at the boundary (involving surface tension) and would like to find the height as part of the solution. In order to proceed, we must first consider what happens to our boundary conditions under the lubrication approximation.</p>
<div id="fig-thin-film-freesurface" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-thin-film-freesurface-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="tikz/ThinFilmFreeSurface.svg" style="height:5cm" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-thin-film-freesurface-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Setup for a thin film flow, where the surface at <span class="math inline">y=h(x,t)</span> is now free.
</figcaption>
</figure>
</div>
<section id="free-surface-boundary-conditions-under-lubrication-approximation" class="level3">
<h3 class="anchored" data-anchor-id="free-surface-boundary-conditions-under-lubrication-approximation">Free Surface Boundary Conditions Under Lubrication Approximation</h3>
<p>At the free surface <span class="math inline">y=h(x,t)</span> we first note that under the lubrication approximation <span class="math display">
\begin{aligned}
{\boldsymbol{n}}
&amp;= \frac{(-\frac{\partial h}{\partial x},1)}{\left(1+\left(\frac{\partial h}{\partial x}\right)^2\right)^{1/2}} =  \frac{(-\varepsilon\frac{\partial \tilde{h}}{\partial \tilde{x}},1)}{\left(1+\varepsilon^2\left(\frac{\partial \tilde{h}}{\partial \tilde{x}}\right)^2\right)^{1/2}}
\approx \left(-\varepsilon\frac{\partial \tilde{h}}{\partial \tilde{x}},1\right), \\
{\boldsymbol{t}}
&amp;= \frac{(1,\frac{\partial h}{\partial x})}{\left(1+\left(\frac{\partial h}{\partial x}\right)^2\right)^{1/2}}\approx \left(1,\varepsilon\frac{\partial \tilde{h}}{\partial \tilde{x}}\right)\\
\nabla\cdot{\boldsymbol{n}}
&amp;= -\frac{\frac{\partial^2 h}{\partial x^2}}{\left(1+\left(\frac{\partial h}{\partial x}\right)^2\right)^{3/2}}
\approx -\frac{\varepsilon}{L}\frac{\partial^2 \tilde{h}}{\partial \tilde{x}^2}
\end{aligned}
</span> and that the viscous stress tensor <span class="math inline">S_{ij}</span> is given by <span class="math display">
S_{ij} =\frac{\mu U}{L}\begin{pmatrix}
-\frac{\tilde{p}}{\varepsilon^2}   +2\frac{\partial \tilde{u}}{\partial \tilde{x}} &amp; \varepsilon^{-1} \frac{\partial \tilde{u}}{\partial \tilde{y}} + \varepsilon\frac{\partial \tilde{v}}{\partial \tilde{x}}\\
\varepsilon^{-1}\frac{\partial \tilde{u}}{\partial \tilde{y}} + \varepsilon\frac{\partial \tilde{v}}{\partial \tilde{x}} &amp; -\frac{\tilde{p}}{\varepsilon^2}  +2\frac{\partial \tilde{v}}{\partial \tilde{y}}
\end{pmatrix}.
</span></p>
<p>Our boundary conditions are the kinematic (<span class="math inline">\frac{D f}{Dt}=0</span>) condition <span class="math display">
\frac{\partial h}{\partial t} +  u\frac{\partial h}{\partial x} = v
</span> and our dynamic condition (<span class="math inline">-p_{\text{atm}}\,{\boldsymbol{n}}-{\boldsymbol{S}}\cdot{\boldsymbol{n}}= {\boldsymbol{n}}\,\sigma\nabla\cdot{\boldsymbol{n}}</span>) which we split into tangential and normal components (by dotting our dynamic condition with <span class="math inline">{\boldsymbol{t}}</span> and <span class="math inline">{\boldsymbol{n}}</span>, respectively) to obtain <span class="math display">
{\boldsymbol{t}}\cdot({\boldsymbol{S}}{\boldsymbol{n}}) =0 \qquad \hbox{and}\qquad -p_{\text{atm}}-{\boldsymbol{n}}\cdot({\boldsymbol{S}}{\boldsymbol{n}}) = \sigma\nabla\cdot{\boldsymbol{n}}.
</span></p>
<p>Therefore, after identifying the dominant terms in each equation, our leading order dimensionless equations are the kinematic equation <span id="eq-kin"><span class="math display">
\frac{\partial \tilde{h}}{\partial \tilde{t}} +  \tilde{u}\frac{\partial \tilde{h}}{\partial \tilde{x}} = \tilde{v}
\tag{5.7}</span></span> tangential stress equation <span id="eq-tang"><span class="math display">
\frac{\partial \tilde{u}}{\partial \tilde{y}}=0\qquad\hbox{at}\qquad \tilde{y}=\tilde{h}(\tilde{x},\tilde{t})
\tag{5.8}</span></span> and normal stress equation <span class="math display">
\tilde{p} - \tilde{p}_{\text{atm}} =  -\frac{\sigma\varepsilon^3}{\mu U}\frac{\partial^2 \tilde{h}}{\partial \tilde{x}^2}\qquad\hbox{at}\qquad \tilde{y}=\tilde{h}(\tilde{x},\tilde{t})
</span> where we can again identify a dimensionless parameter the capillary number <span class="math inline">\mathrm{Ca}=\frac{\mu U}{\sigma}</span>. At this stage, we can choose to either neglect the surface tension terms <span class="math inline">\mathrm{Ca}\,\varepsilon^{-3} \ll 1</span> or keep them alongside the pressure terms <span class="math inline">\mathrm{Ca}\,\varepsilon^{-3}\sim1</span> and the choice will depend on the problem in question. We choose the latter option and redefine a scaled capillary number <span class="math inline">\overline{\mathrm{Ca}} = \mathrm{Ca}\,\varepsilon^{-3} = \frac{\mu U L_x^3}{\sigma L_y^3}</span> so that <span id="eq-norm"><span class="math display">
\tilde{p} - \tilde{p}_{\text{atm}} =  -\overline{\mathrm{Ca}}^{-1}\frac{\partial^2 \tilde{h}}{\partial \tilde{x}^2}\qquad\hbox{at}\qquad \tilde{y}=\tilde{h}(\tilde{x},\tilde{t}).
\tag{5.9}</span></span></p>
</section>
<section id="thin-film-equations-1" class="level3">
<h3 class="anchored" data-anchor-id="thin-film-equations-1">Thin Film Equations</h3>
<p>Applying our new boundary conditions are combined with the previous setup of bulk equations <a href="#eq-incom" class="quarto-xref">Equation&nbsp;<span>5.1</span></a>, <a href="#eq-xmom" class="quarto-xref">Equation&nbsp;<span>5.2</span></a> and <a href="#eq-ymom" class="quarto-xref">Equation&nbsp;<span>5.3</span></a> alongside boundary conditions at <span class="math inline">y=0</span>, where for simplicity we assume a stationary solid <span class="math display">
\tilde{u}=\tilde{v}=0\qquad\hbox{at}\qquad \tilde{y}=0.
</span> and the procedure will be similar to before, expect now we have a boundary condition for <span class="math inline">\tilde{p}</span> and would like to find <span class="math inline">\tilde{h}</span> as part of the solution.</p>
<p>Integrating the incompressibility equation <a href="#eq-incom" class="quarto-xref">Equation&nbsp;<span>5.1</span></a> ‘across the channel’ gives <span class="math display">
0 =  \frac{\partial}{\partial \tilde{x}}\left(\int^{\tilde{h}(\tilde{x},\tilde{t})}_0 \tilde{u} d\tilde{y}\right) - \left.\tilde{u}\frac{\partial \tilde{h}}{\partial \tilde{x}}\right|_{\tilde{y}=\tilde{h}(\tilde{x},\tilde{t})} + \left[\tilde{v}\right]^{\tilde{y}=\tilde{h}(\tilde{x},\tilde{t})}_{\tilde{y}=0}.
</span> Applying the kinematic boundary conditions on <span class="math inline">\tilde{v}</span>, that is <a href="#eq-kin" class="quarto-xref">Equation&nbsp;<span>5.7</span></a>, we obtain <span class="math display">
0 =  \frac{\partial ( \tilde{h}\bar{\tilde{u}})}{\partial\tilde{x}}  - \left.\tilde{u}\frac{\partial \tilde{h}}{\partial \tilde{x}}\right|_{\tilde{y}=\tilde{h}(x,t)} + \frac{\partial \tilde{h}}{\partial \tilde{t}} +  \left.\tilde{u}\frac{\partial \tilde{h}}{\partial \tilde{x}}\right|_{\tilde{y}=\tilde{h}(x,t)} = \frac{\partial (\tilde{h} \bar{\tilde{u}})}{\partial\tilde{x}}   + \frac{\partial \tilde{h}}{\partial \tilde{t}}
</span> where we have again used the mean velocity <a href="#eq-uav" class="quarto-xref">Equation&nbsp;<span>5.5</span></a> across the channel.</p>
<p>Noting from <a href="#eq-ymom" class="quarto-xref">Equation&nbsp;<span>5.3</span></a> that the pressure does not depend on <span class="math inline">y</span>, at every point in <span class="math inline">(x,t)</span> it must be equal to its value at the free surface, given by <a href="#eq-norm" class="quarto-xref">Equation&nbsp;<span>5.9</span></a> so that <span class="math display">
\tilde{p}(\tilde{x},\tilde{t}) =  \tilde{p}_{\text{atm}}  -\overline{\mathrm{Ca}}^{-1}\frac{\partial^2 \tilde{h}}{\partial \tilde{x}^2}\qquad\implies\qquad \frac{\partial \tilde{p}}{\partial \tilde{x}} =-\overline{\mathrm{Ca}}^{-1}\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3}
</span> and hence the <span class="math inline">x</span>-momentum equation <a href="#eq-xmom" class="quarto-xref">Equation&nbsp;<span>5.2</span></a> becomes <span class="math display">
\frac{\partial \tilde{p}}{\partial \tilde{x}} = -\overline{\mathrm{Ca}}^{-1}\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} = \frac{\partial^2 \tilde{u}}{\partial \tilde{y}^2}.
</span> Integrating this we find <span class="math display">
\tilde{u} = -\overline{\mathrm{Ca}}^{-1}\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} \frac{\tilde{y}^2}{2} +C(\tilde{x},\tilde{t}) y + D(\tilde{x},\tilde{t})
</span> which with <span class="math inline">\tilde{u}(0)=0</span> and <span class="math inline">\left.\frac{\partial \tilde{u}}{\partial \tilde{y}}\right|_{\tilde{y}=\tilde{h}}=0</span> gives <span class="math display">
\tilde{u} =  -\overline{\mathrm{Ca}}^{-1}\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} \tilde{y}(\frac{\tilde{y}}{2}-\tilde{h})
</span> so that from <a href="#eq-uav" class="quarto-xref">Equation&nbsp;<span>5.5</span></a> we have <span id="eq-meanu"><span class="math display">
\bar{\tilde{u}} = -\frac{1}{\tilde{h}}\overline{\mathrm{Ca}}^{-1}\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} \left[\frac{\tilde{y^3}}{6}-\tilde{h}\frac{\tilde{y^2}}{2}\right]^{\tilde{h}}_0 = \frac{\tilde{h}^2}{3}\overline{\mathrm{Ca}}^{-1}\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3}
\tag{5.10}</span></span> and finally we obtain the thin film equation <span id="eq-thinfilm"><span class="math display">
\frac{\partial \tilde{h}}{\partial \tilde{t}} +\frac{1}{3\mathrm{Ca}}\frac{\partial}{\partial\tilde{x}}\left( \tilde{h}^3\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} \right) =0.
\tag{5.11}</span></span></p>
<p>In dimensional terms the thin film equation is given by <span class="math display">
\mu\frac{\partial h}{\partial t} +\frac{\sigma}{3}\frac{\partial}{\partial x}\left( h^3\frac{\partial^3 h}{\partial x^3} \right) =0.
</span> showing that the equation represents flow that is governed by a balance of viscous (first term) and surface tension (second term). Remarkably, we have gone from the impenetrable-looking Navier-Stokes equations with complex free surface boundary conditions down to a single partial differential equation for the height of the free surface <span class="math inline">\tilde{h}</span>. The only disadvantage is that we have now introduced higher order derivatives that will need care when computed numerically and considerable nonlinearity. Notably, this suggests we will need two boundary conditions on <span class="math inline">\tilde{h}</span> and/or its derivatives at each end of the domain.</p>
<section id="boundary-conditions" class="level4">
<h4 class="anchored" data-anchor-id="boundary-conditions">Boundary Conditions</h4>
<p>One can consider numerous different possibilities, but one of the simplest occurs if we think of the boundaries of our domain either being a rigid vertical solid which the free surface meets perpendicularly (i.e.&nbsp;<span class="math inline">\frac{\partial \tilde{h}}{\partial \tilde{x}}=0</span>) or a symmetry plane meaning again that <span class="math inline">\frac{\partial \tilde{h}}{\partial \tilde{x}}=0</span>. Also, in both cases there will be no mean velocity at the boundary so that <span class="math inline">\bar{\tilde{u}}=0</span> which from <a href="#eq-meanu" class="quarto-xref">Equation&nbsp;<span>5.10</span></a> means that <span class="math inline">\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} =0</span> also. Therefore, in these cases our two boundary conditions at each end of the domain are given by <span id="eq-bcs"><span class="math display">
\frac{\partial \tilde{h}}{\partial \tilde{x}} =\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} =0\qquad\hbox{at}\qquad \tilde{x}=0,1
\tag{5.12}</span></span></p>
<p>Of course, many other possibilities exist, e.g.&nbsp;including periodic boundary conditions or conditions that specify a particular gradient for the free surface. <!-- 
## Fluids coursework project option 3

**Project 3: Fluctuations and Breakup of Nanoscale Liquid Films**\
In this project, the intention is to build a code capable of capturing
thin film flow dynamics and to augment this with additional terms that
represent physics that is not classically accounted for within the
Navier-Stokes framework. Two relatively recent review articles have been
written on the general topic of thin films by Oron et al 97 and Craster
& Matar 09 - I would recommend reading the introductions for some
background, although there is nothing about fluctuations in these
reviews.\
\

![image](images/zhang){height="4cm"} ![image](images/zhao){height="4cm"}
[]{#fig-thoroddsen label="fig-thoroddsen"}

##### Aims:

To write an approximately 10 page report that demonstrates:

- engagement with the literature on thin film dynamics;

- computational results for a thin film flow containing physics beyond
  classical theory; and

- validation of code against known results in the literature.

**Project Ideas**

A starting point for this project is to write a code that solves the
thin film equation subject to appropriate boundary conditions. The
simplest scheme one could think of would be an explicit forward Euler
scheme for time stepping, as considered in Week 3 for 'Start Up Flow',
alongside finite differences for the spatial derivatives. It is clear
this case will be more complex than previous ones, as
([\[eq-thinfilm\]](#eq-thinfilm){reference-type="ref"
reference="eq-thinfilm"}) contains higher derivatives (fourth order) as
well as considerable nonlinearity.\
**Given Information on Discretisation** Finite difference coefficients
for higher derivatives can either be derived or found here
<https://en.wikipedia.org/wiki/Finite_difference_coefficient>. With
equations of the form
([\[eq-thinfilm\]](#eq-thinfilm){reference-type="ref"
reference="eq-thinfilm"}) one can either use the product rule on the
spatial derivative to obtain $h^3 h'''' + 3h^2 h'''$ and then use the
finite difference method on this, or one can consider the derivative
applied directly to the quantity inside
$\frac{\partial}{\partial \tilde{x}}$, which is the method I found to be
most accurate (please feel free to explore).

To be more precise, one can calculate a quantity
$\tilde{Q}_i = \tilde{h_i}^3\left.\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3}\right|_{x=x_i}$
at each node $i$, using a finite difference formula (e.g. second order)
for the third derivative, and then apply a central difference to this
quantity to obtain
$$
\left.\frac{\partial \tilde{Q}}{\partial \tilde{x}}\right|_{x=x_i} = \left.\frac{\partial}{\partial\tilde{x}}\left( \tilde{h}^3\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} \right)\right|_{x=x_i} = \frac{\tilde{Q}_{i+1} - \tilde{Q}_{i-1}}{2 \tilde{dx}}
$$
where $\tilde{dx}$ is the mesh size.

You may also wish to experiment with the time step that will produce
stable time-stepping, with the equations suggesting this could be quite
strict with $d\tilde{t} \ll d\tilde{x}^4$.

As with all projects, the suggestions below are intended to give you
ideas of what can be done, but you should feel free to follow your own
path if you wish.

- Consider the flattening of a film from an initially perturbed
  profile - e.g. you could choose to sinusoidally perturb the
  equilibrium height $\tilde{h}=1$.

- Determine the limitations on the time step.

- Investigate higher order explicit time-stepping methods and/or
  implicit methods, if this interests you.

One direction you may wish to consider is the stability of thin liquid
films, which is of critical importance for coatings. The setup here
would be to take a thin film of equilibrium height $\tilde{h}=1$ and
take small perturbations to this, e.g. of sinusoidal form
$\tilde{h} = 1+\tilde{A}\cos(\tilde{k} \tilde{x})$ where $\tilde{A}$ is
the amplitude of the disturbance and $\tilde{k}$ is the wavenumber.

- Perform numerical experiments using
  ([\[eq-thinfilm\]](#eq-thinfilm){reference-type="ref"
  reference="eq-thinfilm"}) to see when the film breaks up. You should
  find that for small perturbations $A\ll 1$ the film is always stable.

- The (linear) stability of thin films goes against evidence from
  experiments and molecular dynamics simulations (see above) which show
  that very thin (nanoscopic) films can breakup (i.e. the free surface
  contacts the solid, which subsequently becomes dry). One physical
  reason why this could occur is that when films become very thin,
  long-range attractive van-der-Waals forces (in the simplest case, e.g.
  via dipole-dipole interactions) create an extra pressure on the free
  surface that is not accounted for in the classical theory. One can
  crudely model these using an additional force (or 'disjoining
  pressure') on the free surface which forces it towards the solid (see
  § 2E of Oron et al 97, in the Reading List). The potential associated
  with this force has the (dimensional) form
  $\phi=\frac{A_{dim}}{6\pi h^3}$ where $A_{dim}$ is the Hamaker
  constant, with $A>0$ corresponding to attraction between the
  interfaces, which is the case we are interested in. In the thin film
  framework, this force leads to an additional term in
  ([\[eq-thinfilm\]](#eq-thinfilm){reference-type="ref"
  reference="eq-thinfilm"}) so that
  $$
  \frac{\partial \tilde{h}}{\partial \tilde{t}} +\frac{\partial}{\partial\tilde{x}}\left( \frac{\tilde{h}^3}{3\mathrm{Ca}}\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} + \frac{A}{\tilde{h}}\frac{\partial \tilde{h}}{\partial \tilde{x}} \right) =0.
  $$
  where $A$ is a dimensionless parameter prescribing the strength of the
  vdW force.

- Connect to the stability analysis in Oron et al 97 (e.g. see equation
  2.42b for critical wavenumber), which shows both (i) how large the
  domain must be to allow an instability to grow and (ii) the growth
  rate of the instability in its initial (linear) stages. You should be
  able to compare your simulations to these predictions.

- Consider the final stages of the free surfaces' evolution before it
  ruptures (i.e. the minimum height of the film goes to zero). It is
  often the case that near the rupture, which we assume occurs at some
  time $t_r$, theories exist to see how this singularity is approached
  (usually via similarity solutions, which we do not discuss here). This
  is the case here, with Oron et al 97 predicting that "the minimal
  thickness of the film close to the rupture point is therefore expected
  to decrease linearly with time" - i.e., we should expect to see
  $\tilde{h}_{min}  = C(\tilde{t}_r - \tilde{t})$ where $C$ is a
  constant. In contrast, in Zhang & Lister 99, the prediction is that
  $\tilde{h}_{min}  = C(\tilde{t}_r - \tilde{t})^{1/5}$. Note that to
  'resolve' the rupture one may have to consider a non-uniform grid, as
  in Zhang & Lister 99. Engage with this literature and see what your
  code recovers\...

Alternatively, one may consider the influence that thermal fluctuations
have on thin nanoscopic liquid films, as seen in molecular dynamics
simulations. Notably, the standard Navier-Stokes equations do not
incorporate thermal fluctuations, so that one must consider the
so-called Fluctuating Hydrodynamics (aka Landau-Lifshitz-Navier-Stokes
or Stochastic-Navier-Stokes) if one wants to capture these (see Zhao et
al 19 and Zhang et al 19 in Reading List and references therein).

- Write a code to solve the the thin film equation which incorporates
  thermal fluctuations (see Zhang et al 2019 for details):
  $$
  \frac{\partial \tilde{h}}{\partial \tilde{t}} +\frac{\partial}{\partial\tilde{x}}\left( \frac{\tilde{h}^3}{3\mathrm{Ca}}\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3} + B \tilde{h}^{3/2}N \right) =0.
  $$
  where $B$ is a dimensionless parameter measuring the strength of
  thermal fluctuations, $N$ represents noise with zero mean which is
  uncorrelated in time and space so that the covariance
  $<N(x,t)N(x',t')>=\delta(x-x')\delta(t-t')$ (where the triangular
  brackets represent an ensemble average and $\delta$ is the Dirac delta
  function. Numerically, for an explicit time step $\triangle t$ and
  mesh size $\triangle x$ one can represent $N$ at every node using
  $$
  N\approx \frac{randn}{\sqrt{\triangle t \triangle x}}
  $$
  where $randn$ are random numbers sampled from a Gaussian distribution with
  mean zero and variance one.

- Implement the code for the case of a periodic domain, where one has
  four boundary conditions
  $\left.\tilde{h}\right|_{x=0} =\left.\tilde{h}\right|_{x=1}$,
  $\left.\frac{\partial \tilde{h}}{\partial \tilde{x}}\right|_{x=0} =\left.\frac{\partial \tilde{h}}{\partial \tilde{x}}\right|_{x=1}$,
  $\left.\frac{\partial^2 \tilde{h}}{\partial \tilde{x}^2}\right|_{x=0} =\left.\frac{\partial^2 \tilde{h}}{\partial \tilde{x}^2}\right|_{x=1}$,
  $\left.\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3}\right|_{x=0} =\left.\frac{\partial^3 \tilde{h}}{\partial \tilde{x}^3}\right|_{x=1}$.

- Calculate the 'static capillary wave spectrum' for this case which
  tells you about how strong each of the waves within the domain is. To
  do so, one must calculate the perturbation from the equilibrium film
  height $\delta h(x,t) = h(x,t)-1$ at each time step, take the Fourier
  transform of this to obtain $\hat{\delta \tilde{h}}$ (which is a
  function of wavenumber $\tilde{k}$), take the modulus squared of this
  to obtain a real number $|\hat{\delta \tilde{h}}|^2$ and then average
  over multiple time steps to obtain the spectrum
  $\tilde{S}(\tilde{k}) = \overline{|\hat{\delta \tilde{h}}|^2}$. This
  will be a function of wavenumber $\tilde{k}$ and theory predicts that
  $\tilde{S}(\tilde{k}) \propto \tilde{k}^{-2}$, which one can try to
  predict with the code (note there will be an initial transient during
  which the film becomes rough/noisy and this should be neglected).

If one wants a real challenge\....

- Reproduce results from Zhao et al 2019 for the breakup of liquid
  cylinders. In this case the lubrication equation is applied to a
  cylindrical coordinate system to provide the so-called 'stochastic
  lubrication equation'.

**Reading List**

Articles below are just a starting point for your investigations and
should not be considered exhaustive

- Craster, R. V. and Matar O. K., 2009. Dynamics and stability of thin
  liquid films. Reviews of Modern Physics, 81.\
  Relatively recent review article.

- Oron, A., Davis S. H. and Bankoff S.G., 1997. Long scale evolution of
  thin liquid films. Reviews of Modern Physics, 69.\
  Classic review article.

- Zhang, Y., Sprittles, J. E. and Lockerby, D. A., 2019. Molecular
  simulation of thin liquid films: thermal fluctuations and instability.
  Physical Review E, 100, 023108\
  Article considering the fluctuations of thin liquid films using
  molecular dynamics and analytic work based on fluctuating
  hydrodynamics.

- Zhang, W. W. and Lister, J. R., 1999. Similarity solutions for van der
  Waals rupture of a thin film on a solid substrate. Physics of Fluids,
  11, 2454-2462

- Zhao, C., Sprittles, J. E. and Lockerby, D. A., 2019. Revisiting the
  Rayleigh--Plateau instability for the nanoscale. Journal of Fluid
  Mechanics (Rapid Communications), 861, R3\
  Article considering how fluctuations effect the breakup of liquid
  cylinders. Notably, this involves applying the lubrication
  approximation in cylindrical coordinates, rather than in Cartesian as
  considered for thin films. --></p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./1-4-free-surfaces.html" class="pagination-link" aria-label="Free Surface Flows">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Free Surface Flows</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>